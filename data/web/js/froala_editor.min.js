if("undefined"==typeof jQuery)throw new Error("Froala requires jQuery");!function(t){"use strict";var e=function(i,s){return this.options=t.extend({},e.DEFAULTS,t(i).data(),"object"==typeof s&&s),this.options.unsupportedAgents.test(navigator.userAgent)?!1:(this.valid_nodes=t.merge([],e.VALID_NODES),this.valid_nodes=t.merge(this.valid_nodes,t.map(Object.keys(this.options.blockTags),function(t){return t.toUpperCase()})),this.browser=e.browser(),this.disabledList=[],this._id=++e.count,this._events={},this.blurred=!0,this.$original_element=t(i),this.document=i.ownerDocument,this.window="defaultView"in this.document?this.document.defaultView:this.document.parentWindow,this.$document=t(this.document),this.$window=t(this.window),this.br=this.browser.msie&&t.Editable.getIEversion()<=10?"":"<br/>",this.init(i),void t(i).on("editable.focus",t.proxy(function(){for(var e=1;e<=t.Editable.count;e++)e!=this._id&&this.$window.trigger("blur."+e)},this)))};e.initializers=[],e.count=0,e.VALID_NODES=["P","DIV","LI","TD","TH"],e.LANGS=[],e.INVISIBLE_SPACE="&#x200b;",e.DEFAULTS={allowComments:!0,allowScript:!1,allowStyle:!1,allowedAttrs:["accept","accept-charset","accesskey","action","align","alt","async","autocomplete","autofocus","autoplay","autosave","background","bgcolor","border","charset","cellpadding","cellspacing","checked","cite","class","color","cols","colspan","content","contenteditable","contextmenu","controls","coords","data","data-.*","datetime","default","defer","dir","dirname","disabled","download","draggable","dropzone","enctype","for","form","formaction","headers","height","hidden","high","href","hreflang","http-equiv","icon","id","ismap","itemprop","keytype","kind","label","lang","language","list","loop","low","max","maxlength","media","method","min","multiple","name","novalidate","open","optimum","pattern","ping","placeholder","poster","preload","pubdate","radiogroup","readonly","rel","required","reversed","rows","rowspan","sandbox","scope","scoped","scrolling","seamless","selected","shape","size","sizes","span","src","srcdoc","srclang","srcset","start","step","summary","spellcheck","style","tabindex","target","title","type","translate","usemap","value","valign","width","wrap"],allowedTags:["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","br","button","canvas","caption","cite","code","col","colgroup","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meter","nav","noscript","object","ol","optgroup","option","output","p","param","pre","progress","queue","rp","rt","ruby","s","samp","script","section","select","small","source","span","strike","strong","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"],alwaysBlank:!1,alwaysVisible:!1,autosave:!1,autosaveInterval:1e4,beautifyCode:!0,blockTags:{n:"Normal",blockquote:"Quote",pre:"Code",h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",h4:"Heading 4",h5:"Heading 5",h6:"Heading 6"},buttons:["bold","italic","underline","strikeThrough","fontSize","fontFamily","color","sep","formatBlock","blockStyle","align","insertOrderedList","insertUnorderedList","outdent","indent","sep","createLink","insertImage","insertVideo","insertHorizontalRule","undo","redo","html"],crossDomain:!0,convertMailAddresses:!0,customButtons:{},customDropdowns:{},customText:!1,defaultTag:"P",direction:"ltr",disableRightClick:!1,editInPopup:!1,editorClass:"",formatTags:["p","pre","blockquote","h1","h2","h3","h4","h5","h6","div","ul","ol","li","table","tbody","thead","tfoot","tr","th","td","body","head","html","title","meta","link","base","script","style"],headers:{},height:"auto",icons:{},inlineMode:!0,initOnClick:!1,fullPage:!1,language:"en_us",linkList:[],linkText:!1,linkClasses:{},linkAttributes:{},linkAutoPrefix:"",maxHeight:"auto",minHeight:"auto",multiLine:!0,noFollow:!1,paragraphy:!0,placeholder:"Type something",plainPaste:!1,preloaderSrc:"",saveURL:null,saveParam:"body",saveParams:{},saveRequestType:"POST",scrollableContainer:"body",simpleAmpersand:!1,shortcuts:!0,shortcutsAvailable:["show","bold","italic","underline","createLink","insertImage","indent","outdent","html","formatBlock n","formatBlock h1","formatBlock h2","formatBlock h3","formatBlock h4","formatBlock h5","formatBlock h6","formatBlock blockquote","formatBlock pre","strikeThrough"],showNextToCursor:!1,spellcheck:!1,theme:null,toolbarFixed:!0,trackScroll:!1,unlinkButton:!0,useClasses:!0,tabSpaces:!0,typingTimer:500,pastedImagesUploadRequestType:"POST",pastedImagesUploadURL:"http://i.froala.com/upload_base64",unsupportedAgents:/Opera Mini/i,useFrTag:!1,width:"auto",withCredentials:!1,zIndex:2e3},e.prototype.destroy=function(){this.sync(),this.options.useFrTag&&this.addFrTag(),this.hide(),this.isHTML&&this.html(),this.$bttn_wrapper&&this.$bttn_wrapper.html("").removeData().remove(),this.$editor&&this.$editor.html("").removeData().remove(),this.raiseEvent("destroy"),this.$popup_editor&&this.$popup_editor.html("").removeData().remove(),this.$placeholder&&this.$placeholder.html("").removeData().remove(),clearTimeout(this.ajaxInterval),clearTimeout(this.typingTimer),this.$element.off("mousedown mouseup click keydown keyup cut copy paste focus keypress touchstart touchend touch drop"),this.$element.off("mousedown mouseup click keydown keyup cut copy paste focus keypress touchstart touchend touch drop","**"),this.$window.off("mouseup."+this._id),this.$window.off("keydown."+this._id),this.$window.off("keyup."+this._id),this.$window.off("blur."+this._id),this.$window.off("hide."+this._id),this.$window.off("scroll."+this._id),this.$window.off("resize."+this._id),this.$window.off("orientationchange."+this._id),this.$document.off("selectionchange."+this._id),this.$original_element.off("editable"),void 0!==this.$upload_frame&&this.$upload_frame.remove(),this.$textarea&&(this.$box.remove(),this.$textarea.removeData("fa.editable"),this.$textarea.show());for(var t in this._events)delete this._events[t];this.$placeholder&&this.$placeholder.remove(),this.isLink?this.$element.removeData("fa.editable"):(this.$wrapper?this.$wrapper.replaceWith(this.getHTML(!1,!1)):this.$element.replaceWith(this.getHTML(!1,!1)),this.$box&&!this.editableDisabled&&(this.$box.removeClass("froala-box f-rtl"),this.$box.find(".html-switch").remove(),this.$box.removeData("fa.editable"),clearTimeout(this.typingTimer))),this.$lb&&this.$lb.remove()},e.prototype.triggerEvent=function(e,i,s,n){void 0===s&&(s=!0),void 0===n&&(n=!1),s===!0&&(this.isResizing()||this.editableDisabled||this.imageMode||!n||this.cleanify(),this.sync());var o=!0;return i||(i=[]),o=this.$original_element.triggerHandler("editable."+e,t.merge([this],i)),void 0===o?!0:o},e.prototype.syncStyle=function(){if(this.options.fullPage){var t=this.$element.html().match(/\[style[^\]]*\].*\[\/style\]/gi);if(this.$document.find("head style[data-id]").remove(),t)for(var e=0;e<t.length;e++)this.$document.find("head").append(t[e].replace(/\[/gi,"<").replace(/\]/gi,">"))}},e.prototype.sync=function(){if(!this.isHTML){this.raiseEvent("sync"),this.disableImageResize(),this.isLink||this.isImage||this.checkPlaceholder();var t=this.getHTML();this.trackHTML!==t&&null!=this.trackHTML?(this.refreshImageList(),this.refreshButtons(),this.trackHTML=t,this.$textarea&&this.$textarea.val(t),this.doingRedo||this.saveUndoStep(),this.triggerEvent("contentChanged",[],!1)):null==this.trackHTML&&(this.trackHTML=t),this.syncStyle()}},e.prototype.emptyElement=function(e){if("IMG"==e.tagName||t(e).find("img").length>0)return!1;if(t(e).find("input, iframe, object").length>0)return!1;for(var i=t(e).text(),s=0;s<i.length;s++)if("\n"!==i[s]&&"\r"!==i[s]&&"	"!==i[s]&&8203!=i[s].charCodeAt(0))return!1;return!0},e.prototype.initEvents=function(){this.mobile()?(this.mousedown="touchstart",this.mouseup="touchend",this.move="touchmove"):(this.mousedown="mousedown",this.mouseup="mouseup",this.move="")},e.prototype.initDisable=function(){this.$element.on("keypress keydown keyup",t.proxy(function(t){return this.isDisabled?(t.stopPropagation(),t.preventDefault(),!1):void 0},this))},e.prototype.continueInit=function(){this.initDisable(),this.initEvents(),this.browserFixes(),this.handleEnter(),this.editableDisabled||(this.initUndoRedo(),this.enableTyping(),this.initShortcuts()),this.initTabs(),this.initEditor();for(var e=0;e<t.Editable.initializers.length;e++)t.Editable.initializers[e].call(this);this.initOptions(),this.initEditorSelection(),this.initAjaxSaver(),this.setLanguage(),this.setCustomText(),this.editableDisabled||this.registerPaste(),this.refreshDisabledState(),this.refreshUndo(),this.refreshRedo(),this.initPopupSubmit(),this.initialized=!0,this.triggerEvent("initialized",[],!1,!1)},e.prototype.initPopupSubmit=function(){this.$popup_editor.find(".froala-popup input").keydown(function(e){var i=e.which;13==i&&(e.preventDefault(),e.stopPropagation(),t(this).blur(),t(this).parents(".froala-popup").find("button.f-submit").click())})},e.prototype.lateInit=function(){this.saveSelectionByMarkers(),this.continueInit(),this.restoreSelectionByMarkers(),this.$element.focus(),this.hideOtherEditors()},e.prototype.init=function(e){this.options.paragraphy||(this.options.defaultTag="DIV"),this.options.allowStyle&&this.setAllowStyle(),this.options.allowScript&&this.setAllowScript(),this.initElement(e),this.initElementStyle(),(!this.isLink||this.isImage)&&(this.initImageEvents(),this.buildImageMove()),this.options.initOnClick?(this.editableDisabled||(this.$element.attr("contenteditable",!0),this.$element.attr("spellcheck",!1)),this.$element.bind("mousedown.element focus.element",t.proxy(function(t){return this.isLink||t.stopPropagation(),this.isDisabled?!1:(this.$element.unbind("mousedown.element focus.element"),this.browser.webkit&&(this.initMouseUp=!1),void this.lateInit())},this))):this.continueInit()},e.prototype.phone=function(){var t=!1;return function(e){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0)}(navigator.userAgent||navigator.vendor||window.opera),t},e.prototype.mobile=function(){return this.phone()||this.android()||this.iOS()||this.blackberry()},e.prototype.iOS=function(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)},e.prototype.iOSVersion=function(){if(/iP(hone|od|ad)/.test(navigator.platform)){var t=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),e=[parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3]||0,10)];if(e&&e[0])return e[0]}return 0},e.prototype.iPad=function(){return/(iPad)/g.test(navigator.userAgent)},e.prototype.iPhone=function(){return/(iPhone)/g.test(navigator.userAgent)},e.prototype.iPod=function(){return/(iPod)/g.test(navigator.userAgent)},e.prototype.android=function(){return/(Android)/g.test(navigator.userAgent)},e.prototype.blackberry=function(){return/(Blackberry)/g.test(navigator.userAgent)},e.prototype.initOnTextarea=function(e){this.$textarea=t(e),void 0!==this.$textarea.attr("placeholder")&&"Type something"==this.options.placeholder&&(this.options.placeholder=this.$textarea.attr("placeholder")),this.$element=t("<div>").html(this.clean(this.$textarea.val(),!0,!1)),this.$textarea.before(this.$element).hide(),this.$textarea.parents("form").bind("submit",t.proxy(function(){this.isHTML?this.html():this.sync()},this)),this.addListener("destroy",t.proxy(function(){this.$textarea.parents("form").unbind("submit")},this))},e.prototype.initOnLink=function(e){this.isLink=!0,this.options.linkText=!0,this.selectionDisabled=!0,this.editableDisabled=!0,this.options.buttons=[],this.$element=t(e),this.options.paragraphy=!1,this.options.countCharacters=!1,this.$box=this.$element},e.prototype.initOnImage=function(e){var i=t(e).css("float");"A"==t(e).parent().get(0).tagName&&(e=t(e).parent()),this.isImage=!0,this.editableDisabled=!0,this.imageList=[],this.options.buttons=[],this.options.paragraphy=!1,this.options.imageMargin="auto",t(e).wrap("<div>"),this.$element=t(e).parent(),this.$element.css("display","inline-block"),this.$element.css("max-width","100%"),this.$element.css("margin-left","auto"),this.$element.css("margin-right","auto"),this.$element.css("float",i),this.$element.addClass("f-image"),this.$box=t(e)},e.prototype.initForPopup=function(e){this.$element=t(e),this.$box=this.$element,this.editableDisabled=!0,this.options.countCharacters=!1,this.options.buttons=[],this.$element.on("click",t.proxy(function(t){t.preventDefault()},this))},e.prototype.initOnDefault=function(e){"DIV"!=e.tagName&&this.options.buttons.indexOf("formatBlock")>=0&&this.disabledList.push("formatBlock"),this.$element=t(e)},e.prototype.initElement=function(e){if("TEXTAREA"==e.tagName?this.initOnTextarea(e):"A"==e.tagName?this.initOnLink(e):"IMG"==e.tagName?this.initOnImage(e):this.options.editInPopup?this.initForPopup(e):this.initOnDefault(e),!this.editableDisabled){this.$box=this.$element.addClass("froala-box"),this.$wrapper=t('<div class="froala-wrapper">'),this.$element=t("<div>");var i=this.$box.html();this.$box.html(this.$wrapper.html(this.$element)),this.$element.on("keyup",t.proxy(function(){this.$element.find("ul, ol").length>1&&this.cleanupLists()},this)),this.setHTML(i,!0)}this.$element.on("drop",t.proxy(function(){setTimeout(t.proxy(function(){t("html").click(),this.$element.find(".f-img-wrap").each(function(e,i){0===t(i).find("img").length&&t(i).remove()}),this.$element.find(this.options.defaultTag+":empty").remove()},this),1)},this))},e.prototype.trim=function(t){return t=String(t).replace(/^\s+|\s+$/g,""),t=t.replace(/\u200B/gi,"")},e.prototype.unwrapText=function(){this.options.paragraphy||this.$element.find(this.options.defaultTag).each(t.proxy(function(e,i){if(0===i.attributes.length){var s=t(i).find("br:last");t(i).replaceWith(s.length&&this.isLastSibling(s.get(0))?t(i).html():t(i).html()+"<br/>")}},this))},e.prototype.wrapTextInElement=function(e,i){void 0===i&&(i=!1);var s=[],n=["SPAN","A","B","I","EM","U","S","STRONG","STRIKE","FONT","IMG","SUB","SUP","BUTTON","INPUT"],o=this;this.no_verify=!0;var a=function(){if(0===s.length)return!1;var e=t("<"+o.options.defaultTag+">"),i=t(s[0]);if(1==s.length&&"f-marker"==i.attr("class"))return void(s=[]);for(var n=0;n<s.length;n++){var a=t(s[n]);e.append(a.clone()),n==s.length-1?a.replaceWith(e):a.remove()}s=[]},r=!1,l=!1,h=!1;e.contents().filter(function(){var e=t(this);if(e.hasClass("f-marker")||e.find(".f-marker").length){var d=e;if(1==e.find(".f-marker").length||e.hasClass("f-marker")){d=e.find(".f-marker").length?t(e.find(".f-marker")[0]):e;var p=d.prev();"true"===d.attr("data-type")?p.length&&t(p[0]).hasClass("f-marker")?h=!0:(r=!0,l=!1):l=!0}else h=!0}this.nodeType==Node.TEXT_NODE&&e.text().length>0||n.indexOf(this.tagName)>=0?s.push(this):this.nodeType==Node.TEXT_NODE&&0===e.text().length&&o.options.beautifyCode?e.remove():r||i||h?("BR"===this.tagName&&(s.length>0?e.remove():s.push(this)),a(),l&&(r=!1),h=!1):s=[]}),(r||i||h)&&a(),e.find("> "+this.options.defaultTag).each(function(e,i){0===t(i).text().trim().length&&0===t(i).find("img").length&&0===t(i).find("br").length&&t(i).append(this.br)}),e.find("div:empty:not([class])").remove(),e.is(":empty")&&e.append(o.options.paragraphy===!0?"<"+this.options.defaultTag+">"+this.br+"</"+this.options.defaultTag+">":this.br),this.no_verify=!1},e.prototype.wrapText=function(e){if(this.isImage||this.isLink)return!1;this.allow_div=!0,this.removeBlankSpans();for(var i=this.getSelectionElements(),s=0;s<i.length;s++){var n=t(i[s]);["LI","TH","TD"].indexOf(n.get(0).tagName)>=0?this.wrapTextInElement(n,!0):this.parents(n,"li").length?this.wrapTextInElement(t(this.parents(n,"li")[0]),e):this.wrapTextInElement(this.$element,e)}this.allow_div=!1},e.prototype.convertNewLines=function(){this.$element.find("pre").each(function(e,i){var s=t(i),n=t(i).html();n.indexOf("\n")>=0&&s.html(n.replace(/\n/g,"<br>"))})},e.prototype.setHTML=function(e,i){this.no_verify=!0,this.allow_div=!0,void 0===i&&(i=!0),e=this.clean(e,!0,!1),e=e.replace(/>\s+</g,"><"),this.$element.html(e),this.cleanAttrs(this.$element.get(0)),this.convertNewLines(),this.imageList=[],this.refreshImageList(),this.options.paragraphy&&this.wrapText(!0),this.$element.find("li:empty").append(t.Editable.INVISIBLE_SPACE),this.cleanupLists(),this.cleanify(!1,!0,!1),i&&(this.restoreSelectionByMarkers(),this.sync()),this.$element.find("span").attr("data-fr-verified",!0),this.initialized&&(this.hide(),this.closeImageMode(),this.imageMode=!1),this.no_verify=!1,this.allow_div=!1},e.prototype.beforePaste=function(){this.saveSelectionByMarkers(),this.clipboardHTML=null,this.scrollPosition=this.$window.scrollTop(),this.$pasteDiv?this.$pasteDiv.html(""):(this.$pasteDiv=t('<div contenteditable="true" style="position: fixed; top: 0; left: -9999px; height: 100%; width: 0; z-index: 4000; line-height: 140%;" tabindex="-1"></div>'),this.$box.after(this.$pasteDiv)),this.$pasteDiv.focus(),this.window.setTimeout(t.proxy(this.processPaste,this),1)},e.prototype.processPaste=function(){var i=this.clipboardHTML;null===this.clipboardHTML&&(i=this.$pasteDiv.html(),this.restoreSelectionByMarkers(),this.$window.scrollTop(this.scrollPosition));var s,n=this.triggerEvent("onPaste",[i],!1);"string"==typeof n&&(i=n),i=i.replace(/<img /gi,'<img data-fr-image-pasted="true" '),i.match(/(class=\"?Mso|style=\"[^\"]*\bmso\-|w:WordDocument)/gi)?(s=this.wordClean(i),s=this.clean(t("<div>").append(s).html(),!1,!0),s=this.removeEmptyTags(s)):(s=this.clean(i,!1,!0),s=this.removeEmptyTags(s),e.copiedText&&t("<div>").html(s).text().replace(/\u00A0/gi," ")==e.copiedText.replace(/(\u00A0|\r|\n)/gi," ")&&(s=e.copiedHTML)),this.options.plainPaste&&(s=this.plainPasteClean(s)),n=this.triggerEvent("afterPasteCleanup",[s],!1),"string"==typeof n&&(s=n),""!==s&&(this.insertHTML(s,!0,!0),this.saveSelectionByMarkers(),this.removeBlankSpans(),this.$element.find(this.valid_nodes.join(":empty, ")+":empty").remove(),this.restoreSelectionByMarkers(),this.$element.find("li[data-indent]").each(t.proxy(function(e,i){this.indentLi?(t(i).removeAttr("data-indent"),this.indentLi(t(i))):t(i).removeAttr("data-indent")},this)),this.$element.find("li").each(t.proxy(function(e,i){this.wrapTextInElement(t(i),!0)},this)),this.options.paragraphy&&this.wrapText(!0),this.cleanupLists()),this.afterPaste()},e.prototype.afterPaste=function(){this.uploadPastedImages(),this.checkPlaceholder(),this.pasting=!1,this.triggerEvent("afterPaste",[],!0,!1)},e.prototype.getSelectedHTML=function(){function e(e,s){for(;3==s.nodeType||i.valid_nodes.indexOf(s.tagName)<0;)3!=s.nodeType&&t(e).wrapInner("<"+s.tagName+i.attrs(s)+"></"+s.tagName+">"),s=s.parentNode}var i=this,s="";if("undefined"!=typeof window.getSelection)for(var n=this.getRanges(),o=0;o<n.length;o++){var a=document.createElement("div");a.appendChild(n[o].cloneContents()),e(a,this.getSelectionParent()),s+=a.innerHTML}else"undefined"!=typeof document.selection&&"Text"==document.selection.type&&(s=document.selection.createRange().htmlText);return s},e.prototype.registerPaste=function(){this.$element.on("copy cut",t.proxy(function(){this.isHTML||(e.copiedHTML=this.getSelectedHTML(),e.copiedText=t("<div>").html(e.copiedHTML).text())},this)),this.$element.on("paste",t.proxy(function(e){if(!this.isHTML){if(e.originalEvent&&(e=e.originalEvent),!this.triggerEvent("beforePaste",[],!1))return!1;if(this.clipboardPaste(e))return!1;this.clipboardHTML="",this.pasting=!0,this.scrollPosition=this.$window.scrollTop();var i=!1;if(e&&e.clipboardData&&e.clipboardData.getData){var s="",n=e.clipboardData.types;if(t.Editable.isArray(n))for(var o=0;o<n.length;o++)s+=n[o]+";";else s=n;if(/text\/html/.test(s)?this.clipboardHTML=e.clipboardData.getData("text/html"):/text\/rtf/.test(s)&&this.browser.safari?this.clipboardHTML=e.clipboardData.getData("text/rtf"):/text\/plain/.test(s)&&!this.browser.mozilla&&(this.clipboardHTML=this.escapeEntities(e.clipboardData.getData("text/plain")).replace(/\n/g,"<br/>")),""!==this.clipboardHTML?i=!0:this.clipboardHTML=null,i)return this.processPaste(),e.preventDefault&&(e.stopPropagation(),e.preventDefault()),!1}this.beforePaste()}},this))},e.prototype.clipboardPaste=function(e){if(e&&e.clipboardData&&e.clipboardData.items&&e.clipboardData.items[0]){var i=e.clipboardData.items[0].getAsFile();if(i){var s=new FileReader;return s.onload=t.proxy(function(t){var e=t.target.result;this.insertHTML('<img data-fr-image-pasted="true" src="'+e+'" />'),this.afterPaste()},this),s.readAsDataURL(i),!0}}return!1},e.prototype.uploadPastedImages=function(){this.options.imageUpload&&this.$element.find("img[data-fr-image-pasted]").each(t.proxy(function(e,i){if(this.options.pasteImage){if(0===i.src.indexOf("data:")){if(this.options.defaultImageWidth&&t(i).attr("width",this.options.defaultImageWidth),this.options.pastedImagesUploadURL){if(!this.triggerEvent("beforeUploadPastedImage",[i],!1))return!1;setTimeout(t.proxy(function(){this.showImageLoader(),this.$progress_bar.find("span").css("width","100%").text("Please wait!"),this.showByCoordinates(t(i).offset().left+t(i).width()/2,t(i).offset().top+t(i).height()+10),this.isDisabled=!0},this),10),t.ajax({type:this.options.pastedImagesUploadRequestType,url:this.options.pastedImagesUploadURL,data:t.extend({image:decodeURIComponent(i.src)},this.options.imageUploadParams),crossDomain:this.options.crossDomain,xhrFields:{withCredentials:this.options.withCredentials},headers:this.options.headers,dataType:"json"}).done(t.proxy(function(e){try{if(e.link){var s=new Image;s.onerror=t.proxy(function(){t(i).remove(),this.hide(),this.throwImageError(1)},this),s.onload=t.proxy(function(){i.src=e.link,this.hideImageLoader(),this.hide(),this.enable(),setTimeout(function(){t(i).trigger("touchend")},50),this.triggerEvent("afterUploadPastedImage",[t(i)])},this),s.src=e.link}else e.error?(t(i).remove(),this.hide(),this.throwImageErrorWithMessage(e.error)):(t(i).remove(),this.hide(),this.throwImageError(2))}catch(n){t(i).remove(),this.hide(),this.throwImageError(4)}},this)).fail(t.proxy(function(){t(i).remove(),this.hide(),this.throwImageError(3)},this))}}else 0!==i.src.indexOf("http")&&t(i).remove();t(i).removeAttr("data-fr-image-pasted")}else t(i).remove()},this))},e.prototype.disable=function(){this.isDisabled=!0,this.$element.blur(),this.$box.addClass("fr-disabled"),this.$element.attr("contenteditable",!1)},e.prototype.enable=function(){this.isDisabled=!1,this.$box.removeClass("fr-disabled"),this.$element.attr("contenteditable",!0)},e.prototype.wordClean=function(t){t.indexOf("<body")>=0&&(t=t.replace(/[.\s\S\w\W<>]*<body[^>]*>([.\s\S\w\W<>]*)<\/body>[.\s\S\w\W<>]*/g,"$1")),t=t.replace(/<p(.*?)class="?'?MsoListParagraph"?'? ([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<ul><li>$3</li></ul>"),t=t.replace(/<p(.*?)class="?'?NumberedText"?'? ([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<ol><li>$3</li></ol>"),t=t.replace(/<p(.*?)class="?'?MsoListParagraphCxSpFirst"?'?([\s\S]*?)(level\d)?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<ul><li$3>$5</li>"),t=t.replace(/<p(.*?)class="?'?NumberedTextCxSpFirst"?'?([\s\S]*?)(level\d)?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<ol><li$3>$5</li>"),t=t.replace(/<p(.*?)class="?'?MsoListParagraphCxSpMiddle"?'?([\s\S]*?)(level\d)?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<li$3>$5</li>"),t=t.replace(/<p(.*?)class="?'?NumberedTextCxSpMiddle"?'?([\s\S]*?)(level\d)?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<li$3>$5</li>"),t=t.replace(/<p(.*?)class="?'?MsoListParagraphCxSpLast"?'?([\s\S]*?)(level\d)?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<li$3>$5</li></ul>"),t=t.replace(/<p(.*?)class="?'?NumberedTextCxSpLast"?'?([\s\S]*?)(level\d)?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<li$3>$5</li></ol>"),t=t.replace(/<span([^<]*?)style="?'?mso-list:Ignore"?'?([\s\S]*?)>([\s\S]*?)<span/gi,"<span><span"),t=t.replace(/<!--\[if \!supportLists\]-->([\s\S]*?)<!--\[endif\]-->/gi,""),t=t.replace(/<!\[if \!supportLists\]>([\s\S]*?)<!\[endif\]>/gi,""),t=t.replace(/(\n|\r| class=(")?Mso[a-zA-Z0-9]+(")?)/gi," "),t=t.replace(/<!--[\s\S]*?-->/gi,""),t=t.replace(/<(\/)*(meta|link|span|\\?xml:|st1:|o:|font)(.*?)>/gi,"");for(var e=["style","script","applet","embed","noframes","noscript"],i=0;i<e.length;i++){var s=new RegExp("<"+e[i]+".*?"+e[i]+"(.*?)>","gi");t=t.replace(s,"")}t=t.replace(/([\w\-]*)=("[^<>"]*"|'[^<>']*'|\w+)/gi,""),t=t.replace(/&nbsp;/gi," ");var n;do n=t,t=t.replace(/<[^\/>][^>]*><\/[^>]+>/gi,"");while(t!=n);return t=t.replace(/<lilevel([^1])([^>]*)>/gi,'<li data-indent="true"$2>'),t=t.replace(/<lilevel1([^>]*)>/gi,"<li$1>"),t=this.clean(t),t=t.replace(/<a>(.[^<]+)<\/a>/gi,"$1")},e.prototype.tabs=function(t){for(var e="",i=0;t>i;i++)e+="  ";return e},e.prototype.cleanTags=function(t,e){void 0===e&&(e=!1);var i,s,n,o,a=[],r=[],l=!1,h=!1,d=this.options.formatTags;for(s=0;s<t.length;s++)if(i=t.charAt(s),"<"==i){var p=t.indexOf(">",s+1);if(-1!==p){var c=t.substring(s,p+1),f=this.tagName(c);if(0===f.indexOf("!--")&&(p=t.indexOf("-->",s+1),-1!==p)){c=t.substring(s,p+3),r.push(c),s=p+2;continue}if(0===f.indexOf("!")){r.push(c),s=p;continue}if("head"==f&&this.options.fullPage&&(h=!0),h){r.push(c),s=p,"head"==f&&this.isClosingTag(c)&&(h=!1);continue}if(this.options.allowedTags.indexOf(f)<0&&(!this.options.fullPage||["html","head","body","!doctype"].indexOf(f)<0)){s=p;continue}var m=this.isClosingTag(c);if("pre"===f&&(l=m?!1:!0),this.isSelfClosingTag(c))r.push("br"===f&&l?"\n":c);else if(m)for(n=!1,o=!0;n===!1&&void 0!==o;)o=a.pop(),void 0!==o&&o.tag_name!==f?r.splice(o.i,1):(n=!0,void 0!==o&&r.push(c));else r.push(c),a.push({tag_name:f,i:r.length-1});s=p}}else"\n"===i&&this.options.beautifyCode?e&&l?r.push("<br/>"):l?r.push(i):a.length>0&&r.push(" "):9!=i.charCodeAt(0)&&r.push(i);for(;a.length>0;)o=a.pop(),r.splice(o.i,1);var u="\n";this.options.beautifyCode||(u=""),t="",a=0;var g=!0;for(s=0;s<r.length;s++)1==r[s].length?g&&" "===r[s]||(t+=r[s],g=!1):d.indexOf(this.tagName(r[s]).toLowerCase())<0?(t+=r[s],"br"==this.tagName(r[s])&&(t+=u)):this.isSelfClosingTag(r[s])?d.indexOf(this.tagName(r[s]).toLowerCase())>=0?(t+=this.tabs(a)+r[s]+u,g=!1):t+=r[s]:this.isClosingTag(r[s])?(a-=1,0===a&&(g=!0),t.length>0&&t[t.length-1]==u&&(t+=this.tabs(a)),t+=r[s]+u):(t+=u+this.tabs(a)+r[s],a+=1,g=!1);return t[0]==u&&(t=t.substring(1,t.length)),t[t.length-1]==u&&(t=t.substring(0,t.length-1)),t},e.prototype.cleanupLists=function(){this.$element.find("ul, ol").each(function(e,i){var s=t(i);if(s.find(".close-ul, .open-ul, .close-ol, .open-ol, .open-li, .close-li").length>0){var n="<"+i.tagName.toLowerCase()+">"+s.html()+"</"+i.tagName.toLowerCase()+">";n=n.replace(new RegExp('<span class="close-ul" data-fr-verified="true"></span>',"g"),"</ul>"),n=n.replace(new RegExp('<span class="open-ul" data-fr-verified="true"></span>',"g"),"<ul>"),n=n.replace(new RegExp('<span class="close-ol" data-fr-verified="true"></span>',"g"),"</ol>"),n=n.replace(new RegExp('<span class="open-ol" data-fr-verified="true"></span>',"g"),"<ol>"),n=n.replace(new RegExp('<span class="close-li" data-fr-verified="true"></span>',"g"),"</li>"),n=n.replace(new RegExp('<span class="open-li" data-fr-verified="true"></span>',"g"),"<li>"),s.replaceWith(n)}}),this.$element.find("li > td").remove(),this.$element.find("li td:empty").append(t.Editable.INVISIBLE_SPACE),this.$element.find(" > li").wrap("<ul>"),this.$element.find("ul, ol").each(t.proxy(function(e,i){var s=t(i);0===s.find(this.valid_nodes.join(",")).length&&s.remove()},this)),this.$element.find("li > ul, li > ol").each(t.proxy(function(e,i){this.isFirstSibling(i)&&t(i).before("<br/>")},this)),this.$element.find("li:empty").remove();for(var e=this.$element.find("ol + ol, ul + ul"),i=0;i<e.length;i++){var s=t(e[i]);this.attrs(e[i])==this.attrs(s.prev().get(0))&&(s.prev().append(s.html()),s.remove())}this.$element.find("li > td").remove(),this.$element.find("li td:empty").append(t.Editable.INVISIBLE_SPACE),this.$element.find("li > "+this.options.defaultTag).each(function(e,i){0===i.attributes.length&&t(i).replaceWith(t(i).html())})},e.prototype.escapeEntities=function(t){return t.replace(/</gi,"&lt;").replace(/>/gi,"&gt;").replace(/"/gi,"&quot;").replace(/'/gi,"&apos;")},e.prototype.cleanNodeAttrs=function(t,e){var i=t.attributes;if(i)for(var s=new RegExp("^"+e.join("$|^")+"$","i"),n=0;n<i.length;n++){var o=i[n];s.test(o.nodeName)?t.setAttribute(o.nodeName,this.escapeEntities(o.nodeValue)):t.removeAttribute(o.nodeName)}},e.prototype.cleanAttrs=function(t){1==t.nodeType&&t.className.indexOf("f-marker")<0&&t!==this.$element.get(0)&&"IFRAME"!=t.tagName&&this.cleanNodeAttrs(t,this.options.allowedAttrs,!0);for(var e=t.childNodes,i=0;i<e.length;i++)this.cleanAttrs(e[i])},e.prototype.clean=function(i,s,n,o,a){this.pasting&&e.copiedText===t("<div>").html(i).text()&&(n=!1,s=!0),a||(a=t.merge([],this.options.allowedAttrs)),o||(o=t.merge([],this.options.allowedTags)),s||a.indexOf("id")>-1&&a.splice(a.indexOf("id"),1),this.options.fullPage&&(i=i.replace(/<!DOCTYPE([^>]*?)>/i,"<!-- DOCTYPE$1 -->"),i=i.replace(/<html([^>]*?)>/i,"<!-- html$1 -->"),i=i.replace(/<\/html([^>]*?)>/i,"<!-- /html$1 -->"),i=i.replace(/<body([^>]*?)>/i,"<!-- body$1 -->"),i=i.replace(/<\/body([^>]*?)>/i,"<!-- /body$1 -->"),i=i.replace(/<head>([\w\W]*)<\/head>/i,function(t,e){var i=1;return e=e.replace(/(<style)/gi,function(t,e){return e+" data-id="+i++}),"<!-- head "+e.replace(/(>)([\s|\t]*)(<)/gi,"$1$3").replace(/</gi,"[").replace(/>/gi,"]")+" -->"})),this.options.allowComments?(this.options.allowedTags.push("!--"),this.options.allowedTags.push("!")):i=i.replace(/<!--.*?-->/gi,""),this.options.allowScript||(i=i.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"")),this.options.allowStyle||(i=i.replace(/<style\b[^<]*(?:(?!<\/style>)<[^<]*)*<\/style>/gi,""));var r=new RegExp("<\\/?((?!(?:"+o.join(" |")+" |"+o.join(">|")+">|"+o.join("/>|")+"/>))\\w+)[^>]*?>","gi");if(i=i.replace(r,""),n){var l=new RegExp("style=(\"[a-zA-Z0-9:;\\.\\s\\(\\)\\-\\,!\\/'%]*\"|'[a-zA-Z0-9:;\\.\\s\\(\\)\\-\\,!\\/\"%]*')","gi");i=i.replace(l,""),i=i.replace(/<style\b[^<]*(?:(?!<\/style>)<[^<]*)*<\/style>/gi,"")}i=this.cleanTags(i,!0),
i=i.replace(/(\r|\n)/gi,"");var h=new RegExp("<([^>]*)( src| href)=('[^']*'|\"[^\"]*\"|[^\\s>]+)([^>]*)>","gi");if(i=i.replace(h,t.proxy(function(t,e,i,s,n){return"<"+e+i+'="'+this.sanitizeURL(s.replace(/^["'](.*)["']\/?$/gi,"$1"))+'"'+n+">"},this)),!s){var d=t("<div>").append(i);d.find('[class]:not([class^="fr-"])').each(function(e,i){t(i).removeAttr("class")}),i=d.html()}return i},e.prototype.removeBlankSpans=function(){this.no_verify=!0,this.$element.find("span").removeAttr("data-fr-verified"),this.$element.find("span").each(t.proxy(function(e,i){0===this.attrs(i).length&&t(i).replaceWith(t(i).html())},this)),this.$element.find("span").attr("data-fr-verified",!0),this.no_verify=!1},e.prototype.plainPasteClean=function(e){var i=t("<div>").html(e);i.find("p, div, h1, h2, h3, h4, h5, h6, pre, blockquote").each(t.proxy(function(e,i){t(i).replaceWith("<"+this.options.defaultTag+">"+t(i).html()+"</"+this.options.defaultTag+">")},this)),t(i.find("*").not("p, div, h1, h2, h3, h4, h5, h6, pre, blockquote, ul, ol, li, table, tbody, thead, tr, td").get().reverse()).each(function(){t(this).replaceWith(t(this).html())});var s=function(e){for(var i=e.contents(),n=0;n<i.length;n++)3!=i[n].nodeType&&1!=i[n].nodeType?t(i[n]).remove():s(t(i[n]))};return s(i),i.html()},e.prototype.removeEmptyTags=function(e){for(var i,s=t("<div>").html(e),n=s.find("*:empty:not(br, img, td, th)");n.length;){for(i=0;i<n.length;i++)t(n[i]).remove();n=s.find("*:empty:not(br, img, td, th)")}for(var o=s.find("> div, td > div, th > div, li > div");o.length;){var a=t(o[o.length-1]);a.replaceWith(a.html()+"<br/>"),o=s.find("> div, td > div, th > div, li > div")}for(o=s.find("div");o.length;){for(i=0;i<o.length;i++){var r=t(o[i]),l=r.html().replace(/\u0009/gi,"").trim();r.replaceWith(l)}o=s.find("div")}return s.html()},e.prototype.initElementStyle=function(){this.editableDisabled||this.$element.attr("contenteditable",!0);var t="froala-view froala-element "+this.options.editorClass;this.browser.msie&&e.getIEversion()<9&&(t+=" ie8"),this.$element.css("outline",0),this.browser.msie||(t+=" not-msie"),this.$element.addClass(t)},e.prototype.CJKclean=function(t){var e=/[\u3041-\u3096\u30A0-\u30FF\u4E00-\u9FFF\u3130-\u318F\uAC00-\uD7AF]/gi;return t.replace(e,"")},e.prototype.enableTyping=function(){this.typingTimer=null,this.$element.on("keydown","textarea, input",function(t){t.stopPropagation()}),this.$element.on("keydown cut",t.proxy(function(e){if(!this.isHTML){if(!this.options.multiLine&&13==e.which)return e.preventDefault(),e.stopPropagation(),!1;if("keydown"===e.type&&!this.triggerEvent("keydown",[e],!1))return!1;clearTimeout(this.typingTimer),this.ajaxSave=!1,this.oldHTML=this.getHTML(!0,!1),this.typingTimer=setTimeout(t.proxy(function(){var t=this.getHTML(!0,!1);this.ime||this.CJKclean(t)===this.CJKclean(this.oldHTML)||this.CJKclean(t)!==t||this.sync()},this),Math.max(this.options.typingTimer,500))}},this))},e.prototype.removeMarkersByRegex=function(t){return t.replace(/<span[^>]*? class\s*=\s*["']?f-marker["']?[^>]+>([\S\s][^\/])*<\/span>/gi,"")},e.prototype.getImageHTML=function(){return JSON.stringify({src:this.$element.find("img").attr("src"),style:this.$element.find("img").attr("style"),alt:this.$element.find("img").attr("alt"),width:this.$element.find("img").attr("width"),link:this.$element.find("a").attr("href"),link_title:this.$element.find("a").attr("title"),link_target:this.$element.find("a").attr("target")})},e.prototype.getLinkHTML=function(){return JSON.stringify({body:this.$element.html(),href:this.$element.attr("href"),title:this.$element.attr("title"),popout:this.$element.hasClass("popout"),nofollow:"nofollow"==this.$element.attr("ref"),blank:"_blank"==this.$element.attr("target"),cls:this.$element.attr("class")?this.$element.attr("class").replace(/froala-element ?|not-msie ?|froala-view ?/gi,"").trim():""})},e.prototype.addFrTag=function(){this.$element.find(this.valid_nodes.join(",")+", table, ul, ol, img").addClass("fr-tag")},e.prototype.removeFrTag=function(){this.$element.find(this.valid_nodes.join(",")+", table, ul, ol, img").removeClass("fr-tag")},e.prototype.getHTML=function(e,i,s){if(void 0===e&&(e=!1),void 0===i&&(i=this.options.useFrTag),void 0===s&&(s=!0),this.$element.hasClass("f-placeholder")&&!e)return"";if(this.isHTML)return this.$html_area.val();if(this.isImage)return this.getImageHTML();if(this.isLink)return this.getLinkHTML();this.$element.find("a").data("fr-link",!0),i&&this.addFrTag(),this.$element.find(".f-img-editor > img").each(t.proxy(function(e,i){t(i).removeClass("fr-fin fr-fil fr-fir fr-dib fr-dii").addClass(this.getImageClass(t(i).parent().attr("class")))},this)),this.options.useClasses||this.$element.find("img").each(t.proxy(function(e,i){var s=t(i);s.attr("data-style",this.getImageStyle(s))},this)),this.$element.find("pre").each(t.proxy(function(e,i){var s=t(i),n=s.html(),o=n.replace(/\&nbsp;/gi," ");n!=o&&(this.saveSelectionByMarkers(),s.html(o),this.restoreSelectionByMarkers())},this)),this.$element.find("pre br").addClass("fr-br"),this.$element.find('[class=""]').removeAttr("class"),this.cleanAttrs(this.$element.get(0));var n=this.$element.html();this.removeFrTag(),this.$element.find("pre br").removeAttr("class"),n=n.replace(/<a[^>]*?><\/a>/g,""),e||(n=this.removeMarkersByRegex(n)),n=n.replace(/<span[^>]*? class\s*=\s*["']?f-img-handle[^>]+><\/span>/gi,""),n=n.replace(/^([\S\s]*)<span[^>]*? class\s*=\s*["']?f-img-editor[^>]+>([\S\s]*)<\/span>([\S\s]*)$/gi,"$1$2$3"),n=n.replace(/^([\S\s]*)<span[^>]*? class\s*=\s*["']?f-img-wrap[^>]+>([\S\s]*)<\/span>([\S\s]*)$/gi,"$1$2$3"),this.options.useClasses||(n=n.replace(/data-style/gi,"style"),n=n.replace(/(<img[^>]*)( class\s*=['"]?[a-zA-Z0-9- ]+['"]?)([^>]*\/?>)/gi,"$1$3")),this.options.simpleAmpersand&&(n=n.replace(/\&amp;/gi,"&")),s&&(n=n.replace(/ data-fr-verified="true"/gi,"")),this.options.beautifyCode&&(n=n.replace(/\n/gi,"")),n=n.replace(/<br class="fr-br">/gi,"\n"),n=n.replace(/\u200B/gi,""),this.options.fullPage&&(n=n.replace(/<!-- DOCTYPE([^>]*?) -->/i,"<!DOCTYPE$1>"),n=n.replace(/<!-- html([^>]*?) -->/i,"<html$1>"),n=n.replace(/<!-- \/html([^>]*?) -->/i,"</html$1>"),n=n.replace(/<!-- body([^>]*?) -->/i,"<body$1>"),n=n.replace(/<!-- \/body([^>]*?) -->/i,"</body$1>"),n=n.replace(/<!-- head ([\w\W]*?) -->/i,function(t,e){return"<head>"+e.replace(/\[/gi,"<").replace(/\]/gi,">")+"</head>"}));var o=this.triggerEvent("getHTML",[n],!1);return"string"==typeof o?o:n},e.prototype.getText=function(){return this.$element.text()},e.prototype.setDirty=function(t){this.dirty=t,t||(clearTimeout(this.ajaxInterval),this.ajaxHTML=this.getHTML(!1,!1))},e.prototype.initAjaxSaver=function(){this.ajaxHTML=this.getHTML(!1,!1),this.ajaxSave=!0,this.ajaxInterval=setInterval(t.proxy(function(){var t=this.getHTML(!1,!1);(this.ajaxHTML!=t||this.dirty)&&this.ajaxSave&&(this.options.autosave&&this.save(),this.dirty=!1,this.ajaxHTML=t),this.ajaxSave=!0},this),Math.max(this.options.autosaveInterval,100))},e.prototype.disableBrowserUndo=function(){this.$element.keydown(t.proxy(function(t){var e=t.which,i=(t.ctrlKey||t.metaKey)&&!t.altKey;if(!this.isHTML&&i){if(90==e&&t.shiftKey)return t.preventDefault(),!1;if(90==e)return t.preventDefault(),!1}},this))},e.prototype.shortcutEnabled=function(t){return this.options.shortcutsAvailable.indexOf(t)>=0},e.prototype.shortcuts_map={69:{cmd:"show",params:[null],id:"show"},66:{cmd:"exec",params:["bold"],id:"bold"},73:{cmd:"exec",params:["italic"],id:"italic"},85:{cmd:"exec",params:["underline"],id:"underline"},83:{cmd:"exec",params:["strikeThrough"],id:"strikeThrough"},75:{cmd:"exec",params:["createLink"],id:"createLink"},80:{cmd:"exec",params:["insertImage"],id:"insertImage"},221:{cmd:"exec",params:["indent"],id:"indent"},219:{cmd:"exec",params:["outdent"],id:"outdent"},72:{cmd:"exec",params:["html"],id:"html"},48:{cmd:"exec",params:["formatBlock","n"],id:"formatBlock n"},49:{cmd:"exec",params:["formatBlock","h1"],id:"formatBlock h1"},50:{cmd:"exec",params:["formatBlock","h2"],id:"formatBlock h2"},51:{cmd:"exec",params:["formatBlock","h3"],id:"formatBlock h3"},52:{cmd:"exec",params:["formatBlock","h4"],id:"formatBlock h4"},53:{cmd:"exec",params:["formatBlock","h5"],id:"formatBlock h5"},54:{cmd:"exec",params:["formatBlock","h6"],id:"formatBlock h6"},222:{cmd:"exec",params:["formatBlock","blockquote"],id:"formatBlock blockquote"},220:{cmd:"exec",params:["formatBlock","pre"],id:"formatBlock pre"}},e.prototype.ctrlKey=function(t){if(-1!=navigator.userAgent.indexOf("Mac OS X")){if(t.metaKey&&!t.altKey)return!0}else if(t.ctrlKey&&!t.altKey)return!0;return!1},e.prototype.initShortcuts=function(){this.options.shortcuts&&this.$element.on("keydown",t.proxy(function(t){var e=t.which,i=this.ctrlKey(t);if(!this.isHTML&&i){if(this.shortcuts_map[e]&&this.shortcutEnabled(this.shortcuts_map[e].id))return this.execDefaultShortcut(this.shortcuts_map[e].cmd,this.shortcuts_map[e].params);if(90==e&&t.shiftKey)return t.preventDefault(),t.stopPropagation(),this.redo(),!1;if(90==e)return t.preventDefault(),t.stopPropagation(),this.undo(),!1}},this))},e.prototype.initTabs=function(){this.$element.on("keydown",t.proxy(function(t){var e=t.which;if(9!=e||t.shiftKey)9==e&&t.shiftKey&&(this.raiseEvent("shift+tab")?this.options.tabSpaces?t.preventDefault():this.blur():t.preventDefault());else if(this.raiseEvent("tab"))if(this.options.tabSpaces){t.preventDefault();var i="&nbsp;&nbsp;&nbsp;&nbsp;",s=this.getSelectionElements()[0];"PRE"===s.tagName&&(i="    "),this.insertHTML(i,!1)}else this.blur();else t.preventDefault()},this))},e.prototype.textEmpty=function(e){var i=t(e).text().replace(/(\r\n|\n|\r|\t)/gm,"");return(""===i||e===this.$element.get(0))&&0===t(e).find("br").length},e.prototype.inEditor=function(t){for(;t&&"BODY"!==t.tagName;){if(t===this.$element.get(0))return!0;t=t.parentNode}return!1},e.prototype.focus=function(e){if(this.isDisabled)return!1;if(void 0===e&&(e=!0),""!==this.text()&&!this.$element.is(":focus"))return void(this.browser.msie||(this.clearSelection(),this.$element.focus()));if(!this.isHTML){if(e&&!this.pasting&&this.$element.focus(),this.pasting&&!this.$element.is(":focus")&&this.$element.focus(),this.$element.hasClass("f-placeholder"))return void this.setSelection(this.$element.find(this.options.defaultTag).length>0?this.$element.find(this.options.defaultTag)[0]:this.$element.get(0));var i=this.getRange();if(""===this.text()&&i&&(0===i.startOffset||i.startContainer===this.$element.get(0)||!this.inEditor(i.startContainer))){var s,n,o=this.getSelectionElements();if(t.merge(["IMG","BR"],this.valid_nodes).indexOf(this.getSelectionElement().tagName)<0)return!1;if(i.startOffset>0&&this.valid_nodes.indexOf(this.getSelectionElement().tagName)>=0&&"BODY"!=i.startContainer.tagName||i.startContainer&&3===i.startContainer.nodeType)return;if(!this.options.paragraphy&&o.length>=1&&o[0]===this.$element.get(0)){var a=function(e){if(!e)return null;if(3==e.nodeType&&e.textContent.length>0)return e;if(1==e.nodeType&&"BR"==e.tagName)return e;for(var i=t(e).contents(),s=0;s<i.length;s++){var n=a(i[s]);if(null!=n)return n}return null};if(0===i.startOffset&&this.$element.contents().length>0&&3!=this.$element.contents()[0].nodeType){var r=a(this.$element.get(0));null!=r&&("BR"==r.tagName?this.$element.is(":focus")&&(t(r).before(this.markers_html),this.restoreSelectionByMarkers()):this.setSelection(r))}return!1}if(o.length>=1&&o[0]!==this.$element.get(0))for(s=0;s<o.length;s++){if(n=o[s],!this.textEmpty(n)||this.browser.msie)return void this.setSelection(n);if(this.textEmpty(n)&&["LI","TD"].indexOf(n.tagName)>=0)return}if(i.startContainer===this.$element.get(0)&&i.startOffset>0&&!this.options.paragraphy)return void this.setSelection(this.$element.get(0),i.startOffset);for(o=this.$element.find(this.valid_nodes.join(",")),s=0;s<o.length;s++)if(n=o[s],!this.textEmpty(n)&&0===t(n).find(this.valid_nodes.join(",")).length)return void this.setSelection(n);this.setSelection(this.$element.get(0))}}},e.prototype.addMarkersAtEnd=function(e){var i=e.find(this.valid_nodes.join(", "));0===i.length&&i.push(e.get(0));var s=i[i.length-1];t(s).append(this.markers_html)},e.prototype.setFocusAtEnd=function(t){void 0===t&&(t=this.$element),this.addMarkersAtEnd(t),this.restoreSelectionByMarkers()},e.prototype.breakHTML=function(e,i){"undefined"==typeof i&&(i=!0),this.removeMarkers(),0===this.$element.find("break").length&&this.insertSimpleHTML("<break></break>");var s=this.parents(this.$element.find("break"),t.merge(["UL","OL"],this.valid_nodes).join(","))[0];if(this.parents(t(s),"ul, ol").length&&(s=this.parents(t(s),"ul, ol")[0]),void 0===s&&(s=this.$element.get(0)),["UL","OL"].indexOf(s.tagName)>=0){var n=t("<div>").html(e);n.find("> li").wrap("<"+s.tagName+">"),e=n.html()}if(s==this.$element.get(0)){if(this.$element.find("break").next().length){this.insertSimpleHTML('<div id="inserted-div">'+e+"</div>");var o=this.$element.find("div#inserted-div");this.setFocusAtEnd(o),this.saveSelectionByMarkers(),o.replaceWith(o.contents()),this.restoreSelectionByMarkers()}else this.insertSimpleHTML(e),this.setFocusAtEnd();return this.$element.find("break").remove(),this.checkPlaceholder(),!0}if("TD"===s.tagName)return this.$element.find("break").remove(),this.insertSimpleHTML(e),!0;var a=t("<div>").html(e);if(this.addMarkersAtEnd(a),e=a.html(),this.emptyElement(t(s)))return t(s).replaceWith(e),this.restoreSelectionByMarkers(),this.checkPlaceholder(),!0;this.$element.find("li").each(t.proxy(function(e,i){this.emptyElement(i)&&t(i).addClass("empty-li")},this));for(var r,l,h=t("<div></div>").append(t(s).clone()).html(),d=[],p={},c=[],f=0,m=0;m<h.length;m++)if(l=h.charAt(m),"<"==l){var u=h.indexOf(">",m+1);if(-1!==u){r=h.substring(m,u+1);var g=this.tagName(r);if(m=u,"break"==g){if(!this.isClosingTag(r)){for(var v=!0,b=[],y=d.length-1;y>=0;y--){var w=this.tagName(d[y]);if(!i&&"LI"==w.toUpperCase()){v=!1;break}c.push("</"+w+">"),b.push(d[y])}c.push(e),v||c.push("</li><li>");for(var $=0;$<b.length;$++)c.push(b[$])}}else if(c.push(r),!this.isSelfClosingTag(r))if(this.isClosingTag(r)){var k=p[g].pop();d.splice(k,1)}else d.push(r),void 0===p[g]&&(p[g]=[]),p[g].push(d.length-1)}}else f++,c.push(l);t(s).replaceWith(c.join("")),this.$element.find("li").each(t.proxy(function(e,i){var s=t(i);s.hasClass("empty-li")?s.removeClass("empty-li"):this.emptyElement(i)&&s.remove()},this)),this.cleanupLists(),this.restoreSelectionByMarkers()},e.prototype.insertSimpleHTML=function(t){var e,i;if(this.no_verify=!0,this.window.getSelection){if(e=this.window.getSelection(),e.getRangeAt&&e.rangeCount){i=e.getRangeAt(0),this.browser.webkit?i.collapsed||document.execCommand("delete"):i.deleteContents(),this.$element.find(this.valid_nodes.join(":empty, ")+":empty").remove();var s=this.document.createElement("div");s.innerHTML=t;for(var n,o,a=this.document.createDocumentFragment();n=s.firstChild;)o=a.appendChild(n);i.insertNode(a),o&&(i=i.cloneRange(),i.setStartAfter(o),i.collapse(!0),e.removeAllRanges(),e.addRange(i))}}else if((e=this.document.selection)&&"Control"!=e.type){var r=e.createRange();r.collapse(!0),e.createRange().pasteHTML(t)}this.no_verify=!1},e.prototype.insertHTML=function(e,i,s){if(void 0===i&&(i=!0),void 0===s&&(s=!1),!this.isHTML&&i&&this.focus(),this.removeMarkers(),this.insertSimpleHTML("<break></break>"),this.checkPlaceholder(!0),this.$element.hasClass("f-placeholder"))return this.$element.html(e),this.options.paragraphy&&this.wrapText(!0),this.$element.find("p > br").each(function(){var e=this.parentNode;1==t(e).contents().length&&t(e).remove()}),this.$element.find("break").remove(),this.setFocusAtEnd(),this.checkPlaceholder(),this.convertNewLines(),!1;for(var n=t("<div>").append(e).find("*"),o=0;o<n.length;o++)if(this.valid_nodes.indexOf(n[o].tagName)>=0)return this.breakHTML(e),this.$element.find("break").remove(),this.convertNewLines(),!1;this.$element.find("break").remove(),this.insertSimpleHTML(e),this.convertNewLines()},e.prototype.execDefaultShortcut=function(t,e){return this[t].apply(this,e),!1},e.prototype.initEditor=function(){var i="froala-editor";this.mobile()&&(i+=" touch"),this.browser.msie&&e.getIEversion()<9&&(i+=" ie8"),this.$editor=t('<div class="'+i+'" style="display: none;">');var s=this.$document.find(this.options.scrollableContainer);s.append(this.$editor),this.options.inlineMode?this.initInlineEditor():this.initBasicEditor()},e.prototype.refreshToolbarPosition=function(){this.$window.scrollTop()>this.$box.offset().top&&this.$window.scrollTop()<this.$box.offset().top+this.$box.outerHeight()-this.$editor.outerHeight()?(this.$element.css("padding-top",this.$editor.outerHeight()+this.$element.data("padding-top")),this.$placeholder.css("margin-top",this.$editor.outerHeight()+this.$element.data("padding-top")),this.$editor.addClass("f-scroll").removeClass("f-scroll-abs").css("bottom","").css("left",this.$box.offset().left+parseFloat(this.$box.css("padding-left"),10)-this.$window.scrollLeft()).width(this.$box.width()-parseFloat(this.$editor.css("border-left-width"),10)-parseFloat(this.$editor.css("border-right-width"),10)),this.iOS()&&(this.$element.is(":focus")?this.$editor.css("top",this.$window.scrollTop()):this.$editor.css("top",""))):this.$window.scrollTop()<this.$box.offset().top?this.iOS()&&this.$element.is(":focus")?(this.$element.css("padding-top",this.$editor.outerHeight()+this.$element.data("padding-top")),this.$placeholder.css("margin-top",this.$editor.outerHeight()+this.$element.data("padding-top")),this.$editor.addClass("f-scroll").removeClass("f-scroll-abs").css("bottom","").css("left",this.$box.offset().left+parseFloat(this.$box.css("padding-left"),10)-this.$window.scrollLeft()).width(this.$box.width()-parseFloat(this.$editor.css("border-left-width"),10)-parseFloat(this.$editor.css("border-right-width"),10)),this.$editor.css("top",this.$box.offset().top)):(this.$editor.removeClass("f-scroll f-scroll-abs").css("bottom","").css("top","").width(""),this.$element.css("padding-top",""),this.$placeholder.css("margin-top","")):this.$window.scrollTop()>this.$box.offset().top+this.$box.outerHeight()-this.$editor.outerHeight()&&!this.$editor.hasClass("f-scroll-abs")&&(this.$element.css("padding-top",this.$editor.outerHeight()+this.$element.data("padding-top")),this.$placeholder.css("margin-top",this.$editor.outerHeight()+this.$element.data("padding-top")),this.$editor.removeClass("f-scroll").addClass("f-scroll-abs"),this.$editor.css("bottom",0).css("top","").css("left",""))},e.prototype.toolbarTop=function(){this.options.toolbarFixed||this.options.inlineMode||(this.$element.data("padding-top",parseInt(this.$element.css("padding-top"),10)),this.$window.on("scroll resize load",t.proxy(function(){this.refreshToolbarPosition()},this)),this.iOS()&&this.$element.on("focus blur",t.proxy(function(){this.refreshToolbarPosition()},this)))},e.prototype.initBasicEditor=function(){this.$element.addClass("f-basic"),this.$wrapper.addClass("f-basic"),this.$popup_editor=this.$editor.clone();var t=this.$document.find(this.options.scrollableContainer);this.$popup_editor.appendTo(t).addClass("f-inline"),this.$editor.addClass("f-basic").show(),this.$editor.insertBefore(this.$wrapper),this.toolbarTop()},e.prototype.initInlineEditor=function(){this.$editor.addClass("f-inline"),this.$element.addClass("f-inline"),this.$popup_editor=this.$editor},e.prototype.initDrag=function(){this.drag_support={filereader:"undefined"!=typeof FileReader,formdata:!!this.window.FormData,progress:"upload"in new XMLHttpRequest}},e.prototype.initOptions=function(){this.setDimensions(),this.setSpellcheck(),this.setImageUploadURL(),this.setButtons(),this.setDirection(),this.setZIndex(),this.setTheme(),this.options.editInPopup&&this.buildEditPopup(),this.editableDisabled||(this.setPlaceholder(),this.setPlaceholderEvents())},e.prototype.setAllowStyle=function(t){"undefined"==typeof t&&(t=this.options.allowStyle),t?this.options.allowedTags.push("style"):this.options.allowedTags.splice(this.options.allowedTags.indexOf("style"),1)},e.prototype.setAllowScript=function(t){"undefined"==typeof t&&(t=this.options.allowScript),t?this.options.allowedTags.push("script"):this.options.allowedTags.splice(this.options.allowedTags.indexOf("script"),1)},e.prototype.isTouch=function(){return WYSIWYGModernizr.touch&&void 0!==this.window.Touch},e.prototype.initEditorSelection=function(){this.$element.on("keyup",t.proxy(function(t){return this.triggerEvent("keyup",[t],!1)},this)),this.$element.on("focus",t.proxy(function(){this.blurred&&(this.blurred=!1,this.pasting||""!==this.text()||this.focus(!1),this.triggerEvent("focus",[],!1))},this)),this.$element.on("mousedown touchstart",t.proxy(function(){return this.isDisabled?!1:void(this.isResizing()||(this.closeImageMode(),this.hide()))},this)),this.options.disableRightClick&&this.$element.contextmenu(t.proxy(function(t){return t.preventDefault(),this.options.inlineMode&&this.$element.focus(),!1},this)),this.$element.on(this.mouseup,t.proxy(function(e){if(this.isDisabled)return!1;if(!this.isResizing()){var i=this.text();e.stopPropagation(),this.imageMode=!1,!(""!==i||this.options.alwaysVisible||this.options.editInPopup||(3==e.which||2==e.button)&&this.options.inlineMode&&!this.isImage&&this.options.disableRightClick)||this.link||this.imageMode?this.options.inlineMode||this.refreshButtons():setTimeout(t.proxy(function(){i=this.text(),!(""!==i||this.options.alwaysVisible||this.options.editInPopup||(3==e.which||2==e.button)&&this.options.inlineMode&&!this.isImage&&this.options.disableRightClick)||this.link||this.imageMode||(this.show(e),this.options.editInPopup&&this.showEditPopup())},this),0)}this.hideDropdowns(),this.hideOtherEditors()},this)),this.$editor.on(this.mouseup,t.proxy(function(t){return this.isDisabled?!1:void(this.isResizing()||(t.stopPropagation(),this.options.inlineMode===!1&&this.hide()))},this)),this.$editor.on("mousedown",".fr-dropdown-menu",t.proxy(function(t){return this.isDisabled?!1:(t.stopPropagation(),void(this.noHide=!0))},this)),this.$popup_editor.on("mousedown",".fr-dropdown-menu",t.proxy(function(t){return this.isDisabled?!1:(t.stopPropagation(),void(this.noHide=!0))},this)),this.$popup_editor.on("mouseup",t.proxy(function(t){return this.isDisabled?!1:void(this.isResizing()||t.stopPropagation())},this)),this.$edit_popup_wrapper&&this.$edit_popup_wrapper.on("mouseup",t.proxy(function(t){return this.isDisabled?!1:void(this.isResizing()||t.stopPropagation())},this)),this.setDocumentSelectionChangeEvent(),this.setWindowMouseUpEvent(),this.setWindowKeyDownEvent(),this.setWindowKeyUpEvent(),this.setWindowOrientationChangeEvent(),this.setWindowHideEvent(),this.setWindowBlurEvent(),this.options.trackScroll&&this.setWindowScrollEvent(),this.setWindowResize()},e.prototype.setWindowResize=function(){this.$window.on("resize."+this._id,t.proxy(function(){this.hide(),this.closeImageMode(),this.imageMode=!1},this))},e.prototype.blur=function(e){this.blurred||this.pasting||(this.selectionDisabled=!0,this.triggerEvent("blur",[]),e&&0===t("*:focus").length&&this.clearSelection(),this.isLink||this.isImage||(this.selectionDisabled=!1),this.blurred=!0)},e.prototype.setWindowBlurEvent=function(){this.$window.on("blur."+this._id,t.proxy(function(t,e){this.blur(e)},this))},e.prototype.setWindowHideEvent=function(){this.$window.on("hide."+this._id,t.proxy(function(){this.isResizing()?this.$element.find(".f-img-handle").trigger("moveend"):this.hide(!1)},this))},e.prototype.setWindowOrientationChangeEvent=function(){this.$window.on("orientationchange."+this._id,t.proxy(function(){setTimeout(t.proxy(function(){this.hide()},this),10)},this))},e.prototype.setDocumentSelectionChangeEvent=function(){this.$document.on("selectionchange."+this._id,t.proxy(function(e){return this.isDisabled?!1:void(this.isResizing()||this.isScrolling||(clearTimeout(this.selectionChangedTimeout),this.selectionChangedTimeout=setTimeout(t.proxy(function(){if(this.options.inlineMode&&this.selectionInEditor()&&this.link!==!0&&this.isTouch()){var t=this.text();""!==t?(this.iPod()?this.options.alwaysVisible&&this.hide():this.show(null),e.stopPropagation()):this.options.alwaysVisible?this.show(null):(this.hide(),this.closeImageMode(),this.imageMode=!1)}},this),75)))},this))},e.prototype.setWindowMouseUpEvent=function(){this.$window.on(this.mouseup+"."+this._id,t.proxy(function(){return this.browser.webkit&&!this.initMouseUp?(this.initMouseUp=!0,!1):(this.isResizing()||this.isScrolling||this.isDisabled||(this.$bttn_wrapper.find("button.fr-trigger").removeClass("active"),this.selectionInEditor()&&""!==this.text()&&!this.isTouch()?this.show(null):this.$popup_editor.is(":visible")&&(this.hide(),this.closeImageMode(),this.imageMode=!1),this.blur(!0)),void t("[data-down]").removeAttr("data-down"))},this))},e.prototype.setWindowKeyDownEvent=function(){this.$window.on("keydown."+this._id,t.proxy(function(e){var i=e.which;if(27==i&&(this.focus(),this.restoreSelection(),this.hide(),this.closeImageMode(),this.imageMode=!1),this.imageMode){if(13==i)return this.$element.find(".f-img-editor").parents(".f-img-wrap").before("<br/>"),this.sync(),this.$element.find(".f-img-editor img").click(),!1;if(46==i||8==i)return e.stopPropagation(),e.preventDefault(),setTimeout(t.proxy(function(){this.removeImage(this.$element.find(".f-img-editor img"))},this),0),!1}else if(this.selectionInEditor()){if(this.isDisabled)return!0;var s=(e.ctrlKey||e.metaKey)&&!e.altKey;!s&&this.$popup_editor.is(":visible")&&this.$bttn_wrapper.is(":visible")&&this.options.inlineMode&&(this.hide(),this.closeImageMode(),this.imageMode=!1)}},this))},e.prototype.setWindowKeyUpEvent=function(){this.$window.on("keyup."+this._id,t.proxy(function(){return this.isDisabled?!1:void(this.selectionInEditor()&&""!==this.text()&&!this.$popup_editor.is(":visible")&&this.repositionEditor())},this))},e.prototype.setWindowScrollEvent=function(){t.merge(this.$window,t(this.options.scrollableContainer)).on("scroll."+this._id,t.proxy(function(){return this.isDisabled?!1:(clearTimeout(this.scrollTimer),this.isScrolling=!0,void(this.scrollTimer=setTimeout(t.proxy(function(){this.isScrolling=!1},this),2500)))},this))},e.prototype.setPlaceholder=function(e){e&&(this.options.placeholder=e),this.$textarea&&this.$textarea.attr("placeholder",this.options.placeholder),this.$placeholder||(this.$placeholder=t('<span class="fr-placeholder" unselectable="on"></span>').bind("click",t.proxy(function(){this.focus()},this)),this.$element.after(this.$placeholder)),this.$placeholder.text(this.options.placeholder)},e.prototype.isEmpty=function(){var e=this.$element.text().replace(/(\r\n|\n|\r|\t|\u200B|\u0020)/gm,"");return""===e&&0===this.$element.find("img, table, iframe, input, textarea, hr, li, object").length&&0===this.$element.find(this.options.defaultTag+" > br, br").length&&0===this.$element.find(t.map(this.valid_nodes,t.proxy(function(t){return this.options.defaultTag==t?null:t},this)).join(", ")).length},e.prototype.checkPlaceholder=function(i){if(this.isDisabled&&!i)return!1;if(this.pasting&&!i)return!1;if(this.$element.find("td:empty, th:empty").append(t.Editable.INVISIBLE_SPACE),this.$element.find(this.valid_nodes.join(":empty, ")+":empty").append(this.br),!this.isHTML)if(this.isEmpty()&&!this.fakeEmpty()){var s,n=this.selectionInEditor()||this.$element.is(":focus");this.options.paragraphy?(s=t("<"+this.options.defaultTag+">"+this.br+"</"+this.options.defaultTag+">"),this.$element.html(s),n&&this.setSelection(s.get(0)),this.$element.addClass("f-placeholder")):(0!==this.$element.find("br").length||this.browser.msie&&e.getIEversion()<=10||(this.$element.append(this.br),n&&this.browser.msie&&this.focus()),this.$element.addClass("f-placeholder"))}else!this.$element.find(this.options.defaultTag+", li, td, th").length&&this.options.paragraphy?(this.wrapText(!0),this.$element.find(this.options.defaultTag).length&&""===this.text()?this.setSelection(this.$element.find(this.options.defaultTag)[0],this.$element.find(this.options.defaultTag).text().length,null,this.$element.find(this.options.defaultTag).text().length):this.$element.removeClass("f-placeholder")):this.fakeEmpty()===!1&&(!this.options.paragraphy||this.$element.find(this.valid_nodes.join(",")).length>=1)?this.$element.removeClass("f-placeholder"):!this.options.paragraphy&&this.$element.find(this.valid_nodes.join(",")).length>=1?this.$element.removeClass("f-placeholder"):this.$element.addClass("f-placeholder");return!0},e.prototype.fakeEmpty=function(t){void 0===t&&(t=this.$element);var e=!0;this.options.paragraphy&&(e=1==t.find(this.options.defaultTag).length?!0:!1);var i=t.text().replace(/(\r\n|\n|\r|\t|\u200B)/gm,"");return""===i&&e&&1==t.find("br, li").length&&0===t.find("img, table, iframe, input, textarea, hr, li").length},e.prototype.setPlaceholderEvents=function(){this.browser.msie&&e.getIEversion()<9||(this.$element.on("focus click",t.proxy(function(t){return this.isDisabled?!1:void(""!==this.$element.text()||this.pasting||(this.$element.data("focused")||"click"!==t.type?"focus"==t.type&&this.focus(!1):this.$element.focus(),this.$element.data("focused",!0)))},this)),this.$element.on("keyup keydown input focus placeholderCheck",t.proxy(function(){return this.checkPlaceholder()},this)),this.$element.trigger("placeholderCheck"))},e.prototype.setDimensions=function(t,e,i,s){t&&(this.options.height=t),e&&(this.options.width=e),i&&(this.options.minHeight=i),s&&(this.options.maxHeight=s),"auto"!=this.options.height&&(this.$wrapper.css("height",this.options.height),this.$element.css("minHeight",this.options.height-parseInt(this.$element.css("padding-top"),10)-parseInt(this.$element.css("padding-bottom"),10))),"auto"!=this.options.minHeight&&(this.$wrapper.css("minHeight",this.options.minHeight),this.$element.css("minHeight",this.options.minHeight)),"auto"!=this.options.maxHeight&&this.$wrapper.css("maxHeight",this.options.maxHeight),"auto"!=this.options.width&&this.$box.css("width",this.options.width)},e.prototype.setDirection=function(t){t&&(this.options.direction=t),"ltr"!=this.options.direction&&"rtl"!=this.options.direction&&(this.options.direction="ltr"),"rtl"==this.options.direction?(this.$element.removeAttr("dir"),this.$box.addClass("f-rtl"),this.$element.addClass("f-rtl"),this.$editor.addClass("f-rtl"),this.$popup_editor.addClass("f-rtl"),this.$image_modal&&this.$image_modal.addClass("f-rtl")):(this.$element.attr("dir","auto"),this.$box.removeClass("f-rtl"),this.$element.removeClass("f-rtl"),this.$editor.removeClass("f-rtl"),this.$popup_editor.removeClass("f-rtl"),this.$image_modal&&this.$image_modal.removeClass("f-rtl"))},e.prototype.setZIndex=function(t){t&&(this.options.zIndex=t),this.$editor.css("z-index",this.options.zIndex),this.$popup_editor.css("z-index",this.options.zIndex+1),this.$overlay&&this.$overlay.css("z-index",this.options.zIndex+2),this.$image_modal&&this.$image_modal.css("z-index",this.options.zIndex+3)},e.prototype.setTheme=function(t){t&&(this.options.theme=t),null!=this.options.theme&&(this.$editor.addClass(this.options.theme+"-theme"),this.$popup_editor.addClass(this.options.theme+"-theme"),this.$box&&this.$box.addClass(this.options.theme+"-theme"),this.$image_modal&&this.$image_modal.addClass(this.options.theme+"-theme"))},e.prototype.setSpellcheck=function(t){void 0!==t&&(this.options.spellcheck=t),this.$element.attr("spellcheck",this.options.spellcheck)},e.prototype.customizeText=function(e){if(e){var i=this.$editor.find("[title]").add(this.$popup_editor.find("[title]"));this.$image_modal&&(i=i.add(this.$image_modal.find("[title]"))),i.each(t.proxy(function(i,s){for(var n in e)t(s).attr("title").toLowerCase()==n.toLowerCase()&&t(s).attr("title",e[n])},this)),i=this.$editor.find('[data-text="true"]').add(this.$popup_editor.find('[data-text="true"]')),this.$image_modal&&(i=i.add(this.$image_modal.find('[data-text="true"]'))),i.each(t.proxy(function(i,s){for(var n in e)t(s).text().toLowerCase()==n.toLowerCase()&&t(s).text(e[n])},this))}},e.prototype.setLanguage=function(e){void 0!==e&&(this.options.language=e),t.Editable.LANGS[this.options.language]&&(this.customizeText(t.Editable.LANGS[this.options.language].translation),
t.Editable.LANGS[this.options.language].direction&&t.Editable.LANGS[this.options.language].direction!=t.Editable.DEFAULTS.direction&&this.setDirection(t.Editable.LANGS[this.options.language].direction),t.Editable.LANGS[this.options.language].translation[this.options.placeholder]&&this.setPlaceholder(t.Editable.LANGS[this.options.language].translation[this.options.placeholder]))},e.prototype.setCustomText=function(t){t&&(this.options.customText=t),this.options.customText&&this.customizeText(this.options.customText)},e.prototype.execHTML=function(){this.html()},e.prototype.initHTMLArea=function(){this.$html_area=t('<textarea wrap="hard">').keydown(function(e){var i=e.keyCode||e.which;if(9==i){e.preventDefault();var s=t(this).get(0).selectionStart,n=t(this).get(0).selectionEnd;t(this).val(t(this).val().substring(0,s)+"	"+t(this).val().substring(n)),t(this).get(0).selectionStart=t(this).get(0).selectionEnd=s+1}}).focus(t.proxy(function(){this.blurred&&(this.blurred=!1,this.triggerEvent("focus",[],!1))},this)).mouseup(t.proxy(function(){this.blurred&&(this.blurred=!1,this.triggerEvent("focus",[],!1))},this))},e.prototype.command_dispatcher={align:function(t){var e=this.buildDropdownAlign(t),i=this.buildDropdownButton(t,e);return i},formatBlock:function(t){var e=this.buildDropdownFormatBlock(t),i=this.buildDropdownButton(t,e);return i},html:function(e){var i=this.buildDefaultButton(e);return this.options.inlineMode&&this.$box.append(t(i).clone(!0).addClass("html-switch").attr("title","Hide HTML").click(t.proxy(this.execHTML,this))),this.initHTMLArea(),i}},e.prototype.setButtons=function(t){t&&(this.options.buttons=t),this.$editor.append('<div class="bttn-wrapper" id="bttn-wrapper-'+this._id+'">'),this.$bttn_wrapper=this.$editor.find("#bttn-wrapper-"+this._id),this.mobile()&&this.$bttn_wrapper.addClass("touch");for(var i,s,n="",o=0;o<this.options.buttons.length;o++){var a=this.options.buttons[o];if("sep"!=a){var r=e.commands[a];if(void 0!==r){r.cmd=a;var l=this.command_dispatcher[r.cmd];l?n+=l.apply(this,[r]):r.seed?(i=this.buildDefaultDropdown(r),s=this.buildDropdownButton(r,i),n+=s):(s=this.buildDefaultButton(r),n+=s,this.bindRefreshListener(r))}else{if(r=this.options.customButtons[a],void 0===r){if(r=this.options.customDropdowns[a],void 0===r)continue;s=this.buildCustomDropdown(r,a),n+=s,this.bindRefreshListener(r);continue}s=this.buildCustomButton(r,a),n+=s,this.bindRefreshListener(r)}}else n+=this.options.inlineMode?'<div class="f-clear"></div><hr/>':'<span class="f-sep"></span>'}this.$bttn_wrapper.html(n),this.$bttn_wrapper.find('button[data-cmd="undo"], button[data-cmd="redo"]').prop("disabled",!0),this.bindButtonEvents()},e.prototype.bindRefreshListener=function(e){e.refresh&&this.addListener("refresh",t.proxy(function(){e.refresh.apply(this,[e.cmd])},this))},e.prototype.buildDefaultButton=function(t){var e='<button tabIndex="-1" type="button" class="fr-bttn" title="'+t.title+'" data-cmd="'+t.cmd+'">';return e+=void 0===this.options.icons[t.cmd]?this.addButtonIcon(t):this.prepareIcon(this.options.icons[t.cmd],t.title),e+="</button>"},e.prototype.prepareIcon=function(t,e){switch(t.type){case"font":return this.addButtonIcon({icon:t.value});case"img":return this.addButtonIcon({icon_img:t.value,title:e});case"txt":return this.addButtonIcon({icon_txt:t.value})}},e.prototype.addButtonIcon=function(t){return t.icon?'<i class="'+t.icon+'"></i>':t.icon_alt?'<i class="for-text">'+t.icon_alt+"</i>":t.icon_img?'<img src="'+t.icon_img+'" alt="'+t.title+'"/>':t.icon_txt?"<i>"+t.icon_txt+"</i>":t.title},e.prototype.buildCustomButton=function(t,e){this["call_"+e]=t.callback;var i='<button tabIndex="-1" type="button" class="fr-bttn" data-callback="call_'+e+'" data-cmd="button_name" data-name="'+e+'" title="'+t.title+'">'+this.prepareIcon(t.icon,t.title)+"</button>";return i},e.prototype.callDropdown=function(e,i){this.$bttn_wrapper.on("click touch",'[data-name="'+e+'"]',t.proxy(function(t){t.preventDefault(),t.stopPropagation(),i.apply(this)},this))},e.prototype.buildCustomDropdown=function(t,e){var i='<div class="fr-bttn fr-dropdown">';i+='<button tabIndex="-1" type="button" class="fr-trigger" title="'+t.title+'" data-name="'+e+'">'+this.prepareIcon(t.icon,t.title)+"</button>",i+='<ul class="fr-dropdown-menu">';var s=0;for(var n in t.options){this["call_"+e+s]=t.options[n];var o='<li data-callback="call_'+e+s+'" data-cmd="'+e+s+'" data-name="'+e+s+'"><a href="#">'+n+"</a></li>";i+=o,s++}return i+="</ul></div>"},e.prototype.buildDropdownButton=function(t,e,i){i=i||"";var s='<div class="fr-bttn fr-dropdown '+i+'">',n="";n+=void 0===this.options.icons[t.cmd]?this.addButtonIcon(t):this.prepareIcon(this.options.icons[t.cmd],t.title);var o='<button tabIndex="-1" type="button" data-name="'+t.cmd+'" class="fr-trigger" title="'+t.title+'">'+n+"</button>";return s+=o,s+=e,s+="</div>"},e.prototype.buildDropdownAlign=function(t){this.bindRefreshListener(t);for(var e='<ul class="fr-dropdown-menu f-align">',i=0;i<t.seed.length;i++){var s=t.seed[i];e+='<li data-cmd="align" data-val="'+s.cmd+'" title="'+s.title+'"><a href="#"><i class="'+s.icon+'"></i></a></li>'}return e+="</ul>"},e.prototype.buildDropdownFormatBlock=function(t){var e='<ul class="fr-dropdown-menu">';for(var i in this.options.blockTags){var s='<li data-cmd="'+t.cmd+'" data-val="'+i+'">';s+='<a href="#" data-text="true" class="format-'+i+'" title="'+this.options.blockTags[i]+'">'+this.options.blockTags[i]+"</a></li>",e+=s}return e+="</ul>"},e.prototype.buildDefaultDropdown=function(t){for(var e='<ul class="fr-dropdown-menu">',i=0;i<t.seed.length;i++){var s=t.seed[i],n='<li data-namespace="'+t.namespace+'" data-cmd="'+(s.cmd||t.cmd)+'" data-val="'+s.value+'" data-param="'+(s.param||t.param)+'">';n+='<a href="#" data-text="true" class="'+s.value+'" title="'+s.title+'">'+s.title+"</a></li>",e+=n}return e+="</ul>"},e.prototype.createEditPopupHTML=function(){var t='<div class="froala-popup froala-text-popup" style="display:none;">';return t+='<h4><span data-text="true">Edit text</span><i title="Cancel" class="fa fa-times" id="f-text-close-'+this._id+'"></i></h4></h4>',t+='<div class="f-popup-line"><input type="text" placeholder="http://www.taihuoniao.com" class="f-lu" id="f-ti-'+this._id+'">',t+='<button data-text="true" type="button" class="f-ok" id="f-edit-popup-ok-'+this._id+'">OK</button>',t+="</div>",t+="</div>"},e.prototype.buildEditPopup=function(){this.$edit_popup_wrapper=t(this.createEditPopupHTML()),this.$popup_editor.append(this.$edit_popup_wrapper),this.$edit_popup_wrapper.find("#f-ti-"+this._id).on("mouseup keydown",function(t){t.stopPropagation()}),this.addListener("hidePopups",t.proxy(function(){this.$edit_popup_wrapper.hide()},this)),this.$edit_popup_wrapper.on("click","#f-edit-popup-ok-"+this._id,t.proxy(function(){this.$element.text(this.$edit_popup_wrapper.find("#f-ti-"+this._id).val()),this.sync(),this.hide()},this)),this.$edit_popup_wrapper.on("click","i#f-text-close-"+this._id,t.proxy(function(){this.hide()},this))},e.prototype.createCORSRequest=function(t,e){var i=new XMLHttpRequest;if("withCredentials"in i){i.open(t,e,!0),this.options.withCredentials&&(i.withCredentials=!0);for(var s in this.options.headers)i.setRequestHeader(s,this.options.headers[s])}else"undefined"!=typeof XDomainRequest?(i=new XDomainRequest,i.open(t,e)):i=null;return i},e.prototype.isEnabled=function(e){return t.inArray(e,this.options.buttons)>=0},e.prototype.bindButtonEvents=function(){this.bindDropdownEvents(this.$bttn_wrapper),this.bindCommandEvents(this.$bttn_wrapper)},e.prototype.bindDropdownEvents=function(i){var s=this;i.on(this.mousedown,".fr-dropdown .fr-trigger:not([disabled])",function(e){return"mousedown"===e.type&&1!==e.which?!0:("LI"===this.tagName&&"touchstart"===e.type&&s.android()||s.iOS()||e.preventDefault(),void t(this).attr("data-down",!0))}),i.on(this.mouseup,".fr-dropdown .fr-trigger:not([disabled])",function(n){if(s.isDisabled)return!1;if(n.stopPropagation(),n.preventDefault(),!t(this).attr("data-down"))return t("[data-down]").removeAttr("data-down"),!1;t("[data-down]").removeAttr("data-down"),s.options.inlineMode===!1&&0===t(this).parents(".froala-popup").length&&(s.hide(),s.closeImageMode(),s.imageMode=!1),t(this).toggleClass("active").trigger("blur");var o,a=t(this).attr("data-name");return e.commands[a]?o=e.commands[a].refreshOnShow:s.options.customDropdowns[a]?o=s.options.customDropdowns[a].refreshOnShow:e.image_commands[a]&&(o=e.image_commands[a].refreshOnShow),o&&o.call(s),i.find("button.fr-trigger").not(this).removeClass("active"),!1}),i.on(this.mouseup,".fr-dropdown",function(t){t.stopPropagation(),t.preventDefault()}),this.$element.on("mouseup","img, a",t.proxy(function(){return this.isDisabled?!1:void i.find(".fr-dropdown .fr-trigger").removeClass("active")},this)),i.on("click","li[data-cmd] > a",function(t){t.preventDefault()})},e.prototype.bindCommandEvents=function(e){var i=this;e.on(this.mousedown,"button[data-cmd], li[data-cmd], span[data-cmd], a[data-cmd]",function(e){return"mousedown"===e.type&&1!==e.which?!0:("LI"===this.tagName&&"touchstart"===e.type&&i.android()||i.iOS()||e.preventDefault(),void t(this).attr("data-down",!0))}),e.on(this.mouseup+" "+this.move,"button[data-cmd], li[data-cmd], span[data-cmd], a[data-cmd]",t.proxy(function(e){if(i.isDisabled)return!1;if("mouseup"===e.type&&1!==e.which)return!0;var s=e.currentTarget;if("touchmove"!=e.type){if(e.stopPropagation(),e.preventDefault(),!t(s).attr("data-down"))return t("[data-down]").removeAttr("data-down"),!1;if(t("[data-down]").removeAttr("data-down"),t(s).data("dragging")||t(s).attr("disabled"))return t(s).removeData("dragging"),!1;var n=t(s).data("timeout");n&&(clearTimeout(n),t(s).removeData("timeout"));var o=t(s).attr("data-callback");if(i.options.inlineMode===!1&&0===t(s).parents(".froala-popup").length&&(i.hide(),i.closeImageMode(),i.imageMode=!1),o)t(s).parents(".fr-dropdown").find(".fr-trigger.active").removeClass("active"),i[o]();else{var a=t(s).attr("data-namespace"),r=t(s).attr("data-cmd"),l=t(s).attr("data-val"),h=t(s).attr("data-param");a?i["exec"+a](r,l,h):(i.exec(r,l,h),i.$bttn_wrapper.find(".fr-dropdown .fr-trigger").removeClass("active"))}return!1}t(s).data("timeout")||t(s).data("timeout",setTimeout(function(){t(s).data("dragging",!0)},200))},this))},e.prototype.save=function(){if(!this.triggerEvent("beforeSave",[],!1))return!1;if(this.options.saveURL){var e={};for(var i in this.options.saveParams){var s=this.options.saveParams[i];e[i]="function"==typeof s?s.call(this):s}var n={};n[this.options.saveParam]=this.getHTML(),t.ajax({type:this.options.saveRequestType,url:this.options.saveURL,data:t.extend(n,e),crossDomain:this.options.crossDomain,xhrFields:{withCredentials:this.options.withCredentials},headers:this.options.headers}).done(t.proxy(function(t){this.triggerEvent("afterSave",[t])},this)).fail(t.proxy(function(){this.triggerEvent("saveError",["Save request failed on the server."])},this))}else this.triggerEvent("saveError",["Missing save URL."])},e.prototype.isURL=function(t){if(!/^(https?:|ftps?:|)\/\//.test(t))return!1;t=String(t).replace(/</g,"%3C").replace(/>/g,"%3E").replace(/"/g,"%22").replace(/ /g,"%20");var e=/\(?(?:(https?:|ftps?:|)\/\/)?(?:((?:[^\W\s]|\.|-|[:]{1})+)@{1})?((?:www.)?(?:[^\W\s]|\.|-)+[\.][^\W\s]{2,4}|(?:www.)?(?:[^\W\s]|\.|-)|localhost|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?::(\d*))?([\/]?[^\s\?]*[\/]{1})*(?:\/?([^\s\n\?\[\]\{\}\#]*(?:(?=\.)){1}|[^\s\n\?\[\]\{\}\.\#]*)?([\.]{1}[^\s\?\#]*)?)?(?:\?{1}([^\s\n\#\[\]]*))?([\#][^\s\n]*)?\)?/gi;return e.test(t)},e.prototype.sanitizeURL=function(t){if(/^(https?:|ftps?:|)\/\//.test(t)){if(!this.isURL(t))return""}else t=encodeURIComponent(t).replace(/%23/g,"#").replace(/%2F/g,"/").replace(/%25/g,"%").replace(/mailto%3A/g,"mailto:").replace(/tel%3A/g,"tel:").replace(/data%3Aimage/g,"data:image").replace(/webkit-fake-url%3A/g,"webkit-fake-url:").replace(/%3F/g,"?").replace(/%3D/g,"=").replace(/%26/g,"&").replace(/&amp;/g,"&").replace(/%2C/g,",").replace(/%3B/g,";").replace(/%2B/g,"+").replace(/%40/g,"@");return t},e.prototype.parents=function(t,e){return t.get(0)!=this.$element.get(0)?t.parentsUntil(this.$element,e):[]},e.prototype.option=function(e,i){if(void 0===e)return this.options;if(e instanceof Object)this.options=t.extend({},this.options,e),this.initOptions(),this.setCustomText(),this.setLanguage(),this.setAllowScript(),this.setAllowStyle();else{if(void 0===i)return this.options[e];switch(this.options[e]=i,e){case"direction":this.setDirection();break;case"height":case"width":case"minHeight":case"maxHeight":this.setDimensions();break;case"spellcheck":this.setSpellcheck();break;case"placeholder":this.setPlaceholder();break;case"customText":this.setCustomText();break;case"language":this.setLanguage();break;case"textNearImage":this.setTextNearImage();break;case"zIndex":this.setZIndex();break;case"theme":this.setTheme();break;case"allowScript":this.setAllowScript();break;case"allowStyle":this.setAllowStyle()}}};var i=t.fn.editable;t.fn.editable=function(i){for(var s=[],n=0;n<arguments.length;n++)s.push(arguments[n]);if("string"==typeof i){var o=[];return this.each(function(){var e=t(this),n=e.data("fa.editable");if(!n[i])return t.error("Method "+i+" does not exist in Froala Editor.");var a=n[i].apply(n,s.slice(1));void 0===a?o.push(this):0===o.length&&o.push(a)}),1==o.length?o[0]:o}return"object"!=typeof i&&i?void 0:this.each(function(){var s=this,n=t(s),o=n.data("fa.editable");o||n.data("fa.editable",o=new e(s,i))})},t.fn.editable.Constructor=e,t.Editable=e,t.fn.editable.noConflict=function(){return t.fn.editable=i,this}}(window.jQuery),function(t){t.Editable.prototype.initUndoRedo=function(){this.undoStack=[],this.undoIndex=0,this.saveUndoStep(),this.disableBrowserUndo()},t.Editable.prototype.undo=function(){if(this.no_verify=!0,this.undoIndex>1){clearTimeout(this.typingTimer),this.triggerEvent("beforeUndo",[],!1);var t=this.undoStack[--this.undoIndex-1];this.restoreSnapshot(t),this.doingRedo=!0,this.triggerEvent("afterUndo",[]),this.doingRedo=!1,""!==this.text()?this.repositionEditor():this.hide(),this.$element.trigger("placeholderCheck"),this.focus(),this.refreshButtons()}this.no_verify=!1},t.Editable.prototype.redo=function(){if(this.no_verify=!0,this.undoIndex<this.undoStack.length){clearTimeout(this.typingTimer),this.triggerEvent("beforeRedo",[],!1);var t=this.undoStack[this.undoIndex++];this.restoreSnapshot(t),this.doingRedo=!0,this.triggerEvent("afterRedo",[]),this.doingRedo=!1,""!==this.text()?this.repositionEditor():this.hide(),this.$element.trigger("placeholderCheck"),this.focus(),this.refreshButtons()}this.no_verify=!1},t.Editable.prototype.saveUndoStep=function(){if(!this.undoStack)return!1;for(;this.undoStack.length>this.undoIndex;)this.undoStack.pop();var t=this.getSnapshot();this.undoStack[this.undoIndex-1]&&this.identicSnapshots(this.undoStack[this.undoIndex-1],t)||(this.undoStack.push(t),this.undoIndex++),this.refreshUndo(),this.refreshRedo()},t.Editable.prototype.refreshUndo=function(){if(this.isEnabled("undo")){if(void 0===this.$editor)return;this.$bttn_wrapper.find('[data-cmd="undo"]').removeAttr("disabled"),(0===this.undoStack.length||this.undoIndex<=1||this.isHTML)&&this.$bttn_wrapper.find('[data-cmd="undo"]').attr("disabled",!0)}},t.Editable.prototype.refreshRedo=function(){if(this.isEnabled("redo")){if(void 0===this.$editor)return;this.$bttn_wrapper.find('[data-cmd="redo"]').removeAttr("disabled"),(this.undoIndex==this.undoStack.length||this.isHTML)&&this.$bttn_wrapper.find('[data-cmd="redo"]').prop("disabled",!0)}},t.Editable.prototype.getNodeIndex=function(t){for(var e=t.parentNode.childNodes,i=0,s=null,n=0;n<e.length;n++){if(s){var o=3===e[n].nodeType&&""===e[n].textContent,a=3===s.nodeType&&3===e[n].nodeType;o||a||i++}if(e[n]==t)return i;s=e[n]}},t.Editable.prototype.getNodeLocation=function(t){var e=[];if(!t.parentNode)return[];for(;t!=this.$element.get(0);)e.push(this.getNodeIndex(t)),t=t.parentNode;return e.reverse()},t.Editable.prototype.getNodeByLocation=function(t){for(var e=this.$element.get(0),i=0;i<t.length;i++)e=e.childNodes[t[i]];return e},t.Editable.prototype.getRealNodeOffset=function(t,e){for(;t&&3===t.nodeType;){var i=t.previousSibling;i&&3==i.nodeType&&(e+=i.textContent.length),t=i}return e},t.Editable.prototype.getRangeSnapshot=function(t){return{scLoc:this.getNodeLocation(t.startContainer),scOffset:this.getRealNodeOffset(t.startContainer,t.startOffset),ecLoc:this.getNodeLocation(t.endContainer),ecOffset:this.getRealNodeOffset(t.endContainer,t.endOffset)}},t.Editable.prototype.getSnapshot=function(){var t={};if(t.html=this.$element.html(),t.ranges=[],this.selectionInEditor()&&this.$element.is(":focus"))for(var e=this.getRanges(),i=0;i<e.length;i++)t.ranges.push(this.getRangeSnapshot(e[i]));return t},t.Editable.prototype.identicSnapshots=function(t,e){return t.html!=e.html?!1:JSON.stringify(t.ranges)!=JSON.stringify(e.ranges)?!1:!0},t.Editable.prototype.restoreRangeSnapshot=function(t,e){try{var i=this.getNodeByLocation(t.scLoc),s=t.scOffset,n=this.getNodeByLocation(t.ecLoc),o=t.ecOffset,a=this.document.createRange();a.setStart(i,s),a.setEnd(n,o),e.addRange(a)}catch(r){}},t.Editable.prototype.restoreSnapshot=function(e){this.$element.html()!=e.html&&this.$element.html(e.html);var i=this.getSelection();this.clearSelection(),this.$element.focus();for(var s=0;s<e.ranges.length;s++)this.restoreRangeSnapshot(e.ranges[s],i);setTimeout(t.proxy(function(){this.$element.find(".f-img-wrap img").click()},this),0)}}(jQuery),function(t){t.Editable.prototype.refreshButtons=function(e){return this.initialized&&(this.selectionInEditor()&&!this.isHTML||this.browser.msie&&t.Editable.getIEversion()<9||e)?(this.$editor.find("button[data-cmd]").removeClass("active"),this.refreshDisabledState(),void this.raiseEvent("refresh")):!1},t.Editable.prototype.refreshDisabledState=function(){if(this.isHTML)return!1;if(this.$editor){for(var e=0;e<this.options.buttons.length;e++){var i=this.options.buttons[e];if(void 0!==t.Editable.commands[i]){var s=!1;t.isFunction(t.Editable.commands[i].disabled)?s=t.Editable.commands[i].disabled.apply(this):void 0!==t.Editable.commands[i].disabled&&(s=!0),s?(this.$editor.find('button[data-cmd="'+i+'"]').prop("disabled",!0),this.$editor.find('button[data-name="'+i+'"]').prop("disabled",!0)):(this.$editor.find('button[data-cmd="'+i+'"]').removeAttr("disabled"),this.$editor.find('button[data-name="'+i+'"]').removeAttr("disabled"))}}this.refreshUndo(),this.refreshRedo()}},t.Editable.prototype.refreshFormatBlocks=function(){var t=this.getSelectionElements()[0],e=t.tagName.toLowerCase();this.options.paragraphy&&e===this.options.defaultTag.toLowerCase()&&(e="n"),this.$editor.find('.fr-bttn > button[data-name="formatBlock"] + ul li').removeClass("active"),this.$bttn_wrapper.find('.fr-bttn > button[data-name="formatBlock"] + ul li[data-val="'+e+'"]').addClass("active")},t.Editable.prototype.refreshDefault=function(t){try{this.document.queryCommandState(t)===!0&&this.$editor.find('[data-cmd="'+t+'"]').addClass("active")}catch(e){}},t.Editable.prototype.refreshAlign=function(){var e=t(this.getSelectionElements()[0]);this.$editor.find('.fr-dropdown > button[data-name="align"] + ul li').removeClass("active");var i,s=e.css("text-align");["left","right","justify","center"].indexOf(s)<0&&(s="left"),"left"==s?i="justifyLeft":"right"==s?i="justifyRight":"justify"==s?i="justifyFull":"center"==s&&(i="justifyCenter"),this.$editor.find('.fr-dropdown > button[data-name="align"].fr-trigger i').attr("class","fa fa-align-"+s),this.$editor.find('.fr-dropdown > button[data-name="align"] + ul li[data-val="'+i+'"]').addClass("active")},t.Editable.prototype.refreshHTML=function(){this.isActive("html")?this.$editor.find('[data-cmd="html"]').addClass("active"):this.$editor.find('[data-cmd="html"]').removeClass("active")}}(jQuery),function(t){t.Editable.commands={bold:{title:"Bold",icon:"fa fa-bold",shortcut:"(Ctrl + B)",refresh:t.Editable.prototype.refreshDefault,undo:!0,callbackWithoutSelection:function(t){this._startInDefault(t)}},italic:{title:"Italic",icon:"fa fa-italic",shortcut:"(Ctrl + I)",refresh:t.Editable.prototype.refreshDefault,undo:!0,callbackWithoutSelection:function(t){this._startInDefault(t)}},underline:{cmd:"underline",title:"Underline",icon:"fa fa-underline",shortcut:"(Ctrl + U)",refresh:t.Editable.prototype.refreshDefault,undo:!0,callbackWithoutSelection:function(t){this._startInDefault(t)}},strikeThrough:{title:"Strikethrough",icon:"fa fa-strikethrough",refresh:t.Editable.prototype.refreshDefault,undo:!0,callbackWithoutSelection:function(t){this._startInDefault(t)}},subscript:{title:"Subscript",icon:"fa fa-subscript",refresh:t.Editable.prototype.refreshDefault,undo:!0,callbackWithoutSelection:function(t){this._startInDefault(t)}},superscript:{title:"Superscript",icon:"fa fa-superscript",refresh:t.Editable.prototype.refreshDefault,undo:!0,callbackWithoutSelection:function(t){this._startInDefault(t)}},formatBlock:{title:"Format Block",icon:"fa fa-paragraph",refreshOnShow:t.Editable.prototype.refreshFormatBlocks,callback:function(t,e){this.formatBlock(e)},undo:!0},align:{title:"Alignment",icon:"fa fa-align-left",refresh:t.Editable.prototype.refreshAlign,refreshOnShow:t.Editable.prototype.refreshAlign,seed:[{cmd:"justifyLeft",title:"Align Left",icon:"fa fa-align-left"},{cmd:"justifyCenter",title:"Align Center",icon:"fa fa-align-center"},{cmd:"justifyRight",title:"Align Right",icon:"fa fa-align-right"},{cmd:"justifyFull",title:"Justify",icon:"fa fa-align-justify"}],callback:function(t,e){this.align(e)},undo:!0},outdent:{title:"Indent Less",icon:"fa fa-dedent",activeless:!0,shortcut:"(Ctrl + <)",callback:function(){this.outdent(!0)},undo:!0},indent:{title:"Indent More",icon:"fa fa-indent",activeless:!0,shortcut:"(Ctrl + >)",callback:function(){this.indent()},undo:!0},selectAll:{title:"Select All",icon:"fa fa-file-text",shortcut:"(Ctrl + A)",callback:function(t,e){this.$element.focus(),this.execDefault(t,e)},undo:!1},createLink:{title:"Insert Link",icon:"fa fa-link",shortcut:"(Ctrl + K)",callback:function(){this.insertLink()},undo:!1},insertImage:{title:"Insert Image",icon:"fa fa-picture-o",activeless:!0,shortcut:"(Ctrl + P)",callback:function(){this.insertImage()},undo:!1},undo:{title:"Undo",icon:"fa fa-undo",activeless:!0,shortcut:"(Ctrl+Z)",refresh:t.Editable.prototype.refreshUndo,callback:function(){this.undo()},undo:!1},redo:{title:"Redo",icon:"fa fa-repeat",activeless:!0,shortcut:"(Shift+Ctrl+Z)",refresh:t.Editable.prototype.refreshRedo,callback:function(){this.redo()},undo:!1},html:{title:"Show HTML",icon:"fa fa-code",refresh:t.Editable.prototype.refreshHTML,callback:function(){this.html()},undo:!1},save:{title:"Save",icon:"fa fa-floppy-o",callback:function(){this.save()},undo:!1},insertHorizontalRule:{title:"Insert Horizontal Line",icon:"fa fa-minus",callback:function(t){this.insertHR(t)},undo:!0},removeFormat:{title:"Clear formatting",icon:"fa fa-eraser",activeless:!0,callback:function(){this.removeFormat()},undo:!0}},t.Editable.prototype.exec=function(e,i,s){return!this.selectionInEditor()&&t.Editable.commands[e].undo&&this.focus(),this.selectionInEditor()&&""===this.text()&&t.Editable.commands[e].callbackWithoutSelection?(t.Editable.commands[e].callbackWithoutSelection.apply(this,[e,i,s]),!1):void(t.Editable.commands[e].callback?t.Editable.commands[e].callback.apply(this,[e,i,s]):this.execDefault(e,i))},t.Editable.prototype.html=function(){var t;this.isHTML?(this.isHTML=!1,t=this.$html_area.val(),this.$box.removeClass("f-html"),this.$element.attr("contenteditable",!0),this.setHTML(t,!1),this.$editor.find('.fr-bttn:not([data-cmd="html"]), .fr-trigger').removeAttr("disabled"),this.$editor.find('.fr-bttn[data-cmd="html"]').removeClass("active"),this.$element.blur(),this.focus(),this.refreshButtons(),this.triggerEvent("htmlHide",[t],!0,!1)):(this.$box.removeClass("f-placeholder"),this.clearSelection(),this.cleanify(!1,!0,!1),t=this.cleanTags(this.getHTML(!1,!1)),this.$html_area.val(t).trigger("resize"),this.$html_area.css("height",this.$element.height()-1),this.$element.html("").append(this.$html_area).removeAttr("contenteditable"),this.$box.addClass("f-html"),this.$editor.find('button.fr-bttn:not([data-cmd="html"]), button.fr-trigger').attr("disabled",!0),this.$editor.find('.fr-bttn[data-cmd="html"]').addClass("active"),this.isHTML=!0,this.hide(),this.imageMode=!1,this.$element.blur(),this.$element.removeAttr("contenteditable"),this.triggerEvent("htmlShow",[t],!0,!1))},t.Editable.prototype.insertHR=function(e){this.$element.find("hr").addClass("fr-tag"),this.$element.hasClass("f-placeholder")?t(this.$element.find("> "+this.valid_nodes.join(", >"))[0]).before("<hr/>"):this.document.execCommand(e),this.hide();var i=this.$element.find("hr:not(.fr-tag)").next(this.valid_nodes.join(","));i.length>0?t(i[0]).prepend(this.markers_html):this.$element.find("hr:not(.fr-tag)").after(this.options.paragraphy?"<p>"+this.markers_html+"<br/></p>":this.markers_html),this.restoreSelectionByMarkers(),this.triggerEvent(e,[],!0,!1)},t.Editable.prototype.formatBlock=function(e){if(this.disabledList.indexOf("formatBlock")>=0)return!1;if(this.browser.msie&&t.Editable.getIEversion()<9)return"n"==e&&(e=this.options.defaultTag),this.document.execCommand("formatBlock",!1,"<"+e+">"),this.triggerEvent("formatBlock"),!1;if(this.$element.hasClass("f-placeholder")){if(this.options.paragraphy||"n"!=e){"n"==e&&(e=this.options.defaultTag);var i=t("<"+e+"><br/></"+e+">");this.$element.html(i),this.setSelection(i.get(0),0),this.$element.removeClass("f-placeholder")}}else{this.saveSelectionByMarkers(),this.wrapText(),this.restoreSelectionByMarkers();var s=this.getSelectionElements();s[0]==this.$element.get(0)&&(s=this.$element.find("> "+this.valid_nodes.join(", >"))),this.saveSelectionByMarkers();for(var n,o=function(e){if("PRE"==e.get(0).tagName)for(;e.find("br + br").length>0;){var i=t(e.find("br + br")[0]);i.prev().remove(),i.replaceWith("\n\n")}},a=0;a<s.length;a++){var r=t(s[a]);if(!this.fakeEmpty(r)){if(o(r),!this.options.paragraphy&&this.emptyElement(r.get(0))&&r.append("<br/>"),"n"==e)if(this.options.paragraphy){var l="<"+this.options.defaultTag+this.attrs(r.get(0))+">"+r.html()+"</"+this.options.defaultTag+">";n=t(l)}else n=r.html()+"<br/>";else n=t("<"+e+this.attrs(r.get(0))+">").html(r.html());r.get(0)!=this.$element.get(0)?r.replaceWith(n):r.html(n)}}this.unwrapText(),this.$element.find("pre + pre").each(function(){t(this).prepend(t(this).prev().html()+"<br/><br/>"),t(this).prev().remove()});var h=this;this.$element.find(this.valid_nodes.join(",")).each(function(){"PRE"!=this.tagName&&t(this).replaceWith("<"+this.tagName+h.attrs(this)+">"+t(this).html().replace(/\n\n/gi,"</"+this.tagName+"><"+this.tagName+">")+"</"+this.tagName+">")}),this.$element.find(this.valid_nodes.join(":empty ,")+":empty").append("<br/>"),this.cleanupLists(),this.restoreSelectionByMarkers()}this.triggerEvent("formatBlock"),this.repositionEditor()},t.Editable.prototype.align=function(e){if(this.browser.msie&&t.Editable.getIEversion()<9)return this.document.execCommand(e,!1,!1),this.triggerEvent("align",[e]),!1;this.saveSelectionByMarkers(),this.wrapText(),this.restoreSelectionByMarkers(),this.saveSelectionByMarkers();var i=this.getSelectionElements();"justifyLeft"==e?e="left":"justifyRight"==e?e="right":"justifyCenter"==e?e="center":"justifyFull"==e&&(e="justify");for(var s=0;s<i.length;s++)this.parents(t(i[s]),"LI").length>0&&(i[s]=t(i[s]).parents("LI").get(0)),t(i[s]).css("text-align",e);this.cleanupLists(),this.unwrapText(),this.restoreSelectionByMarkers(),this.repositionEditor(),this.triggerEvent("align",[e])},t.Editable.prototype.indent=function(e,i){if(void 0===i&&(i=!0),this.browser.msie&&t.Editable.getIEversion()<9)return e?this.document.execCommand("outdent",!1,!1):this.document.execCommand("indent",!1,!1),!1;var s=20;e&&(s=-20),this.saveSelectionByMarkers(),this.wrapText(),this.restoreSelectionByMarkers();var n=this.getSelectionElements();this.saveSelectionByMarkers();for(var o=0;o<n.length;o++){var a=t(n[o]);if(a.parentsUntil(this.$element,"li").length>0&&(a=a.closest("li")),this.raiseEvent("indent",[a,e]))if(a.get(0)!=this.$element.get(0)){var r=parseInt(a.css("margin-left"),10),l=Math.max(0,r+s);a.css("marginLeft",l),0===l&&(a.css("marginLeft",""),void 0===a.css("style")&&a.removeAttr("style"))}else{var h=t("<div>").html(a.html());a.html(h),h.css("marginLeft",Math.max(0,s)),0===Math.max(0,s)&&(h.css("marginLeft",""),void 0===h.css("style")&&h.removeAttr("style"))}}this.unwrapText(),this.restoreSelectionByMarkers(),i&&this.repositionEditor(),e||this.triggerEvent("indent")},t.Editable.prototype.outdent=function(t){this.indent(!0,t),this.triggerEvent("outdent")},t.Editable.prototype.execDefault=function(t,e){this.saveUndoStep(),this.document.execCommand(t,!1,e),this.triggerEvent(t,[],!0,!0)},t.Editable.prototype._startInDefault=function(t){this.focus(),this.document.execCommand(t,!1,!1),this.refreshButtons()},t.Editable.prototype._startInFontExec=function(e,i,s){this.focus();try{var n=this.getRange(),o=n.cloneRange();o.collapse(!1);var a=t('<span data-inserted="true" data-fr-verified="true" style="'+e+": "+s+';">'+t.Editable.INVISIBLE_SPACE+"</span>",this.document);o.insertNode(a[0]),a=this.$element.find("[data-inserted]"),a.removeAttr("data-inserted"),this.setSelection(a.get(0),1)}catch(r){}},t.Editable.prototype.removeFormat=function(){this.document.execCommand("removeFormat",!1,!1),this.document.execCommand("unlink",!1,!1)},t.Editable.prototype.inlineStyle=function(e,i,s){if(this.browser.webkit&&"font-size"!=e){var n=function(t){return t.attr("style").indexOf("font-size")>=0};this.$element.find("span").each(function(e,i){var s=t(i);s.attr("style")&&n(s)&&(s.data("font-size",s.css("font-size")),s.css("font-size",""))})}this.document.execCommand("fontSize",!1,4),this.saveSelectionByMarkers(),this.browser.webkit&&"font-size"!=e&&this.$element.find("span").each(function(e,i){var s=t(i);s.data("font-size")&&(s.css("font-size",s.data("font-size")),s.removeData("font-size"))});var o=function(i){var n=t(i);n.css(e)!=s&&n.css(e,""),""===n.attr("style")&&n.replaceWith(n.html())};this.$element.find("font").each(function(i,n){var a=t('<span data-fr-verified="true" style="'+e+": "+s+';">'+t(n).html()+"</span>");t(n).replaceWith(a);for(var r=a.find("span"),l=r.length-1;l>=0;l--)o(r[l])}),this.removeBlankSpans(),this.restoreSelectionByMarkers(),this.repositionEditor(),null!=i&&this.triggerEvent(i,[s],!0,!0)}}(jQuery),function(t){t.Editable.prototype.addListener=function(t,e){var i=this._events,s=i[t]=i[t]||[];s.push(e)},t.Editable.prototype.raiseEvent=function(t,e){void 0===e&&(e=[]);var i=!0,s=this._events[t];if(s)for(var n=0,o=s.length;o>n;n++){var a=s[n].apply(this,e);void 0!==a&&i!==!1&&(i=a)}return void 0===i&&(i=!0),i}}(jQuery),function(t){t.Editable.prototype.start_marker='<span class="f-marker" data-id="0" data-fr-verified="true" data-type="true"></span>',t.Editable.prototype.end_marker='<span class="f-marker" data-id="0" data-fr-verified="true" data-type="false"></span>',t.Editable.prototype.markers_html='<span class="f-marker" data-id="0" data-fr-verified="true" data-type="false"></span><span class="f-marker" data-id="0" data-fr-verified="true" data-type="true"></span>',t.Editable.prototype.text=function(){var t="";return this.window.getSelection?t=this.window.getSelection():this.document.getSelection?t=this.document.getSelection():this.document.selection&&(t=this.document.selection.createRange().text),t.toString()},t.Editable.prototype.selectionInEditor=function(){var e=this.getSelectionParent(),i=!1;return e==this.$element.get(0)&&(i=!0),i===!1&&t(e).parents().each(t.proxy(function(t,e){e==this.$element.get(0)&&(i=!0)},this)),i},t.Editable.prototype.getSelection=function(){var t="";return t=this.window.getSelection?this.window.getSelection():this.document.getSelection?this.document.getSelection():this.document.selection.createRange()},t.Editable.prototype.getRange=function(){var t=this.getRanges();

return t.length>0?t[0]:null},t.Editable.prototype.getRanges=function(){var t=this.getSelection();if(t.getRangeAt&&t.rangeCount){for(var e=[],i=0;i<t.rangeCount;i++)e.push(t.getRangeAt(i));return e}return this.document.createRange?[this.document.createRange()]:[]},t.Editable.prototype.clearSelection=function(){var t=this.getSelection();try{t.removeAllRanges?t.removeAllRanges():t.empty?t.empty():t.clear&&t.clear()}catch(e){}},t.Editable.prototype.getSelectionElement=function(){var e=this.getSelection();if(e.rangeCount){var i=this.getRange(),s=i.startContainer;if(1==s.nodeType){var n=!1;s.childNodes.length>0&&s.childNodes[i.startOffset]&&t(s.childNodes[i.startOffset]).text()===this.text()&&(s=s.childNodes[i.startOffset],n=!0),!n&&s.childNodes.length>0&&t(s.childNodes[0]).text()===this.text()&&["BR","IMG","HR"].indexOf(s.childNodes[0].tagName)<0&&(s=s.childNodes[0])}for(;1!=s.nodeType&&s.parentNode;)s=s.parentNode;for(var o=s;o&&"BODY"!=o.tagName;){if(o==this.$element.get(0))return s;o=t(o).parent()[0]}}return this.$element.get(0)},t.Editable.prototype.getSelectionParent=function(){var e,i=null;return this.window.getSelection?(e=this.window.getSelection(),e.rangeCount&&(i=e.getRangeAt(0).commonAncestorContainer,1!=i.nodeType&&(i=i.parentNode))):(e=this.document.selection)&&"Control"!=e.type&&(i=e.createRange().parentElement()),null!=i&&(t.inArray(this.$element.get(0),t(i).parents())>=0||i==this.$element.get(0))?i:null},t.Editable.prototype.nodeInRange=function(t,e){var i;if(t.intersectsNode)return t.intersectsNode(e);i=e.ownerthis.document.createRange();try{i.selectNode(e)}catch(s){i.selectNodeContents(e)}return-1==t.compareBoundaryPoints(Range.END_TO_START,i)&&1==t.compareBoundaryPoints(Range.START_TO_END,i)},t.Editable.prototype.getElementFromNode=function(e){for(1!=e.nodeType&&(e=e.parentNode);null!==e&&this.valid_nodes.indexOf(e.tagName)<0;)e=e.parentNode;return null!=e&&"LI"==e.tagName&&t(e).find(this.valid_nodes.join(",")).not("li").length>0?null:t.makeArray(t(e).parents()).indexOf(this.$element.get(0))>=0?e:null},t.Editable.prototype.nextNode=function(t,e){if(t.hasChildNodes())return t.firstChild;for(;t&&!t.nextSibling&&t!=e;)t=t.parentNode;return t&&t!=e?t.nextSibling:null},t.Editable.prototype.getRangeSelectedNodes=function(t){var e=[],i=t.startContainer,s=t.endContainer;if(i==s&&"TR"!=i.tagName){if(i.hasChildNodes()&&0!==i.childNodes.length){for(var n=i.childNodes,o=t.startOffset;o<t.endOffset;o++)n[o]&&e.push(n[o]);return 0===e.length&&e.push(i),e}return[i]}if(i==s&&"TR"==i.tagName){var a=i.childNodes,r=t.startOffset;if(a.length>r&&r>=0){var l=a[r];if("TD"==l.tagName||"TH"==l.tagName)return[l]}}for(;i&&i!=s;)i=this.nextNode(i,s),(i!=s||t.endOffset>0)&&e.push(i);for(i=t.startContainer;i&&i!=t.commonAncestorContainer;)e.unshift(i),i=i.parentNode;return e},t.Editable.prototype.getSelectedNodes=function(){if(this.window.getSelection){var e=this.window.getSelection();if(!e.isCollapsed){for(var i=this.getRanges(),s=[],n=0;n<i.length;n++)s=t.merge(s,this.getRangeSelectedNodes(i[n]));return s}if(this.selectionInEditor()){var o=e.getRangeAt(0).startContainer;return 3==o.nodeType?[o.parentNode]:[o]}}return[]},t.Editable.prototype.getSelectionElements=function(){var e=this.getSelectedNodes(),i=[];return t.each(e,t.proxy(function(t,e){if(null!==e){var s=this.getElementFromNode(e);i.indexOf(s)<0&&s!=this.$element.get(0)&&null!==s&&i.push(s)}},this)),0===i.length&&i.push(this.$element.get(0)),i},t.Editable.prototype.getSelectionLink=function(){var e=this.getSelectionLinks();return e.length>0?t(e[0]).attr("href"):null},t.Editable.prototype.saveSelection=function(){if(!this.selectionDisabled){this.savedRanges=[];for(var t=this.getRanges(),e=0;e<t.length;e++)this.savedRanges.push(t[e].cloneRange())}},t.Editable.prototype.restoreSelection=function(){if(!this.selectionDisabled){var t,e,i=this.getSelection();if(this.savedRanges&&this.savedRanges.length)for(i.removeAllRanges(),t=0,e=this.savedRanges.length;e>t;t+=1)i.addRange(this.savedRanges[t]);this.savedRanges=null}},t.Editable.prototype.insertMarkersAtPoint=function(t){var e=t.clientX,i=t.clientY;this.removeMarkers();var s,n=null;if("undefined"!=typeof this.document.caretPositionFromPoint?(s=this.document.caretPositionFromPoint(e,i),n=this.document.createRange(),n.setStart(s.offsetNode,s.offset),n.setEnd(s.offsetNode,s.offset)):"undefined"!=typeof this.document.caretRangeFromPoint&&(s=this.document.caretRangeFromPoint(e,i),n=this.document.createRange(),n.setStart(s.startContainer,s.startOffset),n.setEnd(s.startContainer,s.startOffset)),null!==n&&"undefined"!=typeof this.window.getSelection){var o=this.window.getSelection();o.removeAllRanges(),o.addRange(n)}else if("undefined"!=typeof this.document.body.createTextRange)try{n=this.document.body.createTextRange(),n.moveToPoint(e,i);var a=n.duplicate();a.moveToPoint(e,i),n.setEndPoint("EndToEnd",a),n.select()}catch(r){}this.placeMarker(n,!0,0),this.placeMarker(n,!1,0)},t.Editable.prototype.saveSelectionByMarkers=function(){if(!this.selectionDisabled){this.selectionInEditor()||this.focus(),this.removeMarkers();for(var t=this.getRanges(),e=0;e<t.length;e++)if(t[e].startContainer!==this.document){var i=t[e];this.placeMarker(i,!0,e),this.placeMarker(i,!1,e)}}},t.Editable.prototype.hasSelectionByMarkers=function(){var t=this.$element.find('.f-marker[data-type="true"]');return t.length>0?!0:!1},t.Editable.prototype.restoreSelectionByMarkers=function(e){if(void 0===e&&(e=!0),!this.selectionDisabled){var i=this.$element.find('.f-marker[data-type="true"]');if(0===i.length)return!1;this.$element.is(":focus")||this.browser.msie||this.$element.focus();var s=this.getSelection();(e||this.getRange()&&!this.getRange().collapsed||!t(i[0]).attr("data-collapsed"))&&(this.browser.msie&&t.Editable.getIEversion()<9||(this.clearSelection(),e=!0));for(var n=0;n<i.length;n++){var o=t(i[n]).data("id"),a=i[n],r=this.$element.find('.f-marker[data-type="false"][data-id="'+o+'"]');if(this.browser.msie&&t.Editable.getIEversion()<9)return this.setSelection(a,0,r,0),this.removeMarkers(),!1;var l;if(l=e?this.document.createRange():this.getRange(),r.length>0){r=r[0];try{l.setStartAfter(a),l.setEndBefore(r)}catch(h){}}e&&s.addRange(l)}this.removeMarkers()}},t.Editable.prototype.setSelection=function(t,e,i,s){var n=this.getSelection();if(n){this.clearSelection();try{i||(i=t),void 0===e&&(e=0),void 0===s&&(s=e);var o=this.getRange();o.setStart(t,e),o.setEnd(i,s),n.addRange(o)}catch(a){}}},t.Editable.prototype.buildMarker=function(e,i,s){return void 0===s&&(s=""),t('<span class="f-marker"'+s+' style="display:none; line-height: 0;" data-fr-verified="true" data-id="'+i+'" data-type="'+e+'">',this.document)[0]},t.Editable.prototype.placeMarker=function(e,i,s){var n="";e.collapsed&&(n=' data-collapsed="true"');try{var o=e.cloneRange();o.collapse(i);var a,r,l;if(o.insertNode(this.buildMarker(i,s,n)),i===!0&&n)for(a=this.$element.find('span.f-marker[data-type="true"][data-id="'+s+'"]').get(0).nextSibling;3===a.nodeType&&0===a.data.length;)t(a).remove(),a=this.$element.find('span.f-marker[data-type="true"][data-id="'+s+'"]').get(0).nextSibling;if(i===!0&&""===n&&(l=this.$element.find('span.f-marker[data-type="true"][data-id="'+s+'"]').get(0),a=l.nextSibling,a&&a.nodeType===Node.ELEMENT_NODE&&this.valid_nodes.indexOf(a.tagName)>=0)){r=[a];do a=r[0],r=t(a).contents();while(r[0]&&this.valid_nodes.indexOf(r[0].tagName)>=0);t(a).prepend(t(l))}if(i===!1&&""===n&&(l=this.$element.find('span.f-marker[data-type="false"][data-id="'+s+'"]').get(0),a=l.previousSibling,a&&a.nodeType===Node.ELEMENT_NODE&&this.valid_nodes.indexOf(a.tagName)>=0)){r=[a];do a=r[r.length-1],r=t(a).contents();while(r[r.length-1]&&this.valid_nodes.indexOf(r[r.length-1].tagName)>=0);t(a).append(t(l))}}catch(h){}},t.Editable.prototype.removeMarkers=function(){this.$element.find(".f-marker").remove()},t.Editable.prototype.getSelectionTextInfo=function(t){var e,i,s=!1,n=!1;if(this.window.getSelection){var o=this.window.getSelection();o.rangeCount&&(e=o.getRangeAt(0),i=e.cloneRange(),i.selectNodeContents(t),i.setEnd(e.startContainer,e.startOffset),s=""===i.toString(),i.selectNodeContents(t),i.setStart(e.endContainer,e.endOffset),n=""===i.toString())}else this.document.selection&&"Control"!=this.document.selection.type&&(e=this.document.selection.createRange(),i=e.duplicate(),i.moveToElementText(t),i.setEndPoint("EndToStart",e),s=""===i.text,i.moveToElementText(t),i.setEndPoint("StartToEnd",e),n=""===i.text);return{atStart:s,atEnd:n}},t.Editable.prototype.endsWith=function(t,e){return-1!==t.indexOf(e,t.length-e.length)}}(jQuery),function(t){t.Editable.hexToRGB=function(t){var e=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;t=t.replace(e,function(t,e,i,s){return e+e+i+i+s+s});var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return i?{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16)}:null},t.Editable.hexToRGBString=function(t){var e=this.hexToRGB(t);return e?"rgb("+e.r+", "+e.g+", "+e.b+")":""},t.Editable.RGBToHex=function(t){function e(t){return("0"+parseInt(t,10).toString(16)).slice(-2)}try{return t&&"transparent"!==t?/^#[0-9A-F]{6}$/i.test(t)?t:(t=t.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),("#"+e(t[1])+e(t[2])+e(t[3])).toUpperCase()):""}catch(i){return null}},t.Editable.getIEversion=function(){var t,e,i=-1;return"Microsoft Internet Explorer"==navigator.appName?(t=navigator.userAgent,e=new RegExp("MSIE ([0-9]{1,}[\\.0-9]{0,})"),null!==e.exec(t)&&(i=parseFloat(RegExp.$1))):"Netscape"==navigator.appName&&(t=navigator.userAgent,e=new RegExp("Trident/.*rv:([0-9]{1,}[\\.0-9]{0,})"),null!==e.exec(t)&&(i=parseFloat(RegExp.$1))),i},t.Editable.browser=function(){var t={};if(this.getIEversion()>0)t.msie=!0;else{var e=navigator.userAgent.toLowerCase(),i=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[],s={browser:i[1]||"",version:i[2]||"0"};i[1]&&(t[s.browser]=!0),parseInt(s.version,10)<9&&t.msie&&(t.oldMsie=!0),t.chrome?t.webkit=!0:t.webkit&&(t.safari=!0)}return t},t.Editable.isArray=function(t){return t&&!t.propertyIsEnumerable("length")&&"object"==typeof t&&"number"==typeof t.length},t.Editable.uniq=function(e){return t.grep(e,function(i,s){return s==t.inArray(i,e)})},t.Editable.cleanWhitespace=function(e){e.contents().filter(function(){return 1==this.nodeType&&t.Editable.cleanWhitespace(t(this)),3==this.nodeType&&!/\S/.test(this.nodeValue)}).remove()}}(jQuery),function(t){t.Editable.prototype.show=function(e){if(this.hideDropdowns(),void 0!==e){if(this.options.inlineMode||this.options.editInPopup)if(null!==e&&"touchend"!==e.type){if(this.options.showNextToCursor){var i=e.pageX,s=e.pageY;i<this.$element.offset().left&&(i=this.$element.offset().left),i>this.$element.offset().left+this.$element.width()&&(i=this.$element.offset().left+this.$element.width()),s<this.$element.offset.top&&(s=this.$element.offset().top),s>this.$element.offset().top+this.$element.height()&&(s=this.$element.offset().top+this.$element.height()),20>i&&(i=20),0>s&&(s=0),this.showByCoordinates(i,s)}else this.repositionEditor();t(".froala-editor:not(.f-basic)").hide(),this.$editor.show(),0!==this.options.buttons.length||this.options.editInPopup||this.$editor.hide()}else t(".froala-editor:not(.f-basic)").hide(),this.$editor.show(),this.repositionEditor();this.hidePopups(),this.options.editInPopup||this.showEditPopupWrapper(),this.$bttn_wrapper.show(),this.refreshButtons(),this.imageMode=!1}},t.Editable.prototype.hideDropdowns=function(){this.$bttn_wrapper.find(".fr-dropdown .fr-trigger").removeClass("active"),this.$bttn_wrapper.find(".fr-dropdown .fr-trigger")},t.Editable.prototype.hide=function(t){return this.initialized?(void 0===t&&(t=!0),t?this.hideOtherEditors():(this.closeImageMode(),this.imageMode=!1),this.$popup_editor.hide(),this.hidePopups(!1),void(this.link=!1)):!1},t.Editable.prototype.hideOtherEditors=function(){for(var e=1;e<=t.Editable.count;e++)e!=this._id&&this.$window.trigger("hide."+e)},t.Editable.prototype.hideBttnWrapper=function(){this.options.inlineMode&&this.$bttn_wrapper.hide()},t.Editable.prototype.showBttnWrapper=function(){this.options.inlineMode&&this.$bttn_wrapper.show()},t.Editable.prototype.showEditPopupWrapper=function(){this.$edit_popup_wrapper&&(this.$edit_popup_wrapper.show(),setTimeout(t.proxy(function(){this.$edit_popup_wrapper.find("input").val(this.$element.text()).focus().select()},this),1))},t.Editable.prototype.hidePopups=function(t){void 0===t&&(t=!0),t&&this.hideBttnWrapper(),this.raiseEvent("hidePopups")},t.Editable.prototype.showEditPopup=function(){this.showEditPopupWrapper()}}(jQuery),function(t){t.Editable.prototype.getBoundingRect=function(){var e;if(this.isLink){e={};var i=this.$element;e.left=i.offset().left-this.$window.scrollLeft(),e.top=i.offset().top-this.$window.scrollTop(),e.width=i.outerWidth(),e.height=parseInt(i.css("padding-top").replace("px",""),10)+i.height(),e.right=1,e.bottom=1,e.ok=!0}else if(this.getRange()&&this.getRange().collapsed){var s=t(this.getSelectionElement());this.saveSelectionByMarkers();var n=this.$element.find(".f-marker:first");n.css("display","inline");var o=n.offset();n.css("display","none"),e={},e.left=o.left-this.$window.scrollLeft(),e.width=0,e.height=(parseInt(s.css("line-height").replace("px",""),10)||10)-10-this.$window.scrollTop(),e.top=o.top,e.right=1,e.bottom=1,e.ok=!0,this.removeMarkers()}else this.getRange()&&(e=this.getRange().getBoundingClientRect());return e},t.Editable.prototype.repositionEditor=function(t){var e,i,s;if(this.options.inlineMode||t){if(e=this.getBoundingRect(),this.showBttnWrapper(),e.ok||e.left>=0&&e.top>=0&&e.right>0&&e.bottom>0)i=e.left+e.width/2,s=e.top+e.height,this.iOS()&&this.iOSVersion()<8||(i+=this.$window.scrollLeft(),s+=this.$window.scrollTop()),this.showByCoordinates(i,s);else if(this.options.alwaysVisible)this.hide();else{var n=this.$element.offset();this.showByCoordinates(n.left,n.top+10)}0===this.options.buttons.length&&this.hide()}},t.Editable.prototype.showByCoordinates=function(t,e){t-=22,e+=8;var i=this.$document.find(this.options.scrollableContainer);"body"!=this.options.scrollableContainer&&(t-=i.offset().left,e-=i.offset().top,this.iPad()||(e+=i.scrollTop(),t+=i.scrollLeft())),e>this.$box.offset().top+this.$box.outerHeight()&&(e=this.$box.offset().top+this.$box.outerHeight(),this.options.inlineMode&&(e+=10));var s=Math.max(this.$popup_editor.outerWidth(),250);t+s>=i.outerWidth()-50&&t+44-s>0?(this.$popup_editor.addClass("right-side"),t=i.outerWidth()-(t+44),"static"==i.css("position")&&(t=t+parseFloat(i.css("margin-left"),10)+parseFloat(i.css("margin-right"),10)),this.$popup_editor.css("top",e),this.$popup_editor.css("right",t),this.$popup_editor.css("left","auto")):t+s<i.outerWidth()-50?(this.$popup_editor.removeClass("right-side"),this.$popup_editor.css("top",e),this.$popup_editor.css("left",t),this.$popup_editor.css("right","auto")):(this.$popup_editor.removeClass("right-side"),this.$popup_editor.css("top",e),this.$popup_editor.css("left",Math.max(i.outerWidth()-s,10)/2),this.$popup_editor.css("right","auto")),this.$popup_editor.show()},t.Editable.prototype.positionPopup=function(e){if(t(this.$editor.find('button.fr-bttn[data-cmd="'+e+'"]')).length){var i=this.$editor.find('button.fr-bttn[data-cmd="'+e+'"]'),s=i.width(),n=i.height(),o=i.offset().left+s/2,a=i.offset().top+n;this.showByCoordinates(o,a)}}}(jQuery),function(t){t.Editable.prototype.refreshImageAlign=function(t){this.$image_editor.find('.fr-dropdown > button[data-name="align"] + ul li').removeClass("active");var e="floatImageNone",i="center";t.hasClass("fr-fil")?(i="left",e="floatImageLeft"):t.hasClass("fr-fir")&&(i="right",e="floatImageRight"),this.$image_editor.find('.fr-dropdown > button[data-name="align"].fr-trigger i').attr("class","fa fa-align-"+i),this.$image_editor.find('.fr-dropdown > button[data-name="align"] + ul li[data-val="'+e+'"]').addClass("active")},t.Editable.prototype.refreshImageDisplay=function(){var t=this.$element.find(".f-img-editor");this.$image_editor.find('.fr-dropdown > button[data-name="display"] + ul li').removeClass("active"),t.hasClass("fr-dib")?this.$image_editor.find('.fr-dropdown > button[data-name="display"] + ul li[data-val="fr-dib"]').addClass("active"):this.$image_editor.find('.fr-dropdown > button[data-name="display"] + ul li[data-val="fr-dii"]').addClass("active")},t.Editable.image_commands={align:{title:"Alignment",icon:"fa fa-align-center",refresh:t.Editable.prototype.refreshImageAlign,refreshOnShow:t.Editable.prototype.refreshImageAlign,seed:[{cmd:"floatImageLeft",title:"Align Left",icon:"fa fa-align-left"},{cmd:"floatImageNone",title:"Align Center",icon:"fa fa-align-center"},{cmd:"floatImageRight",title:"Align Right",icon:"fa fa-align-right"}],callback:function(t,e,i){this[i](t)},undo:!0},display:{title:"Text Wrap",icon:"fa fa-star",refreshOnShow:t.Editable.prototype.refreshImageDisplay,namespace:"Image",seed:[{title:"Inline",value:"fr-dii"},{title:"Break Text",value:"fr-dib"}],callback:function(t,e,i){this.displayImage(t,i)},undo:!0},linkImage:{title:"Insert Link",icon:{type:"font",value:"fa fa-link"},callback:function(t){this.linkImage(t)}},replaceImage:{title:"Replace Image",icon:{type:"font",value:"fa fa-exchange"},callback:function(t){this.replaceImage(t)}},removeImage:{title:"Remove Image",icon:{type:"font",value:"fa fa-trash-o"},callback:function(t){this.removeImage(t)}}},t.Editable.DEFAULTS=t.extend(t.Editable.DEFAULTS,{allowedImageTypes:["jpeg","jpg","png","gif"],customImageButtons:{},defaultImageTitle:"Image title",defaultImageWidth:300,defaultImageDisplay:"block",defaultImageAlignment:"center",imageButtons:["display","align","linkImage","replaceImage","removeImage"],imageDeleteConfirmation:!0,imageDeleteURL:null,imageDeleteParams:{},imageMove:!0,imageResize:!0,imageLink:!0,imageTitle:!0,imageUpload:!0,imageUploadParams:{},imageUploadParam:"file",imageUploadToS3:!1,imageUploadURL:"http://i.froala.com/upload",maxImageSize:10485760,pasteImage:!0,textNearImage:!0}),t.Editable.prototype.hideImageEditorPopup=function(){this.$image_editor&&this.$image_editor.hide()},t.Editable.prototype.showImageEditorPopup=function(){this.$image_editor&&this.$image_editor.show(),this.options.imageMove||this.$element.attr("contenteditable",!1)},t.Editable.prototype.showImageWrapper=function(){this.$image_wrapper&&this.$image_wrapper.show()},t.Editable.prototype.hideImageWrapper=function(t){this.$image_wrapper&&(this.$element.attr("data-resize")||t||(this.closeImageMode(),this.imageMode=!1),this.$image_wrapper.hide(),this.$image_wrapper.find("input").blur())},t.Editable.prototype.showInsertImage=function(){this.hidePopups(),this.showImageWrapper()},t.Editable.prototype.showImageEditor=function(){this.hidePopups(),this.showImageEditorPopup()},t.Editable.prototype.insertImageHTML=function(){var e='<div class="froala-popup froala-image-popup" style="display: none;"><h4><span data-text="true">Insert Image</span><span data-text="true">Uploading image</span><i title="Cancel" class="fa fa-times" id="f-image-close-'+this._id+'"></i></h4>';return e+='<div id="f-image-list-'+this._id+'">',this.options.imageUpload&&(e+='<div class="f-popup-line drop-upload">',e+='<div class="f-upload" id="f-upload-div-'+this._id+'"><strong data-text="true">Drop Image</strong><br>(<span data-text="true">or click</span>)<form target="frame-'+this._id+'" enctype="multipart/form-data" encoding="multipart/form-data" action="'+this.options.imageUploadURL+'" method="post" id="f-upload-form-'+this._id+'"><input id="f-file-upload-'+this._id+'" type="file" name="'+this.options.imageUploadParam+'" accept="image/*"></form></div>',this.browser.msie&&t.Editable.getIEversion()<=9&&(e+='<iframe id="frame-'+this._id+'" name="frame-'+this._id+'" src="javascript:false;" style="width:0; height:0; border:0px solid #FFF; position: fixed; z-index: -1;"></iframe>'),e+="</div>"),this.options.imageLink&&(e+='<div class="f-popup-line"><label><span data-text="true">Enter URL</span>: </label><input id="f-image-url-'+this._id+'" type="text" placeholder="http://taihuoniao.com"><button class="f-browse fr-p-bttn" id="f-browser-'+this._id+'"><i class="fa fa-search"></i></button><button data-text="true" class="f-ok fr-p-bttn f-submit" id="f-image-ok-'+this._id+'">OK</button></div>'),e+="</div>",e+='<p class="f-progress" id="f-progress-'+this._id+'"><span></span></p>',e+="</div>"},t.Editable.prototype.iFrameLoad=function(){var t=this.$image_wrapper.find("iframe#frame-"+this._id);if(!t.attr("data-loaded"))return t.attr("data-loaded",!0),!1;try{var e=this.$image_wrapper.find("#f-upload-form-"+this._id);if(this.options.imageUploadToS3){var i=e.attr("action"),s=e.find('input[name="key"]').val(),n=i+s;this.writeImage(n),this.options.imageUploadToS3.callback&&this.options.imageUploadToS3.callback.call(this,n,s)}else{var o=t.contents().text();this.parseImageResponse(o)}}catch(a){this.throwImageError(7)}},t.Editable.prototype.initImage=function(){this.buildInsertImage(),(!this.isLink||this.isImage)&&this.initImagePopup(),this.addListener("destroy",this.destroyImage)},t.Editable.initializers.push(t.Editable.prototype.initImage),t.Editable.prototype.destroyImage=function(){this.$image_editor&&this.$image_editor.html("").removeData().remove(),this.$image_wrapper&&this.$image_wrapper.html("").removeData().remove()},t.Editable.prototype.buildInsertImage=function(){this.$image_wrapper=t(this.insertImageHTML()),this.$popup_editor.append(this.$image_wrapper);var e=this;if(this.$image_wrapper.on("mouseup touchend",t.proxy(function(t){this.isResizing()||t.stopPropagation()},this)),this.addListener("hidePopups",t.proxy(function(){this.hideImageWrapper(!0)},this)),this.$progress_bar=this.$image_wrapper.find("p#f-progress-"+this._id),this.options.imageUpload){if(this.browser.msie&&t.Editable.getIEversion()<=9){var i=this.$image_wrapper.find("iframe").get(0);i.attachEvent?i.attachEvent("onload",function(){e.iFrameLoad()}):i.onload=function(){e.iFrameLoad()}}this.$image_wrapper.on("change",'input[type="file"]',function(){if(void 0!==this.files)e.uploadImage(this.files);else{if(!e.triggerEvent("beforeImageUpload",[],!1))return!1;var i=t(this).parents("form");i.find('input[type="hidden"]').remove();var s;for(s in e.options.imageUploadParams)i.prepend('<input type="hidden" name="'+s+'" value="'+e.options.imageUploadParams[s]+'" />');if(e.options.imageUploadToS3!==!1){for(s in e.options.imageUploadToS3.params)i.prepend('<input type="hidden" name="'+s+'" value="'+e.options.imageUploadToS3.params[s]+'" />');i.prepend('<input type="hidden" name="success_action_status" value="201" />'),i.prepend('<input type="hidden" name="X-Requested-With" value="xhr" />'),i.prepend('<input type="hidden" name="Content-Type" value="" />'),i.prepend('<input type="hidden" name="key" value="'+e.options.imageUploadToS3.keyStart+(new Date).getTime()+"-"+t(this).val().match(/[^\/\\]+$/)+'" />')}else i.prepend('<input type="hidden" name="XHR_CORS_TRARGETORIGIN" value="'+e.window.location.href+'" />');e.showInsertImage(),e.showImageLoader(!0),e.disable(),i.submit()}t(this).val("")})}this.buildDragUpload(),this.$image_wrapper.on("mouseup keydown","#f-image-url-"+this._id,t.proxy(function(t){var e=t.which;e&&27===e||t.stopPropagation()},this)),this.$image_wrapper.on("click","#f-image-ok-"+this._id,t.proxy(function(){this.writeImage(this.$image_wrapper.find("#f-image-url-"+this._id).val(),!0)},this)),this.$image_wrapper.on(this.mouseup,"#f-image-close-"+this._id,t.proxy(function(t){return this.isDisabled?!1:(t.stopPropagation(),this.$bttn_wrapper.show(),this.hideImageWrapper(!0),this.options.inlineMode&&0===this.options.buttons.length&&(this.imageMode?this.showImageEditor():this.hide()),this.imageMode||(this.restoreSelection(),this.focus()),void(this.options.inlineMode||this.imageMode?this.imageMode&&this.showImageEditor():this.hide()))},this)),this.$image_wrapper.on("click",function(t){t.stopPropagation()}),this.$image_wrapper.on("click","*",function(t){t.stopPropagation()})},t.Editable.prototype.deleteImage=function(e){if(this.options.imageDeleteURL){var i=this.options.imageDeleteParams;i.info=e.data("info"),i.src=e.attr("src"),t.ajax({type:"POST",url:this.options.imageDeleteURL,data:i,crossDomain:this.options.crossDomain,xhrFields:{withCredentials:this.options.withCredentials},headers:this.options.headers}).done(t.proxy(function(t){e.parent().parent().hasClass("f-image-list")?e.parent().remove():e.parent().removeClass("f-img-deleting"),this.triggerEvent("imageDeleteSuccess",[t],!1)},this)).fail(t.proxy(function(){e.parent().removeClass("f-img-deleting"),this.triggerEvent("imageDeleteError",["Error during image delete."],!1)},this))}else e.parent().removeClass("f-img-deleting"),this.triggerEvent("imageDeleteError",["Missing imageDeleteURL option."],!1)},t.Editable.prototype.imageHandle=function(){var e=this,i=t('<span data-fr-verified="true">').addClass("f-img-handle").on({movestart:function(i){e.hide(),e.$element.addClass("f-non-selectable").attr("contenteditable",!1),e.$element.attr("data-resize",!0),t(this).attr("data-start-x",i.startX),t(this).attr("data-start-y",i.startY)},move:function(i){var s=t(this),n=i.pageX-parseInt(s.attr("data-start-x"),10);s.attr("data-start-x",i.pageX),s.attr("data-start-y",i.pageY);var o=s.prevAll("img"),a=o.width();s.hasClass("f-h-ne")||s.hasClass("f-h-se")?o.attr("width",a+n):o.attr("width",a-n),e.triggerEvent("imageResize",[o],!1)},moveend:function(){t(this).removeAttr("data-start-x"),t(this).removeAttr("data-start-y");var i=t(this),s=i.prevAll("img");e.$element.removeClass("f-non-selectable"),e.isImage||e.$element.attr("contenteditable",!0),e.triggerEvent("imageResizeEnd",[s]),t(this).trigger("mouseup")},touchend:function(){t(this).trigger("moveend")}});return i},t.Editable.prototype.disableImageResize=function(){if(this.browser.mozilla)try{document.execCommand("enableObjectResizing",!1,!1),document.execCommand("enableInlineTableEditing",!1,!1)}catch(t){}},t.Editable.prototype.isResizing=function(){return this.$element.attr("data-resize")},t.Editable.prototype.getImageStyle=function(t){var e="z-index: 1; position: relative; overflow: auto;",i=t,s="padding";return t.parent().hasClass("f-img-editor")&&(i=t.parent(),s="margin"),e+=" padding-left:"+i.css(s+"-left")+";",e+=" padding-right:"+i.css(s+"-right")+";",e+=" padding-bottom:"+i.css(s+"-bottom")+";",e+=" padding-top:"+i.css(s+"-top")+";",t.hasClass("fr-dib")?(e+=" vertical-align: top; display: block;",e+=t.hasClass("fr-fir")?" float: none; margin-right: 0; margin-left: auto;":t.hasClass("fr-fil")?" float: none; margin-left: 0; margin-right: auto;":" float: none; margin: auto;"):(e+=" display: inline-block;",e+=t.hasClass("fr-fir")?" float: right;":t.hasClass("fr-fil")?" float: left;":" float: none;"),e},t.Editable.prototype.getImageClass=function(t){var e=t.split(" ");return t="fr-fin",e.indexOf("fr-fir")>=0&&(t="fr-fir"),e.indexOf("fr-fil")>=0&&(t="fr-fil"),e.indexOf("fr-dib")>=0&&(t+=" fr-dib"),e.indexOf("fr-dii")>=0&&(t+=" fr-dii"),t},t.Editable.prototype.refreshImageButtons=function(t){this.$image_editor.find("button").removeClass("active");var e=t.css("float");e=t.hasClass("fr-fil")?"Left":t.hasClass("fr-fir")?"Right":"None",this.$image_editor.find('button[data-cmd="floatImage'+e+'"]').addClass("active"),this.raiseEvent("refreshImage",[t])},t.Editable.prototype.initImageEvents=function(){document.addEventListener&&!document.dropAssigned&&(document.dropAssigned=!0,document.addEventListener("drop",t.proxy(function(e){return t(".froala-element img.fr-image-move").length?(e.preventDefault(),e.stopPropagation(),t(".froala-element img.fr-image-move").removeClass("fr-image-move"),!1):void 0},this))),this.disableImageResize();var e=this;this.$element.on("mousedown",'img:not([contenteditable="false"])',function(i){return e.isDisabled?!1:void(e.isResizing()||(e.initialized&&i.stopPropagation(),e.$element.attr("contenteditable",!1),t(this).addClass("fr-image-move")))}),this.$element.on("mouseup",'img:not([contenteditable="false"])',function(){return e.isDisabled?!1:void(e.isResizing()||(e.options.imageMove||e.isImage||e.isHTML||e.$element.attr("contenteditable",!0),t(this).removeClass("fr-image-move")))}),this.$element.on("click touchend",'img:not([contenteditable="false"])',function(i){if(e.isDisabled)return!1;if(!e.isResizing()&&e.initialized){if(i.preventDefault(),i.stopPropagation(),e.closeImageMode(),e.$element.blur(),e.refreshImageButtons(t(this)),e.$image_editor.find('.f-image-alt input[type="text"]').val(t(this).attr("alt")||t(this).attr("title")),e.showImageEditor(),!t(this).parent().hasClass("f-img-editor")||"SPAN"!=t(this).parent().get(0).tagName){var s=e.getImageClass(t(this).attr("class"));t(this).wrap('<span data-fr-verified="true" class="f-img-editor '+s+'"></span>'),0!==t(this).parents(".f-img-wrap").length||e.isImage?t(this).parents(".f-img-wrap").attr("class",s+" f-img-wrap"):t(this).parents("a").length>0?t(this).parents("a:first").wrap('<span data-fr-verified="true" class="f-img-wrap '+s+'"></span>'):t(this).parent().wrap('<span data-fr-verified="true" class="f-img-wrap '+s+'"></span>')}if(t(this).parent().find(".f-img-handle").remove(),e.options.imageResize){var n=e.imageHandle();t(this).parent().append(n.clone(!0).addClass("f-h-ne")),t(this).parent().append(n.clone(!0).addClass("f-h-se")),t(this).parent().append(n.clone(!0).addClass("f-h-sw")),t(this).parent().append(n.clone(!0).addClass("f-h-nw"))}e.showByCoordinates(t(this).offset().left+t(this).width()/2,t(this).offset().top+t(this).height()),e.imageMode=!0,e.$bttn_wrapper.find(".fr-bttn").removeClass("active"),e.clearSelection()}}),this.$element.on("mousedown touchstart",".f-img-handle",t.proxy(function(){return e.isDisabled?!1:void this.$element.attr("data-resize",!0)},this)),this.$element.on("mouseup",".f-img-handle",t.proxy(function(i){if(e.isDisabled)return!1;var s=t(i.target).prevAll("img");setTimeout(t.proxy(function(){this.$element.removeAttr("data-resize"),s.click()},this),0)},this))},t.Editable.prototype.execImage=function(e,i,s){var n=this.$element.find("span.f-img-editor"),o=n.find("img"),a=t.Editable.image_commands[e]||this.options.customImageButtons[e];a&&a.callback&&a.callback.apply(this,[o,e,i,s])},t.Editable.prototype.bindImageRefreshListener=function(e){e.refresh&&this.addListener("refreshImage",t.proxy(function(t){e.refresh.apply(this,[t])},this))},t.Editable.prototype.buildImageButton=function(t,e){var i='<button class="fr-bttn" data-namespace="Image" data-cmd="'+e+'" title="'+t.title+'">';return i+=void 0!==this.options.icons[e]?this.prepareIcon(this.options.icons[e],t.title):this.prepareIcon(t.icon,t.title),i+="</button>",this.bindImageRefreshListener(t),i},t.Editable.prototype.buildImageAlignDropdown=function(t){this.bindImageRefreshListener(t);for(var e='<ul class="fr-dropdown-menu f-align">',i=0;i<t.seed.length;i++){var s=t.seed[i];e+='<li data-cmd="align" data-namespace="Image" data-val="'+s.cmd+'" title="'+s.title+'"><a href="#"><i class="'+s.icon+'"></i></a></li>'}return e+="</ul>"},t.Editable.prototype.buildImageDropdown=function(t){return dropdown=this.buildDefaultDropdown(t),btn=this.buildDropdownButton(t,dropdown),btn},t.Editable.prototype.image_command_dispatcher={align:function(t){var e=this.buildImageAlignDropdown(t),i=this.buildDropdownButton(t,e);return i}},t.Editable.prototype.buildImageButtons=function(){for(var e="",i=0;i<this.options.imageButtons.length;i++){var s=this.options.imageButtons[i];if(void 0!==t.Editable.image_commands[s]||void 0!==this.options.customImageButtons[s]){var n=t.Editable.image_commands[s]||this.options.customImageButtons[s];n.cmd=s;var o=this.image_command_dispatcher[s];e+=o?o.apply(this,[n]):n.seed?this.buildImageDropdown(n,s):this.buildImageButton(n,s)}}return e},t.Editable.prototype.initImagePopup=function(){this.$image_editor=t('<div class="froala-popup froala-image-editor-popup" style="display: none">');var e=t('<div class="f-popup-line f-popup-toolbar">').appendTo(this.$image_editor);

e.append(this.buildImageButtons()),this.addListener("hidePopups",this.hideImageEditorPopup),this.options.imageTitle&&t('<div class="f-popup-line f-image-alt">').append('<label><span data-text="true">Title</span>: </label>').append(t('<input type="text">').on("mouseup keydown touchend",function(t){var e=t.which;e&&27===e||t.stopPropagation()})).append('<button class="fr-p-bttn f-ok" data-text="true" data-callback="setImageAlt" data-cmd="setImageAlt" title="OK">OK</button>').appendTo(this.$image_editor),this.$popup_editor.append(this.$image_editor),this.bindCommandEvents(this.$image_editor),this.bindDropdownEvents(this.$image_editor)},t.Editable.prototype.displayImage=function(t,e){var i=t.parents("span.f-img-editor");i.removeClass("fr-dii fr-dib").addClass(e),this.triggerEvent("imageDisplayed",[t,e]),t.click()},t.Editable.prototype.floatImageLeft=function(t){var e=t.parents("span.f-img-editor");e.removeClass("fr-fin fr-fil fr-fir").addClass("fr-fil"),this.isImage&&this.$element.css("float","left"),this.triggerEvent("imageFloatedLeft",[t]),t.click()},t.Editable.prototype.floatImageNone=function(t){var e=t.parents("span.f-img-editor");e.removeClass("fr-fin fr-fil fr-fir").addClass("fr-fin"),this.isImage||(e.parent().get(0)==this.$element.get(0)?e.wrap('<div style="text-align: center;"></div>'):e.parents(".f-img-wrap:first").css("text-align","center")),this.isImage&&this.$element.css("float","none"),this.triggerEvent("imageFloatedNone",[t]),t.click()},t.Editable.prototype.floatImageRight=function(t){var e=t.parents("span.f-img-editor");e.removeClass("fr-fin fr-fil fr-fir").addClass("fr-fir"),this.isImage&&this.$element.css("float","right"),this.triggerEvent("imageFloatedRight",[t]),t.click()},t.Editable.prototype.linkImage=function(t){this.imageMode=!0,this.showInsertLink();var e=t.parents("span.f-img-editor");"A"==e.parent().get(0).tagName?this.updateLinkValues(e.parent()):this.resetLinkValues()},t.Editable.prototype.replaceImage=function(t){this.showInsertImage(),this.imageMode=!0,this.$image_wrapper.find('input[type="text"]').val(t.attr("src")),this.showByCoordinates(t.offset().left+t.width()/2,t.offset().top+t.height())},t.Editable.prototype.removeImage=function(e){var i=e.parents("span.f-img-editor");if(0===i.length)return!1;var s=e.get(0),n="Are you sure? Image will be deleted.";if(t.Editable.LANGS[this.options.language]&&(n=t.Editable.LANGS[this.options.language].translation[n]),!this.options.imageDeleteConfirmation||confirm(n)){if(this.triggerEvent("beforeRemoveImage",[t(s)],!1)){var o=i.parents(this.valid_nodes.join(","));i.parents(".f-img-wrap").length?i.parents(".f-img-wrap").remove():i.remove(),this.refreshImageList(!0),this.hide(),o.length&&o[0]!=this.$element.get(0)&&""===t(o[0]).text()&&1==o[0].childNodes.length&&t(o[0]).remove(),this.wrapText(),this.triggerEvent("afterRemoveImage",[e]),this.focus(),this.imageMode=!1}}else e.click()},t.Editable.prototype.setImageAlt=function(){var t=this.$element.find("span.f-img-editor"),e=t.find("img");e.attr("alt",this.$image_editor.find('.f-image-alt input[type="text"]').val()),e.attr("title",this.$image_editor.find('.f-image-alt input[type="text"]').val()),this.hide(),this.closeImageMode(),this.triggerEvent("imageAltSet",[e])},t.Editable.prototype.buildImageMove=function(){var e=this;this.isLink||this.initDrag(),e.$element.on("dragover dragenter dragend",function(t){t.preventDefault()}),e.$element.on("drop",function(i){if(e.isDisabled)return!1;if(e.closeImageMode(),e.hide(),e.imageMode=!1,e.initialized||(e.$element.unbind("mousedown.element"),e.lateInit()),!e.options.imageUpload||0!==t(".froala-element img.fr-image-move").length){if(t(".froala-element .fr-image-move").length>0&&e.options.imageMove){i.preventDefault(),i.stopPropagation(),e.insertMarkersAtPoint(i.originalEvent),e.restoreSelectionByMarkers();var s=t("<div>").append(t(".froala-element img.fr-image-move").clone().removeClass("fr-image-move").addClass("fr-image-dropped")).html();e.insertHTML(s);var n=t(".froala-element img.fr-image-move").parent();t(".froala-element img.fr-image-move").remove(),n.get(0)!=e.$element.get(0)&&n.is(":empty")&&n.remove(),e.clearSelection(),e.initialized?setTimeout(function(){e.$element.find(".fr-image-dropped").removeClass(".fr-image-dropped").click()},0):e.$element.find(".fr-image-dropped").removeClass(".fr-image-dropped"),e.sync(),e.hideOtherEditors()}else i.preventDefault(),i.stopPropagation(),t(".froala-element img.fr-image-move").removeClass("fr-image-move");return!1}if(i.originalEvent.dataTransfer&&i.originalEvent.dataTransfer.files&&i.originalEvent.dataTransfer.files.length){if(e.isDisabled)return!1;var o=i.originalEvent.dataTransfer.files;e.options.allowedImageTypes.indexOf(o[0].type.replace(/image\//g,""))>=0&&(e.insertMarkersAtPoint(i.originalEvent),e.showByCoordinates(i.originalEvent.pageX,i.originalEvent.pageY),e.uploadImage(o),i.preventDefault(),i.stopPropagation())}})},t.Editable.prototype.buildDragUpload=function(){var e=this;e.$image_wrapper.on("dragover","#f-upload-div-"+this._id,function(){return t(this).addClass("f-hover"),!1}),e.$image_wrapper.on("dragend","#f-upload-div-"+this._id,function(){return t(this).removeClass("f-hover"),!1}),e.$image_wrapper.on("drop","#f-upload-div-"+this._id,function(i){return i.preventDefault(),i.stopPropagation(),e.options.imageUpload?(t(this).removeClass("f-hover"),void e.uploadImage(i.originalEvent.dataTransfer.files)):!1})},t.Editable.prototype.showImageLoader=function(e){if(void 0===e&&(e=!1),e){var i="Please wait!";t.Editable.LANGS[this.options.language]&&(i=t.Editable.LANGS[this.options.language].translation[i]),this.$progress_bar.find("span").css("width","100%").text(i)}else this.$image_wrapper.find("h4").addClass("uploading");this.$image_wrapper.find("#f-image-list-"+this._id).hide(),this.$progress_bar.show(),this.showInsertImage()},t.Editable.prototype.hideImageLoader=function(){this.$progress_bar.hide(),this.$progress_bar.find("span").css("width","0%").text(""),this.$image_wrapper.find("#f-image-list-"+this._id).show(),this.$image_wrapper.find("h4").removeClass("uploading")},t.Editable.prototype.writeImage=function(e,i,s){if(i&&(e=this.sanitizeURL(e),""===e))return!1;var n=new Image;n.onerror=t.proxy(function(){this.hideImageLoader(),this.throwImageError(1)},this),n.onload=this.imageMode?t.proxy(function(){var t=this.$element.find(".f-img-editor > img");t.attr("src",e),this.hide(),this.hideImageLoader(),this.$image_editor.show(),this.enable(),this.triggerEvent("imageReplaced",[t,s]),setTimeout(function(){t.trigger("click")},0)},this):t.proxy(function(){this.insertLoadedImage(e,s)},this),this.showImageLoader(!0),n.src=e},t.Editable.prototype.processInsertImage=function(e,i){void 0===i&&(i=!0),this.enable(),this.focus(),this.restoreSelection();var s="";parseInt(this.options.defaultImageWidth,10)&&(s=' width="'+this.options.defaultImageWidth+'"');var n="fr-fin";"left"==this.options.defaultImageAlignment&&(n="fr-fil"),"right"==this.options.defaultImageAlignment&&(n="fr-fir"),n+=" fr-di"+this.options.defaultImageDisplay[0];var o='<img class="'+n+' fr-just-inserted" alt="'+this.options.defaultImageTitle+'" src="'+e+'"'+s+">",a=this.getSelectionElements()[0],r=this.getRange(),l=!this.browser.msie&&t.Editable.getIEversion()>8?t(r.startContainer):null;l&&l.hasClass("f-img-wrap")?(1===r.startOffset?(l.after("<"+this.options.defaultTag+'><span class="f-marker" data-type="true" data-id="0"></span><br/><span class="f-marker" data-type="false" data-id="0"></span></'+this.options.defaultTag+">"),this.restoreSelectionByMarkers(),this.getSelection().collapseToStart()):0===r.startOffset&&(l.before("<"+this.options.defaultTag+'><span class="f-marker" data-type="true" data-id="0"></span><br/><span class="f-marker" data-type="false" data-id="0"></span></'+this.options.defaultTag+">"),this.restoreSelectionByMarkers(),this.getSelection().collapseToStart()),this.insertHTML(o)):this.getSelectionTextInfo(a).atStart&&a!=this.$element.get(0)&&"TD"!=a.tagName&&"TH"!=a.tagName&&"LI"!=a.tagName?t(a).before("<"+this.options.defaultTag+">"+o+"</"+this.options.defaultTag+">"):this.insertHTML(o),this.disable()},t.Editable.prototype.insertLoadedImage=function(e,i){this.triggerEvent("imageLoaded",[e],!1),this.processInsertImage(e,!1),this.browser.msie&&this.$element.find("img").each(function(t,e){e.oncontrolselect=function(){return!1}}),this.enable(),this.hide(),this.hideImageLoader(),this.wrapText(),this.cleanupLists();var s,n=this.$element.find("img.fr-just-inserted").get(0);n&&(s=n.previousSibling),s&&3==s.nodeType&&/\u200B/gi.test(s.textContent)&&t(s).remove(),this.triggerEvent("imageInserted",[this.$element.find("img.fr-just-inserted"),i]),setTimeout(t.proxy(function(){this.$element.find("img.fr-just-inserted").removeClass("fr-just-inserted").trigger("touchend")},this),50)},t.Editable.prototype.throwImageErrorWithMessage=function(t){this.enable(),this.triggerEvent("imageError",[{message:t,code:0}],!1),this.hideImageLoader()},t.Editable.prototype.throwImageError=function(t){this.enable();var e="Unknown image upload error.";1==t?e="Bad link.":2==t?e="No link in upload response.":3==t?e="Error during file upload.":4==t?e="Parsing response failed.":5==t?e="Image too large.":6==t?e="Invalid image type.":7==t&&(e="Image can be uploaded only to same domain in IE 8 and IE 9."),this.triggerEvent("imageError",[{code:t,message:e}],!1),this.hideImageLoader()},t.Editable.prototype.uploadImage=function(e){if(!this.triggerEvent("beforeImageUpload",[e],!1))return!1;if(void 0!==e&&e.length>0){var i;if(this.drag_support.formdata&&(i=this.drag_support.formdata?new FormData:null),i){var s;for(s in this.options.imageUploadParams)i.append(s,this.options.imageUploadParams[s]);if(this.options.imageUploadToS3!==!1){for(s in this.options.imageUploadToS3.params)i.append(s,this.options.imageUploadToS3.params[s]);i.append("success_action_status","201"),i.append("X-Requested-With","xhr"),i.append("Content-Type",e[0].type),i.append("key",this.options.imageUploadToS3.keyStart+(new Date).getTime()+"-"+e[0].name)}if(i.append(this.options.imageUploadParam,e[0]),e[0].size>this.options.maxImageSize)return this.throwImageError(5),!1;if(this.options.allowedImageTypes.indexOf(e[0].type.replace(/image\//g,""))<0)return this.throwImageError(6),!1}if(i){var n;if(this.options.crossDomain)n=this.createCORSRequest("POST",this.options.imageUploadURL);else{n=new XMLHttpRequest,n.open("POST",this.options.imageUploadURL);for(var o in this.options.headers)n.setRequestHeader(o,this.options.headers[o])}n.onload=t.proxy(function(){var e="Please wait!";t.Editable.LANGS[this.options.language]&&(e=t.Editable.LANGS[this.options.language].translation[e]),this.$progress_bar.find("span").css("width","100%").text(e);try{if(this.options.imageUploadToS3)201==n.status?this.parseImageResponseXML(n.responseXML):this.throwImageError(3);else if(n.status>=200&&n.status<300)this.parseImageResponse(n.responseText);else try{var i=t.parseJSON(n.responseText);i.error?this.throwImageErrorWithMessage(i.error):this.throwImageError(3)}catch(s){this.throwImageError(3)}}catch(s){this.throwImageError(4)}},this),n.onerror=t.proxy(function(){this.throwImageError(3)},this),n.upload.onprogress=t.proxy(function(t){if(t.lengthComputable){var e=t.loaded/t.total*100|0;this.$progress_bar.find("span").css("width",e+"%")}},this),this.disable(),n.send(i),this.showImageLoader()}}},t.Editable.prototype.parseImageResponse=function(e){try{if(!this.triggerEvent("afterImageUpload",[e],!1))return!1;var i=t.parseJSON(e);i.link?this.writeImage(i.link,!1,e):i.error?this.throwImageErrorWithMessage(i.error):this.throwImageError(2)}catch(s){this.throwImageError(4)}},t.Editable.prototype.parseImageResponseXML=function(e){try{var i=t(e).find("Location").text(),s=t(e).find("Key").text();this.options.imageUploadToS3.callback&&this.options.imageUploadToS3.callback.call(this,i,s),i?this.writeImage(i):this.throwImageError(2)}catch(n){this.throwImageError(4)}},t.Editable.prototype.setImageUploadURL=function(t){t&&(this.options.imageUploadURL=t),this.options.imageUploadToS3&&(this.options.imageUploadURL="https://"+this.options.imageUploadToS3.bucket+"."+this.options.imageUploadToS3.region+".amazonaws.com/")},t.Editable.prototype.closeImageMode=function(){this.$element.find("span.f-img-editor > img").each(t.proxy(function(e,i){t(i).removeClass("fr-fin fr-fil fr-fir fr-dib fr-dii").addClass(this.getImageClass(t(i).parent().attr("class"))),t(i).parents(".f-img-wrap").length>0?"A"==t(i).parent().parent().get(0).tagName?t(i).siblings("span.f-img-handle").remove().end().unwrap().parent().unwrap():t(i).siblings("span.f-img-handle").remove().end().unwrap().unwrap():t(i).siblings("span.f-img-handle").remove().end().unwrap()},this)),this.$element.find("span.f-img-editor").length&&(this.$element.find("span.f-img-editor").remove(),this.$element.parents("span.f-img-editor").remove()),this.$element.removeClass("f-non-selectable"),this.editableDisabled||this.isHTML||this.$element.attr("contenteditable",!0),this.$image_editor&&this.$image_editor.hide(),this.$link_wrapper&&this.options.linkText&&this.$link_wrapper.find('input[type="text"].f-lt').parent().removeClass("fr-hidden")},t.Editable.prototype.refreshImageList=function(e){if(!this.isLink&&!this.options.editInPopup){var i=[],s=[],n=this;if(this.$element.find("img").each(function(e,o){var a=t(o);if(i.push(a.attr("src")),s.push(a),"false"==a.attr("contenteditable"))return!0;if(0!==a.parents(".f-img-editor").length||a.hasClass("fr-dii")||a.hasClass("fr-dib")||(n.options.textNearImage?a.addClass(a.hasClass("fr-fin")?"fr-dib":a.hasClass("fr-fil")||a.hasClass("fr-fir")?"fr-dii":"block"==a.css("display")&&"none"==a.css("float")?"fr-dib":"fr-dii"):(a.addClass("fr-dib"),n.options.imageButtons.splice(n.options.imageButtons.indexOf("display"),1))),n.options.textNearImage||a.removeClass("fr-dii").addClass("fr-dib"),0===a.parents(".f-img-editor").length&&!a.hasClass("fr-fil")&&!a.hasClass("fr-fir")&&!a.hasClass("fr-fin"))if(a.hasClass("fr-dii"))a.addClass("right"==a.css("float")?"fr-fir":"left"==a.css("float")?"fr-fil":"fr-fin");else{var r=a.attr("style");a.hide(),a.addClass(0===parseInt(a.css("margin-right"),10)&&r?"fr-fir":0===parseInt(a.css("margin-left"),10)&&r?"fr-fil":"fr-fin"),a.show()}a.css("margin",""),a.css("float",""),a.css("display",""),a.removeAttr("data-style")}),void 0===e)for(var o=0;o<this.imageList.length;o++)i.indexOf(this.imageList[o].attr("src"))<0&&this.triggerEvent("afterRemoveImage",[this.imageList[o]],!1);this.imageList=s}},t.Editable.prototype.insertImage=function(){this.options.inlineMode||(this.closeImageMode(),this.imageMode=!1,this.positionPopup("insertImage")),this.selectionInEditor()&&this.saveSelection(),this.showInsertImage(),this.imageMode=!1,this.$image_wrapper.find('input[type="text"]').val("")}}(jQuery),function(t){t.Editable.prototype.showLinkWrapper=function(){this.$link_wrapper&&(this.$link_wrapper.show(),this.$link_wrapper.trigger("hideLinkList"),this.$link_wrapper.trigger("hideLinkClassList"),this.$link_wrapper.find("input.f-lu").removeClass("fr-error"),this.imageMode||!this.options.linkText?this.$link_wrapper.find('input[type="text"].f-lt').parent().addClass("fr-hidden"):this.$link_wrapper.find('input[type="text"].f-lt').parent().removeClass("fr-hidden"),this.imageMode&&this.$link_wrapper.find('input[type="text"].f-lu').removeAttr("disabled"),this.phone()?this.$document.scrollTop(this.$link_wrapper.offset().top+30):setTimeout(t.proxy(function(){this.imageMode&&this.iPad()||this.$link_wrapper.find('input[type="text"].f-lu').focus().select()},this),0),this.link=!0),this.refreshDisabledState()},t.Editable.prototype.hideLinkWrapper=function(){this.$link_wrapper&&(this.$link_wrapper.hide(),this.$link_wrapper.find("input").blur()),this.refreshDisabledState()},t.Editable.prototype.showInsertLink=function(){this.hidePopups(),this.showLinkWrapper()},t.Editable.prototype.updateLinkValues=function(e){var i=e.attr("href")||"http://";this.$link_wrapper.find("input.f-lt").val(e.text()),this.isLink?("#"==i&&(i=""),this.$link_wrapper.find("input#f-lu-"+this._id).val(i.replace(/\&amp;/g,"&")),this.$link_wrapper.find(".f-external-link").attr("href",i||"#")):(this.$link_wrapper.find("input.f-lu").val(i.replace(/\&amp;/g,"&")),this.$link_wrapper.find(".f-external-link").attr("href",i)),this.$link_wrapper.find("input.f-target").prop("checked","_blank"==e.attr("target")),this.$link_wrapper.find("li.f-choose-link-class").each(t.proxy(function(i,s){e.hasClass(t(s).data("class"))&&t(s).click()},this));for(var s in this.options.linkAttributes){var n=e.attr(s);this.$link_wrapper.find("input.fl-"+s).val(n?n:"")}this.$link_wrapper.find("a.f-external-link, button.f-unlink").show()},t.Editable.prototype.initLinkEvents=function(){var e=this,i=function(t){t.stopPropagation(),t.preventDefault()},s=function(i){return i.stopPropagation(),i.preventDefault(),e.isDisabled?!1:""!==e.text()?(e.hide(),!1):(e.link=!0,e.clearSelection(),e.removeMarkers(),e.selectionDisabled||(t(this).before('<span class="f-marker" data-type="true" data-id="0" data-fr-verified="true"></span>'),t(this).after('<span class="f-marker" data-type="false" data-id="0" data-fr-verified="true"></span>'),e.restoreSelectionByMarkers()),e.exec("createLink"),e.updateLinkValues(t(this)),e.showByCoordinates(t(this).offset().left+t(this).outerWidth()/2,t(this).offset().top+(parseInt(t(this).css("padding-top"),10)||0)+t(this).height()),e.showInsertLink(),t(this).hasClass("fr-file")?e.$link_wrapper.find("input.f-lu").attr("disabled","disabled"):e.$link_wrapper.find("input.f-lu").removeAttr("disabled"),void e.closeImageMode())};this.$element.on("mousedown","a",t.proxy(function(t){this.isResizing()||t.stopPropagation()},this)),this.isLink?this.iOS()?(this.$element.on("touchstart",i),this.$element.on("touchend",s)):this.$element.on("click",s):this.iOS()?(this.$element.on("touchstart",'a:not([contenteditable="false"])',i),this.$element.on("touchend",'a:not([contenteditable="false"])',s),this.$element.on("touchstart",'a[contenteditable="false"]',i),this.$element.on("touchend",'a[contenteditable="false"]',i)):(this.$element.on("click",'a:not([contenteditable="false"])',s),this.$element.on("click",'a[contenteditable="false"]',i))},t.Editable.prototype.destroyLink=function(){this.$link_wrapper.html("").removeData().remove()},t.Editable.prototype.initLink=function(){this.buildCreateLink(),this.initLinkEvents(),this.addListener("destroy",this.destroyLink)},t.Editable.initializers.push(t.Editable.prototype.initLink),t.Editable.prototype.removeLink=function(){this.imageMode?("A"==this.$element.find(".f-img-editor").parent().get(0).tagName&&t(this.$element.find(".f-img-editor").get(0)).unwrap(),this.triggerEvent("imageLinkRemoved"),this.showImageEditor(),this.$element.find(".f-img-editor").find("img").click(),this.link=!1):(this.restoreSelection(),this.document.execCommand("unlink",!1,null),this.isLink||this.$element.find("a:empty").remove(),this.triggerEvent("linkRemoved"),this.hideLinkWrapper(),this.$bttn_wrapper.show(),(!this.options.inlineMode||this.isLink)&&this.hide(),this.link=!1)},t.Editable.prototype.writeLink=function(e,i,s,n,o){var a,r=this.options.noFollow;this.options.alwaysBlank&&(n=!0);var l,h="",d="",p="";r===!0&&/^https?:\/\//.test(e)&&(h='rel="nofollow"'),n===!0&&(d='target="_blank"');for(l in o)p+=" "+l+'="'+o[l]+'"';var c=e;if(e=this.sanitizeURL(e),this.options.convertMailAddresses){var f=/^\w+@[a-zA-Z_]+?\.[a-zA-Z]{2,3}$/i;f.test(e)&&0!==e.indexOf("mailto:")&&(e="mailto:"+e)}if(0===e.indexOf("mailto:")||""===this.options.linkAutoPrefix||/^(https?:|ftps?:|)\/\//.test(e)||(e=this.options.linkAutoPrefix+e),""===e)return this.$link_wrapper.find("input.f-lu").addClass("fr-error").focus(),this.triggerEvent("badLink",[c],!1),!1;if(this.$link_wrapper.find("input.f-lu").removeClass("fr-error"),this.imageMode){if("A"!=this.$element.find(".f-img-editor").parent().get(0).tagName)this.$element.find(".f-img-editor").wrap('<a data-fr-link="true" href="'+e+'" '+d+" "+h+p+"></a>");else{var m=this.$element.find(".f-img-editor").parent();n===!0?m.attr("target","_blank"):m.removeAttr("target"),r===!0?m.attr("rel","nofollow"):m.removeAttr("rel");for(l in o)o[l]?m.attr(l,o[l]):m.removeAttr(l);m.removeClass(Object.keys(this.options.linkClasses).join(" ")),m.attr("href",e).addClass(s)}this.triggerEvent("imageLinkInserted",[e]),this.showImageEditor(),this.$element.find(".f-img-editor").find("img").click(),this.link=!1}else{var u=null;this.isLink?""===i&&(i=this.$element.text()):(this.restoreSelection(),a=this.getSelectionLinks(),a.length>0&&(u=a[0].attributes,is_file=t(a[0]).hasClass("fr-file")),this.saveSelectionByMarkers(),this.document.execCommand("unlink",!1,e),this.$element.find('span[data-fr-link="true"]').each(function(e,i){t(i).replaceWith(t(i).html())}),this.restoreSelectionByMarkers()),this.isLink?(this.$element.text(i),a=[this.$element.attr("href",e).get(0)]):(this.removeMarkers(),(this.options.linkText||""===this.text())&&(this.insertHTML('<span class="f-marker" data-fr-verified="true" data-id="0" data-type="true"></span>'+(i||c)+'<span class="f-marker" data-fr-verified="true" data-id="0" data-type="false"></span>'),this.restoreSelectionByMarkers()),this.document.execCommand("createLink",!1,e),a=this.getSelectionLinks());for(var g=0;g<a.length;g++){if(u)for(var v=0;v<u.length;v++)"href"!=u[v].nodeName&&t(a[g]).attr(u[v].nodeName,u[v].value);n===!0?t(a[g]).attr("target","_blank"):t(a[g]).removeAttr("target"),r===!0&&/^https?:\/\//.test(e)?t(a[g]).attr("rel","nofollow"):t(a[g]).removeAttr("rel"),t(a[g]).data("fr-link",!0),t(a[g]).removeClass(Object.keys(this.options.linkClasses).join(" ")),t(a[g]).addClass(s);for(l in o)o[l]?t(a[g]).attr(l,o[l]):t(a[g]).removeAttr(l)}this.$element.find("a:empty").remove(),this.triggerEvent("linkInserted",[e]),this.hideLinkWrapper(),this.$bttn_wrapper.show(),(!this.options.inlineMode||this.isLink)&&this.hide(),this.link=!1}},t.Editable.prototype.createLinkHTML=function(){var t='<div class="froala-popup froala-link-popup" style="display: none;">';t+='<h4><span data-text="true">Insert Link</span><a target="_blank" title="Open Link" class="f-external-link" href="#"><i class="fa fa-external-link"></i></a><i title="Cancel" class="fa fa-times" id="f-link-close-'+this._id+'"></i></h4>',t+='<div class="f-popup-line fr-hidden"><input type="text" placeholder="Text" class="f-lt" id="f-lt-'+this._id+'"></div>';var e="";if(this.options.linkList.length&&(e="f-bi"),t+='<div class="f-popup-line"><input type="text" placeholder="http://taihuoniao.com" class="f-lu '+e+'" id="f-lu-'+this._id+'"/>',this.options.linkList.length){t+='<button class="fr-p-bttn f-browse-links" id="f-browse-links-'+this._id+'"><i class="fa fa-chevron-down"></i></button>',t+='<ul id="f-link-list-'+this._id+'">';for(var i=0;i<this.options.linkList.length;i++){var s=this.options.linkList[i],n="";for(var o in s)n+=" data-"+o+'="'+s[o]+'"';t+='<li class="f-choose-link"'+n+">"+s.body+"</li>"}t+="</ul>"}if(t+="</div>",Object.keys(this.options.linkClasses).length){t+='<div class="f-popup-line"><input type="text" placeholder="Choose link type" class="f-bi" id="f-luc-'+this._id+'" disabled="disabled"/>',t+='<button class="fr-p-bttn f-browse-links" id="f-links-class-'+this._id+'"><i class="fa fa-chevron-down"></i></button>',t+='<ul id="f-link-class-list-'+this._id+'">';for(var a in this.options.linkClasses){var r=this.options.linkClasses[a];t+='<li class="f-choose-link-class" data-class="'+a+'">'+r+"</li>"}t+="</ul>",t+="</div>"}for(var l in this.options.linkAttributes){var h=this.options.linkAttributes[l];t+='<div class="f-popup-line"><input class="fl-'+l+'" type="text" placeholder="'+h+'" id="fl-'+l+"-"+this._id+'"/></div>'}return t+='<div class="f-popup-line"><input type="checkbox" class="f-target" id="f-target-'+this._id+'"> <label data-text="true" for="f-target-'+this._id+'">Open in new tab</label><button data-text="true" type="button" class="fr-p-bttn f-ok f-submit" id="f-ok-'+this._id+'">OK</button>',this.options.unlinkButton&&(t+='<button type="button" data-text="true" class="fr-p-bttn f-ok f-unlink" id="f-unlink-'+this._id+'">UNLINK</button>'),t+="</div></div>"},t.Editable.prototype.buildCreateLink=function(){this.$link_wrapper=t(this.createLinkHTML()),this.$popup_editor.append(this.$link_wrapper);var e=this;this.addListener("hidePopups",this.hideLinkWrapper),this.$link_wrapper.on("mouseup touchend",t.proxy(function(t){this.isResizing()||(t.stopPropagation(),this.$link_wrapper.trigger("hideLinkList"))},this)),this.$link_wrapper.on("click",function(t){t.stopPropagation()}),this.$link_wrapper.on("click","*",function(t){t.stopPropagation()}),this.options.linkText&&this.$link_wrapper.on("mouseup keydown","input#f-lt-"+this._id,t.proxy(function(t){var e=t.which;e&&27===e||t.stopPropagation(),this.$link_wrapper.trigger("hideLinkList"),this.$link_wrapper.trigger("hideLinkClassList")},this)),this.$link_wrapper.on("mouseup keydown touchend touchstart","input#f-lu-"+this._id,t.proxy(function(t){var e=t.which;e&&27===e||t.stopPropagation(),this.$link_wrapper.trigger("hideLinkList"),this.$link_wrapper.trigger("hideLinkClassList")},this)),this.$link_wrapper.on("click keydown","input#f-target-"+this._id,function(t){var e=t.which;e&&27===e||t.stopPropagation()}),this.$link_wrapper.on("touchend","button#f-ok-"+this._id,function(t){t.stopPropagation()}).on("click","button#f-ok-"+this._id,t.proxy(function(){var t,e=this.$link_wrapper.find("input#f-lt-"+this._id),i=this.$link_wrapper.find("input#f-lu-"+this._id),s=this.$link_wrapper.find("input#f-luc-"+this._id),n=this.$link_wrapper.find("input#f-target-"+this._id);t=e?e.val():"";var o=i.val();this.isLink&&""===o&&(o="#");var a="";s&&(a=s.data("class"));var r={};for(var l in this.options.linkAttributes)r[l]=this.$link_wrapper.find("input#fl-"+l+"-"+this._id).val();this.writeLink(o,t,a,n.prop("checked"),r)},this)),this.$link_wrapper.on("click touch","button#f-unlink-"+this._id,t.proxy(function(){this.link=!0,this.removeLink()},this)),this.options.linkList.length&&(this.$link_wrapper.on("click touch","li.f-choose-link",function(){e.resetLinkValues();var i=e.$link_wrapper.find("button#f-browse-links-"+e._id),s=e.$link_wrapper.find("input#f-lt-"+e._id),n=e.$link_wrapper.find("input#f-lu-"+e._id),o=e.$link_wrapper.find("input#f-target-"+e._id);s&&s.val(t(this).data("body")),n.val(t(this).data("href")),o.prop("checked",t(this).data("blank"));for(var a in e.options.linkAttributes)t(this).data(a)&&e.$link_wrapper.find("input#fl-"+a+"-"+e._id).val(t(this).data(a));i.click()}).on("mouseup","li.f-choose-link",function(t){t.stopPropagation()}),this.$link_wrapper.on("click","button#f-browse-links-"+this._id+", button#f-browse-links-"+this._id+" > i",function(i){i.stopPropagation();var s=e.$link_wrapper.find("ul#f-link-list-"+e._id);e.$link_wrapper.trigger("hideLinkClassList"),t(this).find("i").toggleClass("fa-chevron-down"),t(this).find("i").toggleClass("fa-chevron-up"),s.toggle()}).on("mouseup","button#f-browse-links-"+this._id+", button#f-browse-links-"+this._id+" > i",function(t){t.stopPropagation()}),this.$link_wrapper.bind("hideLinkList",function(){var t=e.$link_wrapper.find("ul#f-link-list-"+e._id),i=e.$link_wrapper.find("button#f-browse-links-"+e._id);t&&t.is(":visible")&&i.click()})),Object.keys(this.options.linkClasses).length&&(this.$link_wrapper.on("mouseup keydown","input#f-luc-"+this._id,t.proxy(function(t){var e=t.which;e&&27===e||t.stopPropagation(),this.$link_wrapper.trigger("hideLinkList"),this.$link_wrapper.trigger("hideLinkClassList")},this)),this.$link_wrapper.on("click touch","li.f-choose-link-class",function(){var i=e.$link_wrapper.find("input#f-luc-"+e._id);i.val(t(this).text()),i.data("class",t(this).data("class")),e.$link_wrapper.trigger("hideLinkClassList")}).on("mouseup","li.f-choose-link-class",function(t){t.stopPropagation()}),this.$link_wrapper.on("click","button#f-links-class-"+this._id,function(i){i.stopPropagation(),e.$link_wrapper.trigger("hideLinkList");var s=e.$link_wrapper.find("ul#f-link-class-list-"+e._id);t(this).find("i").toggleClass("fa-chevron-down"),t(this).find("i").toggleClass("fa-chevron-up"),s.toggle()}).on("mouseup","button#f-links-class-"+this._id,function(t){t.stopPropagation()}),this.$link_wrapper.bind("hideLinkClassList",function(){var t=e.$link_wrapper.find("ul#f-link-class-list-"+e._id),i=e.$link_wrapper.find("button#f-links-class-"+e._id);t&&t.is(":visible")&&i.click()})),this.$link_wrapper.on(this.mouseup,"i#f-link-close-"+this._id,t.proxy(function(){this.$bttn_wrapper.show(),this.hideLinkWrapper(),(!this.options.inlineMode&&!this.imageMode||this.isLink||0===this.options.buttons.length)&&this.hide(),this.imageMode?this.showImageEditor():(this.restoreSelection(),this.focus())},this))},t.Editable.prototype.getSelectionLinks=function(){var t,e,i,s,n=[];if(window.getSelection){var o=window.getSelection();if(o.getRangeAt&&o.rangeCount){s=this.document.createRange();for(var a=0;a<o.rangeCount;++a)if(t=o.getRangeAt(a),e=t.commonAncestorContainer,e&&1!=e.nodeType&&(e=e.parentNode),e&&"a"==e.nodeName.toLowerCase())n.push(e);else{i=e.getElementsByTagName("a");for(var r=0;r<i.length;++r)s.selectNodeContents(i[r]),s.compareBoundaryPoints(t.END_TO_START,t)<1&&s.compareBoundaryPoints(t.START_TO_END,t)>-1&&n.push(i[r])}}}else if(this.document.selection&&"Control"!=this.document.selection.type)if(t=this.document.selection.createRange(),e=t.parentElement(),"a"==e.nodeName.toLowerCase())n.push(e);else{i=e.getElementsByTagName("a"),s=this.document.body.createTextRange();for(var l=0;l<i.length;++l)s.moveToElementText(i[l]),s.compareEndPoints("StartToEnd",t)>-1&&s.compareEndPoints("EndToStart",t)<1&&n.push(i[l])}return n},t.Editable.prototype.resetLinkValues=function(){this.$link_wrapper.find("input").val(""),this.$link_wrapper.find('input[type="checkbox"].f-target').prop("checked",this.options.alwaysBlank),this.$link_wrapper.find('input[type="text"].f-lt').val(this.text()),this.$link_wrapper.find('input[type="text"].f-lu').val("http://"),this.$link_wrapper.find('input[type="text"].f-lu').removeAttr("disabled"),this.$link_wrapper.find("a.f-external-link, button.f-unlink").hide();for(var t in this.options.linkAttributes)this.$link_wrapper.find('input[type="text"].fl-'+t).val("")},t.Editable.prototype.insertLink=function(){this.options.inlineMode||(this.closeImageMode(),this.imageMode=!1,this.positionPopup("createLink")),this.selectionInEditor()&&this.saveSelection(),this.showInsertLink();var e=this.getSelectionLinks();e.length>0?this.updateLinkValues(t(e[0])):this.resetLinkValues()}}(jQuery),function(t){t.Editable.prototype.browserFixes=function(){this.backspaceEmpty(),this.backspaceInEmptyBlock(),this.fixHR(),this.domInsert(),this.fixIME(),this.cleanInvisibleSpace(),this.cleanBR(),this.insertSpace()},t.Editable.prototype.backspaceInEmptyBlock=function(){this.$element.on("keyup",t.proxy(function(e){var i=e.which;if(this.browser.mozilla&&!this.isHTML&&8==i){var s=t(this.getSelectionElement());this.valid_nodes.indexOf(s.get(0).tagName)>=0&&1==s.find("*").length&&""===s.text()&&1==s.find("br").length&&this.setSelection(s.get(0))}},this))},t.Editable.prototype.insertSpace=function(){this.browser.mozilla&&this.$element.on("keypress",t.proxy(function(t){var e=t.which,i=this.getSelectionElements()[0];this.isHTML||32!=e||"PRE"==i.tagName||(t.preventDefault(),this.insertSimpleHTML("&nbsp;"))},this))},t.Editable.prototype.cleanBR=function(){this.$element.on("keyup",t.proxy(function(){this.$element.find(this.valid_nodes.join(",")).each(t.proxy(function(e,i){if(["TH","TD","LI"].indexOf(i.tagName)>=0)return!0;var s=i.childNodes,n=null;if(!s.length||"BR"!=s[s.length-1].tagName)return!0;n=s[s.length-1];var o=n.previousSibling;o&&"BR"!=o.tagName&&t(n).parent().text().length>0&&this.valid_nodes.indexOf(o.tagName)<0&&t(n).remove()},this))},this))},t.Editable.prototype.replaceU200B=function(e){for(var i=0;i<e.length;i++)3==e[i].nodeType&&/\u200B/gi.test(e[i].textContent)?e[i].textContent=e[i].textContent.replace(/\u200B/gi,""):1==e[i].nodeType&&this.replaceU200B(t(e[i]).contents());

},t.Editable.prototype.cleanInvisibleSpace=function(){var e=function(e){var i=t(e).text();return e&&/\u200B/.test(t(e).text())&&i.replace(/\u200B/gi,"").length>0?!0:!1};this.$element.on("keyup",t.proxy(function(){var i=this.getSelectionElement();e(i)&&0===t(i).find("li").length&&(this.saveSelectionByMarkers(),this.replaceU200B(t(i).contents()),this.restoreSelectionByMarkers())},this))},t.Editable.prototype.fixHR=function(){this.$element.on("keypress",t.proxy(function(e){var i=t(this.getSelectionElement());if(i.is("hr")||i.parents("hr").length)return!1;var s=e.which;if(8==s){var n=t(this.getSelectionElements()[0]);n.prev().is("hr")&&this.getSelectionTextInfo(n.get(0)).atStart&&(this.saveSelectionByMarkers(),n.prev().remove(),this.restoreSelectionByMarkers(),e.preventDefault())}},this))},t.Editable.prototype.backspaceEmpty=function(){this.$element.on("keydown",t.proxy(function(t){var e=t.which;!this.isHTML&&8==e&&this.$element.hasClass("f-placeholder")&&t.preventDefault()},this))},t.Editable.prototype.domInsert=function(){this.$element.on("keydown",t.proxy(function(t){var e=t.which;13===e&&(this.add_br=!0)},this)),this.$element.on("DOMNodeInserted",t.proxy(function(e){if("SPAN"!==e.target.tagName||t(e.target).attr("data-fr-verified")||this.no_verify||this.textEmpty(e.target)||t(e.target).replaceWith(t(e.target).contents()),"BR"===e.target.tagName&&setTimeout(function(){t(e.target).removeAttr("type")},0),"A"===e.target.tagName&&setTimeout(function(){t(e.target).removeAttr("_moz_dirty")},0),this.options.paragraphy&&this.add_br&&"BR"===e.target.tagName&&(t(e.target).prev().length&&"TABLE"===t(e.target).prev().get(0).tagName||t(e.target).next().length&&"TABLE"===t(e.target).next().get(0).tagName)){t(e.target).wrap('<p class="fr-p-wrap">');var i=this.$element.find("p.fr-p-wrap").removeAttr("class");this.setSelection(i.get(0))}"BR"===e.target.tagName&&this.isLastSibling(e.target)&&"LI"==e.target.parentNode.tagName&&this.textEmpty(e.target.parentNode)&&t(e.target).remove()},this)),this.$element.on("keyup",t.proxy(function(t){var e=t.which;8===e&&this.$element.find("span:not([data-fr-verified])").attr("data-fr-verified",!0),13===e&&(this.add_br=!1)},this))},t.Editable.prototype.fixIME=function(){try{this.$element.get(0).msGetInputContext&&(this.$element.get(0).msGetInputContext().addEventListener("MSCandidateWindowShow",t.proxy(function(){this.ime=!0},this)),this.$element.get(0).msGetInputContext().addEventListener("MSCandidateWindowHide",t.proxy(function(){this.ime=!1,this.$element.trigger("keydown"),this.oldHTML=""},this)))}catch(e){}}}(jQuery),function(t){t.Editable.prototype.handleEnter=function(){var e=t.proxy(function(){var e=this.getSelectionElement();return"LI"==e.tagName||this.parents(t(e),"li").length>0?!0:!1},this);this.$element.on("keypress",t.proxy(function(t){if(!this.isHTML&&!e()){var i=t.which;if(13==i&&!t.shiftKey){t.preventDefault(),this.saveUndoStep(),this.insertSimpleHTML("<break></break>");var s=this.getSelectionElements();if(s[0]==this.$element.get(0)?this.enterInMainElement(s[0]):this.enterInElement(s[0]),this.getSelectionTextInfo(this.$element.get(0)).atEnd)this.$wrapper.scrollTop(this.$element.height());else{var n=this.getBoundingRect();this.$wrapper.offset().top+this.$wrapper.height()<n.top+n.height&&this.$wrapper.scrollTop(n.top+this.$wrapper.scrollTop()-(this.$wrapper.height()+this.$wrapper.offset().top)+n.height+10)}}}},this))},t.Editable.prototype.enterInMainElement=function(e){var i=t(e).find("break").get(0);if(t(i).parent().get(0)==e)this.isLastSibling(i)?this.insertSimpleHTML("</br>"+this.markers_html+this.br):t(e).hasClass("f-placeholder")?t(e).html("</br>"+this.markers_html+this.br):this.insertSimpleHTML("</br>"+this.markers_html),t(e).find("break").remove(),this.restoreSelectionByMarkers();else if(t(i).parents(this.$element).length){for(e=this.getSelectionElement();"BREAK"==e.tagName||0===t(e).text().length&&e.parentNode!=this.$element.get(0);)e=e.parentNode;if(this.getSelectionTextInfo(e).atEnd)t(e).after(this.breakEnd(this.getDeepParent(e),!0)),this.$element.find("break").remove(),this.restoreSelectionByMarkers();else if(this.getSelectionTextInfo(e).atStart){for(;i.parentNode!=this.$element.get(0);)i=i.parentNode;t(i).before("<br/>"),this.$element.find("break").remove(),this.$element.find("a:empty").replaceWith(this.markers_html+"<br/>"),this.restoreSelectionByMarkers()}else this.breakMiddle(this.getDeepParent(e),!0),this.restoreSelectionByMarkers()}else t(i).remove()},t.Editable.prototype.enterInElement=function(e){if(["TD","TH"].indexOf(e.tagName)<0){var i=!1;if(this.emptyElement(e)&&e.parentNode&&"BLOCKQUOTE"==e.parentNode.tagName){t(e).before(this.$element.find("break"));var s=e;e=e.parentNode,t(s).remove(),i=!0}this.getSelectionTextInfo(e).atEnd?(t(e).after(this.breakEnd(e),!1),this.$element.find("break").remove(),this.restoreSelectionByMarkers()):this.getSelectionTextInfo(e).atStart?(this.options.paragraphy?i?(t(e).before("<"+this.options.defaultTag+">"+this.markers_html+this.br+"</"+this.options.defaultTag+">"),this.restoreSelectionByMarkers()):t(e).before("<"+this.options.defaultTag+">"+this.br+"</"+this.options.defaultTag+">"):i?(t(e).before(this.markers_html+"<br/>"),this.restoreSelectionByMarkers()):t(e).before("<br/>"),this.$element.find("break").remove()):"PRE"==e.tagName?(this.$element.find("break").after("<br/>"+this.markers_html),this.$element.find("break").remove(),this.restoreSelectionByMarkers()):(this.breakMiddle(e,!1,i),this.restoreSelectionByMarkers())}else this.enterInMainElement(e)},t.Editable.prototype.breakEnd=function(e,i){if(void 0===i&&(i=!1),"BLOCKQUOTE"==e.tagName){var s=t(e).contents();s.length&&"BR"==s[s.length-1].tagName&&t(s[s.length-1]).remove()}var n=t(e).find("break").get(0),o=this.br;this.options.paragraphy||(o="<br/>");var a=this.markers_html+o;for(i&&(a=this.markers_html+t.Editable.INVISIBLE_SPACE);n!=e;)"A"!=n.tagName&&"BREAK"!=n.tagName&&(a="<"+n.tagName+this.attrs(n)+">"+a+"</"+n.tagName+">"),n=n.parentNode;return i&&"A"!=n.tagName&&"BREAK"!=n.tagName&&(a="<"+n.tagName+this.attrs(n)+">"+a+"</"+n.tagName+">"),this.options.paragraphy&&(a="<"+this.options.defaultTag+">"+a+"</"+this.options.defaultTag+">"),i&&(a=o+a),a},t.Editable.prototype.breakMiddle=function(e,i,s){void 0===i&&(i=!1),void 0===s&&(s=!1);var n=t(e).find("break").get(0),o=this.markers_html;s&&(o="");for(var a="";n!=e;)n=n.parentNode,a=a+"</"+n.tagName+">",o="<"+n.tagName+this.attrs(n)+">"+o;var r="";s&&(r=this.options.paragraphy?"<"+this.options.defaultTag+">"+this.markers_html+"<br/></"+this.options.defaultTag+">":this.markers_html+"<br/>");var l="<"+e.tagName+this.attrs(e)+">"+t(e).html()+"</"+e.tagName+">";l=l.replace(/<break><\/break>/,a+(i?this.br:"")+r+o),t(e).replaceWith(l)}}(jQuery),function(t){t.Editable.prototype.isFirstSibling=function(t){var e=t.previousSibling;return e?3==e.nodeType&&""===e.textContent?this.isFirstSibling(e):!1:!0},t.Editable.prototype.isLastSibling=function(t){var e=t.nextSibling;return e?3==e.nodeType&&""===e.textContent?this.isLastSibling(e):!1:!0},t.Editable.prototype.getDeepParent=function(t){return t.parentNode==this.$element.get(0)?t:this.getDeepParent(t.parentNode)},t.Editable.prototype.attrs=function(t){for(var e="",i=t.attributes,s=0;s<i.length;s++){var n=i[s];e+=" "+n.nodeName+'="'+n.value+'"'}return e}}(jQuery),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t,e){function i(t){function e(t){s?(i(),O(e),n=!0,s=!1):n=!1}var i=t,s=!1,n=!1;this.kick=function(t){s=!0,n||e()},this.end=function(t){var e=i;t&&(n?(i=s?function(){e(),t()}:t,s=!0):t())}}function s(){return!0}function n(){return!1}function o(t){t.preventDefault()}function a(t){H[t.target.tagName.toLowerCase()]||t.preventDefault()}function r(t){return 1===t.which&&!t.ctrlKey&&!t.altKey}function l(t,e){var i,s;if(t.identifiedTouch)return t.identifiedTouch(e);for(i=-1,s=t.length;++i<s;)if(t[i].identifier===e)return t[i]}function h(t,e){var i=l(t.changedTouches,e.identifier);if(i&&(i.pageX!==e.pageX||i.pageY!==e.pageY))return i}function d(t){var e;r(t)&&(e={target:t.target,startX:t.pageX,startY:t.pageY,timeStamp:t.timeStamp},B(document,U.move,p,e),B(document,U.cancel,c,e))}function p(t){var e=t.data;b(t,e,t,f)}function c(t){f()}function f(){A(document,U.move,p),A(document,U.cancel,c)}function m(t){var e,i;H[t.target.tagName.toLowerCase()]||(e=t.changedTouches[0],i={target:e.target,startX:e.pageX,startY:e.pageY,timeStamp:t.timeStamp,identifier:e.identifier},B(document,j.move+"."+e.identifier,u,i),B(document,j.cancel+"."+e.identifier,g,i))}function u(t){var e=t.data,i=h(t,e);i&&b(t,e,i,v)}function g(t){var e=t.data,i=l(t.changedTouches,e.identifier);i&&v(e.identifier)}function v(t){A(document,"."+t,u),A(document,"."+t,g)}function b(t,e,i,s){var n=i.pageX-e.startX,o=i.pageY-e.startY;R*R>n*n+o*o||$(t,e,i,n,o,s)}function y(){return this._handled=s,!1}function w(t){try{t._handled()}catch(e){return!1}}function $(t,e,i,s,n,o){{var a,r;e.target}a=t.targetTouches,r=t.timeStamp-e.timeStamp,e.type="movestart",e.distX=s,e.distY=n,e.deltaX=s,e.deltaY=n,e.pageX=i.pageX,e.pageY=i.pageY,e.velocityX=s/r,e.velocityY=n/r,e.targetTouches=a,e.finger=a?a.length:1,e._handled=y,e._preventTouchmoveDefault=function(){t.preventDefault()},P(e.target,e),o(e.identifier)}function k(t){var e=t.data.timer;t.data.touch=t,t.data.timeStamp=t.timeStamp,e.kick()}function x(t){var e=t.data.event,i=t.data.timer;E(),C(e,i,function(){setTimeout(function(){A(e.target,"click",n)},0)})}function E(t){A(document,U.move,k),A(document,U.end,x)}function T(t){var e=t.data.event,i=t.data.timer,s=h(t,e);s&&(t.preventDefault(),e.targetTouches=t.targetTouches,t.data.touch=s,t.data.timeStamp=t.timeStamp,i.kick())}function _(t){var e=t.data.event,i=t.data.timer,s=l(t.changedTouches,e.identifier);s&&(S(e),C(e,i))}function S(t){A(document,"."+t.identifier,T),A(document,"."+t.identifier,_)}function I(t,e,i,s){var n=i-t.timeStamp;t.type="move",t.distX=e.pageX-t.startX,t.distY=e.pageY-t.startY,t.deltaX=e.pageX-t.pageX,t.deltaY=e.pageY-t.pageY,t.velocityX=.3*t.velocityX+.7*t.deltaX/n,t.velocityY=.3*t.velocityY+.7*t.deltaY/n,t.pageX=e.pageX,t.pageY=e.pageY}function C(t,e,i){e.end(function(){return t.type="moveend",P(t.target,t),i&&i()})}function L(t,e,i){return B(this,"movestart.move",w),!0}function M(t){return A(this,"dragstart drag",o),A(this,"mousedown touchstart",a),A(this,"movestart",w),!0}function N(t){"move"!==t.namespace&&"moveend"!==t.namespace&&(B(this,"dragstart."+t.guid+" drag."+t.guid,o,e,t.selector),B(this,"mousedown."+t.guid,a,e,t.selector))}function D(t){"move"!==t.namespace&&"moveend"!==t.namespace&&(A(this,"dragstart."+t.guid+" drag."+t.guid),A(this,"mousedown."+t.guid))}var R=6,B=t.event.add,A=t.event.remove,P=function(e,i,s){t.event.trigger(i,s,e)},O=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){return window.setTimeout(function(){t()},25)}}(),H={textarea:!0,input:!0,select:!0,button:!0},U={move:"mousemove",cancel:"mouseup dragstart",end:"mouseup"},j={move:"touchmove",cancel:"touchend",end:"touchend"};t.event.special.movestart={setup:L,teardown:M,add:N,remove:D,_default:function(t){function s(e){I(o,a.touch,a.timeStamp),P(t.target,o)}var o,a;t._handled()&&(o={target:t.target,startX:t.startX,startY:t.startY,pageX:t.pageX,pageY:t.pageY,distX:t.distX,distY:t.distY,deltaX:t.deltaX,deltaY:t.deltaY,velocityX:t.velocityX,velocityY:t.velocityY,timeStamp:t.timeStamp,identifier:t.identifier,targetTouches:t.targetTouches,finger:t.finger},a={event:o,timer:new i(s),touch:e,timeStamp:e},t.identifier===e?(B(t.target,"click",n),B(document,U.move,k,a),B(document,U.end,x,a)):(t._preventTouchmoveDefault(),B(document,j.move+"."+t.identifier,T,a),B(document,j.end+"."+t.identifier,_,a)))}},t.event.special.move={setup:function(){B(this,"movestart.move",t.noop)},teardown:function(){A(this,"movestart.move",t.noop)}},t.event.special.moveend={setup:function(){B(this,"movestart.moveend",t.noop)},teardown:function(){A(this,"movestart.moveend",t.noop)}},B(document,"mousedown.move",d),B(document,"touchstart.move",m),"function"==typeof Array.prototype.indexOf&&!function(t,e){for(var i=["changedTouches","targetTouches"],s=i.length;s--;)-1===t.event.props.indexOf(i[s])&&t.event.props.push(i[s])}(t)}),window.WYSIWYGModernizr=function(t,e,i){function s(t){f.cssText=t}function n(t,e){return typeof t===e}var o,a,r,l="2.7.1",h={},d=e.documentElement,p="modernizr",c=e.createElement(p),f=c.style,m=({}.toString," -webkit- -moz- -o- -ms- ".split(" ")),u={},g=[],v=g.slice,b=function(t,i,s,n){var o,a,r,l,h=e.createElement("div"),c=e.body,f=c||e.createElement("body");if(parseInt(s,10))for(;s--;)r=e.createElement("div"),r.id=n?n[s]:p+(s+1),h.appendChild(r);return o=["&#173;",'<style id="s',p,'">',t,"</style>"].join(""),h.id=p,(c?h:f).innerHTML+=o,f.appendChild(h),c||(f.style.background="",f.style.overflow="hidden",l=d.style.overflow,d.style.overflow="hidden",d.appendChild(f)),a=i(h,t),c?h.parentNode.removeChild(h):(f.parentNode.removeChild(f),d.style.overflow=l),!!a},y=function(e){var i=t.matchMedia||t.msMatchMedia;if(i)return i(e).matches;var s;return b("@media "+e+" { #"+p+" { position: absolute; } }",function(e){s="absolute"==(t.getComputedStyle?getComputedStyle(e,null):e.currentStyle).position}),s},w={}.hasOwnProperty;r=n(w,"undefined")||n(w.call,"undefined")?function(t,e){return e in t&&n(t.constructor.prototype[e],"undefined")}:function(t,e){return w.call(t,e)},Function.prototype.bind||(Function.prototype.bind=function(t){var e=this;if("function"!=typeof e)throw new TypeError;var i=v.call(arguments,1),s=function(){if(this instanceof s){var n=function(){};n.prototype=e.prototype;var o=new n,a=e.apply(o,i.concat(v.call(arguments)));return Object(a)===a?a:o}return e.apply(t,i.concat(v.call(arguments)))};return s}),u.touch=function(){var i;return"ontouchstart"in t||t.DocumentTouch&&e instanceof DocumentTouch?i=!0:b(["@media (",m.join("touch-enabled),("),p,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(t){i=9===t.offsetTop}),i};for(var $ in u)r(u,$)&&(a=$.toLowerCase(),h[a]=u[$](),g.push((h[a]?"":"no-")+a));return h.addTest=function(t,e){if("object"==typeof t)for(var s in t)r(t,s)&&h.addTest(s,t[s]);else{if(t=t.toLowerCase(),h[t]!==i)return h;e="function"==typeof e?e():e,"undefined"!=typeof enableClasses&&enableClasses&&(d.className+=" "+(e?"":"no-")+t),h[t]=e}return h},s(""),c=o=null,h._version=l,h._prefixes=m,h.mq=y,h.testStyles=b,h}(this,this.document),function(t){t.Editable.DEFAULTS=t.extend(t.Editable.DEFAULTS,{allowedBlankTags:["TEXTAREA"],selfClosingTags:["br","input","img","hr","param","!--","source","embed","!","meta","link","base"],doNotJoinTags:["a"],iconClasses:["fa-"]}),t.Editable.prototype.isClosingTag=function(t){return t?null!==t.match(/^<\/([a-zA-Z0-9]+)([^<]+)*>$/gi):!1},t.Editable.prototype.tagName=function(t){return t.replace(/^<\/?([a-zA-Z0-9-!]+)([^>]+)*>$/gi,"$1").toLowerCase()},t.Editable.SELF_CLOSING_AFTER=["source"],t.Editable.prototype.isSelfClosingTag=function(t){var e=this.tagName(t);return this.options.selfClosingTags.indexOf(e.toLowerCase())>=0},t.Editable.prototype.tagKey=function(t){return t.type+(t.attrs||[]).sort().join("|")},t.Editable.prototype.extendedKey=function(t){return this.tagKey(t)+JSON.stringify(t.style)},t.Editable.prototype.mapDOM=function(e){var i=[],s={},n={},o=0,a=this;t(e).find(".f-marker").html(t.Editable.INVISIBLE_SPACE);var r=function(e,i){if(3===e.nodeType)return[];if(8===e.nodeType)return[{comment:!0,attrs:{},styles:{},idx:o++,sp:i,ep:i,text:e.textContent}];var s=e.tagName;"B"==s&&(s="STRONG"),"I"!=s||e.className&&null!=e.className.match(new RegExp(a.options.iconClasses.join("|"),"gi"))||(s="EM"),e.style.display="";var n={},r={},l=null;if(e.attributes)for(var h=0;h<e.attributes.length;h++){var d=e.attributes[h];"style"==d.nodeName?l=d.value:n[d.nodeName]=d.value}if(l){var p=l.match(/([^:]*):([^:;]*(;|$))/gi);if(p)for(var c=0;c<p.length;c++){var f=p[c].split(":"),m=f.slice(1).join(":").trim();";"==m[m.length-1]&&(m=m.substr(0,m.length-1)),r[f[0].trim()]=m}}var u=[];if(t.isEmptyObject(n)&&"SPAN"==e.tagName&&!t.isEmptyObject(r)){for(var g in r){var v={};v[g]=r[g],u.push({selfClosing:!1,attrs:n,styles:v,idx:o++,sp:i,ep:i+e.textContent.length,tagName:s,noJoin:e.nextSibling&&"BR"===e.nextSibling.tagName})}return u}return[{selfClosing:a.options.selfClosingTags.indexOf(s.toLowerCase())>=0,attrs:n,styles:r,idx:o++,sp:i,ep:i+e.textContent.length,tagName:s,noJoin:e.nextSibling&&"BR"===e.nextSibling.tagName}]},l=function(t,a){var h,d,p;if(t!=e)for(d=r(t,a),h=0;h<d.length;h++)p=d[h],i.push(p),s[p.sp]||(s[p.sp]={}),n[p.ep]||(n[p.ep]={}),s[p.sp][p.tagName]||(s[p.sp][p.tagName]=[]),n[p.ep][p.tagName]||(n[p.ep][p.tagName]=[]),s[p.sp][p.tagName].push(p),n[p.ep][p.tagName].push(p);var c=t.childNodes;if(c){for(h=0;h<c.length;h++)h>0&&8!=c[h-1].nodeType&&(a+=c[h-1].textContent.length),l(c[h],a);if(d)for(h=0;h<d.length;h++)p=d[h],p.ci=o++,s[p.ep]||(s[p.ep]={}),s[p.ep][p.tagName]||(s[p.ep][p.tagName]=[]),s[p.ep][p.tagName].push({shadow:!0,ci:o-1})}},h=function(){var e,n,o,r;for(e in s)for(var l in s[e])for(o=0;o<s[e][l].length;o++)if(n=s[e][l][o],!n.selfClosing&&!(n.dirty||n.shadow||n.comment||n.noJoin))for(var h=o+1;h<s[e][l].length;h++)if(r=s[e][l][h],!r.selfClosing&&!(r.dirty||r.shadow||r.comment||r.noJoin||1!=Object.keys(n.styles).length||1!=Object.keys(r.styles).length||r.sp==r.ep)){var d=Object.keys(n.styles)[0];if(r.styles[d]){n.sp=r.ep;for(var p=0;p<s[n.sp][n.tagName].length;p++){var c=s[n.sp][n.tagName][p];if(c.shadow&&c.ci==r.ci){s[n.sp][n.tagName].splice(p,0,n);break}}s[e][l].splice(o,1),o--;break}}for(e=0;e<i.length;e++)if(n=i[e],!(n.dirty||n.selfClosing||n.comment||n.noJoin||n.shadow||a.options.doNotJoinTags.indexOf(n.tagName.toLowerCase())>=0||!t.isEmptyObject(n.attrs)))if(n.sp==n.ep&&t.isEmptyObject(n.attrs)&&t.isEmptyObject(n.styles)&&a.options.allowedBlankTags.indexOf(n.tagName)<0)n.dirty=!0;else if(s[n.ep]&&s[n.ep][n.tagName])for(o=0;o<s[n.ep][n.tagName].length;o++)if(r=s[n.ep][n.tagName][o],n!=r&&!(r.dirty||r.selfClosing||r.shadow||r.comment||r.noJoin||!t.isEmptyObject(r.attrs)||JSON.stringify(r.styles)!=JSON.stringify(n.styles))){n.ep<r.ep&&(n.ep=r.ep),n.sp>r.sp&&(n.sp=r.sp),r.dirty=!0,e--;break}for(e=0;e<i.length;e++)if(n=i[e],!(n.dirty||n.selfClosing||n.comment||n.noJoin||n.shadow||!t.isEmptyObject(n.attrs)))if(n.sp==n.ep&&t.isEmptyObject(n.attrs)&&t.isEmptyObject(n.style)&&a.options.allowedBlankTags.indexOf(n.tagName)<0)n.dirty=!0;else if(s[n.sp]&&s[n.sp][n.tagName])for(o=s[n.sp][n.tagName].length-1;o>=0;o--)r=s[n.sp][n.tagName][o],n!=r&&(r.dirty||r.selfClosing||r.shadow||r.comment||r.noJoin||n.ep==r.ep&&t.isEmptyObject(r.attrs)&&(n.styles=t.extend(n.styles,r.styles),r.dirty=!0))};l(e,0),h();for(var d=i.length-1;d>=0;d--)i.dirty&&i.splice(d,1);return i},t.Editable.prototype.sortNodes=function(t,e){if(t.comment)return 1;if(t.selfClosing||e.selfClosing)return t.idx-e.idx;var i=t.ep-t.sp,s=e.ep-e.sp;return 0===i&&0===s?t.idx-e.idx:i===s?e.ci-t.ci:s-i},t.Editable.prototype.openTag=function(t){var e,i="<"+t.tagName.toLowerCase(),s=Object.keys(t.attrs).sort();for(e=0;e<s.length;e++){var n=s[e];i+=" "+n+'="'+t.attrs[n]+'"'}var o="",a=Object.keys(t.styles).sort();for(e=0;e<a.length;e++){var r=a[e];null!=t.styles[r]&&(o+=r.replace("_","-")+": "+t.styles[r]+"; ")}return""!==o&&(i+=' style="'+o.trim()+'"'),i+=">"},t.Editable.prototype.commentTag=function(t){var e="";if(t.selfClosing){var i;e="<"+t.tagName.toLowerCase();var s=Object.keys(t.attrs).sort();for(i=0;i<s.length;i++){var n=s[i];e+=" "+n+'="'+t.attrs[n]+'"'}var o="",a=Object.keys(t.styles).sort();for(i=0;i<a.length;i++){var r=a[i];null!=t.styles[r]&&(o+=r.replace("_","-")+": "+t.styles[r]+"; ")}""!==o&&(e+=' style="'+o.trim()+'"'),e+="/>"}else t.comment&&(e="<!--"+t.text+"-->");return e},t.Editable.prototype.closeTag=function(t){return"</"+t.tagName.toLowerCase()+">"},t.Editable.prototype.nodesOpenedAt=function(t,e){for(var i=[],s=t.length-1;s>=0&&t[s].sp==e;)i.push(t.pop()),s--;return i},t.Editable.prototype.entity=function(t){return ch_map={">":"&gt;","<":"&lt;","&":"&amp;"},ch_map[t]?ch_map[t]:t},t.Editable.prototype.removeInvisibleWhitespace=function(t){for(var e=0;e<t.childNodes.length;e++){var i=t.childNodes[e];i.childNodes.length?this.removeInvisibleWhitespace(i):i.textContent=i.textContent.replace(/\u200B/gi,"")}},t.Editable.prototype.cleanOutput=function(e,i){var s,n,o,a;i&&this.removeInvisibleWhitespace(e);var r=this.mapDOM(e,i).sort(function(t,e){return e.sp-t.sp}),l=e.textContent;html="";var h=[],d=-1,p=t.proxy(function(){var e="";for(simple_nodes_to_close=[],h=h.sort(function(t,e){return t.idx-e.idx}).reverse();h.length;){for(var i=h.pop();simple_nodes_to_close.length&&simple_nodes_to_close[simple_nodes_to_close.length-1].ci<i.ci;)e+=this.closeTag(simple_nodes_to_close.pop());i.selfClosing||i.comment?e+=this.commentTag(i):(!t.isEmptyObject(i.attrs)||this.options.allowedBlankTags.indexOf(i.tagName)>=0)&&(e+=this.openTag(i),simple_nodes_to_close.push(i))}for(;simple_nodes_to_close.length;)e+=this.closeTag(simple_nodes_to_close.pop());html+=e},this),c={},f=[];for(s=0;s<=l.length;s++){if(c[s])for(n=c[s].length-1;n>=0;n--)if(f.length&&f[f.length-1].tagName==c[s][n].tagName&&JSON.stringify(f[f.length-1].styles)==JSON.stringify(c[s][n].styles))html+=this.closeTag(c[s][n]),f.pop();else{for(var m=[];f.length&&(f[f.length-1].tagName!==c[s][n].tagName||JSON.stringify(f[f.length-1].styles)!==JSON.stringify(c[s][n].styles));)a=f.pop(),html+=this.closeTag(a),m.push(a);for(html+=this.closeTag(c[s][n]),f.pop();m.length;){var u=m.pop();html+=this.openTag(u),f.push(u)}}for(var g=this.nodesOpenedAt(r,s).sort(this.sortNodes).reverse();g.length;){var v=g.pop();if(!v.dirty)if(v.selfClosing||v.comment)v.ci>d||"BR"==v.tagName?(p(),html+=this.commentTag(v),d=v.ci):h.length?(h.push(v),d<v.ci&&(d=v.ci)):(html+=this.commentTag(v),d<v.ci&&(d=v.ci));else if(v.ep>v.sp){v.ci>d&&p();var b=[];if("A"==v.tagName)for(var y=v.sp+1;y<v.ep;y++)if(c[y]&&c[y].length)for(o=0;o<c[y].length;o++)b.push(c[y][o]),html+=this.closeTag(c[y][o]),f.pop();var w=[];if("SPAN"==v.tagName&&("#123456"==v.styles["background-color"]||"#123456"===t.Editable.RGBToHex(v.styles["background-color"])||"#123456"==v.styles.color||"#123456"===t.Editable.RGBToHex(v.styles.color)))for(;f.length;){var $=f.pop();html+=this.closeTag($),w.push($)}for(html+=this.openTag(v),d<v.ci&&(d=v.ci),f.push(v),c[v.ep]||(c[v.ep]=[]),c[v.ep].push(v);b.length;)v=b.pop(),html+=this.openTag(v),f.push(v);for(;w.length;)v=w.pop(),html+=this.openTag(v),f.push(v)}else v.sp==v.ep&&(h.push(v),d<v.ci&&(d=v.ci))}p(),s!=l.length&&(html+=this.entity(l[s]))}return html=html.replace(/(<span[^>]*? class\s*=\s*["']?f-marker["']?[^>]+>)\u200B(<\/span>)/gi,"$1$2"),html},t.Editable.prototype.wrapDirectContent=function(){var e=t.merge(["UL","OL","TABLE"],this.valid_nodes);if(!this.options.paragraphy)for(var i=null,s=this.$element.contents(),n=0;n<s.length;n++)1!=s[n].nodeType||e.indexOf(s[n].tagName)<0?(i||(i=t('<div class="fr-wrap">'),t(s[n]).before(i)),i.append(s[n])):i=null},t.Editable.prototype.cleanify=function(e,i,s){if(this.browser.msie&&t.Editable.getIEversion()<9)return!1;var n;if(this.isHTML)return!1;void 0===e&&(e=!0),void 0===s&&(s=!0),this.no_verify=!0,this.$element.find("span").removeAttr("data-fr-verified"),s&&this.saveSelectionByMarkers(),e?n=this.getSelectionElements():(this.wrapDirectContent(),n=this.$element.find(this.valid_nodes.join(",")),0===n.length&&(n=[this.$element.get(0)]));var o,a;if(n[0]!=this.$element.get(0))for(var r=0;r<n.length;r++){var l=t(n[r]);0===l.find(this.valid_nodes.join(",")).length&&(o=l.html(),a=this.cleanOutput(l.get(0),i),a!==o&&l.html(a))}else 0===this.$element.find(this.valid_nodes.join(",")).length&&(o=this.$element.html(),a=this.cleanOutput(this.$element.get(0),i),a!==o&&this.$element.html(a));this.$element.find("[data-fr-idx]").removeAttr("data-fr-idx"),this.$element.find(".fr-wrap").each(function(){t(this).replaceWith(t(this).html())}),this.$element.find(".f-marker").html(""),s&&this.restoreSelectionByMarkers(),this.$element.find("span").attr("data-fr-verified",!0),this.no_verify=!1}}(jQuery);
!function(t){t.Editable.prototype.refreshBlockStyles=function(){var e=this.getSelectionElements()[0],l=e.tagName.toLowerCase();this.$bttn_wrapper.find(".fr-block-style").empty();var a=this.options.blockStyles[l];if(void 0===a&&(a=this.options.defaultBlockStyle),void 0!==a){this.$bttn_wrapper.find('.fr-dropdown > button[data-name="blockStyle"].fr-trigger').removeAttr("disabled");for(var o in a){var r=a[o],s="";t(e).hasClass(o)&&(s=' class="active"'),this.$bttn_wrapper.find(".fr-block-style").append(t("<li"+s+">").append(t('<a href="#" data-text="true">').text(r).addClass(o)).attr("data-cmd","blockStyle").attr("data-val",o))}}},t.Editable.commands=t.extend(t.Editable.commands,{blockStyle:{title:"Block Style",icon:"fa fa-magic",refreshOnShow:t.Editable.prototype.refreshBlockStyles,callback:function(t,e,l){this.blockStyle(e,l)},undo:!0}}),t.Editable.DEFAULTS=t.extend(t.Editable.DEFAULTS,{defaultBlockStyle:{"f-italic":"Italic","f-typewriter":"Typewriter","f-spaced":"Spaced","f-uppercase":"Uppercase"},blockStylesToggle:!0,blockStyles:{}}),t.Editable.prototype.command_dispatcher=t.extend(t.Editable.prototype.command_dispatcher,{blockStyle:function(t){var e=this.buildDropdownBlockStyle(t),l=this.buildDropdownButton(t,e);return l}}),t.Editable.prototype.buildDropdownBlockStyle=function(){var t='<ul class="fr-dropdown-menu fr-block-style">';return t+="</ul>"},t.Editable.prototype.blockStyle=function(e){this.saveSelectionByMarkers(),this.wrapText(),this.restoreSelectionByMarkers();var l=this.getSelectionElements()[0].tagName;this.saveSelectionByMarkers();for(var a=this.getSelectionElements(),o=0;o<a.length;o++){var r=a[o];r!=this.$element.get(0)&&r.tagName==l&&(t(r).find(a).length>0||(t(r).hasClass(e)?(t(r).removeClass(e),""===t(r).attr("class")&&t(r).removeAttr("class")):(this.options.blockStylesToggle&&t(r).removeAttr("class"),t(r).addClass(e))))}this.cleanupLists(),this.restoreSelectionByMarkers(),this.triggerEvent("blockStyle")}}(jQuery);
!function(e){e.Editable.DEFAULTS=e.extend(e.Editable.DEFAULTS,{maxCharacters:-1,countCharacters:!0}),e.Editable.prototype.validKeyCode=function(e,t){return t?!1:e>47&&58>e||32==e||13==e||e>64&&91>e||e>95&&112>e||e>185&&193>e||e>218&&223>e},e.Editable.prototype.charNumber=function(){return this.getText().length},e.Editable.prototype.checkCharNumber=function(e,t,r){if(t.options.maxCharacters<0)return!0;if(t.charNumber()<t.options.maxCharacters)return!0;var a=r.which,i=(r.ctrlKey||r.metaKey)&&!r.altKey;return t.validKeyCode(a,i)?(t.triggerEvent("maxCharNumberExceeded",[],!1),!1):!0},e.Editable.prototype.checkCharNumberOnPaste=function(t,r,a){if(r.options.maxCharacters<0)return!0;var i=e("<div>").html(a).text().length;return i+r.charNumber()<=r.options.maxCharacters?a:(r.triggerEvent("maxCharNumberExceeded",[],!1),"")},e.Editable.prototype.updateCharNumber=function(e,t){if(t.options.countCharacters){var r=t.charNumber()+(t.options.maxCharacters>0?"/"+t.options.maxCharacters:"");t.$box.attr("data-chars",r)}},e.Editable.prototype.initCharNumber=function(){this.$original_element.on("editable.keydown",this.checkCharNumber),this.$original_element.on("editable.afterPasteCleanup",this.checkCharNumberOnPaste),this.$original_element.on("editable.keyup",this.updateCharNumber),this.$original_element.on("editable.contentChanged",this.updateCharNumber),this.updateCharNumber(null,this)},e.Editable.initializers.push(e.Editable.prototype.initCharNumber)}(jQuery);
!function(o){o.Editable.DEFAULTS=o.extend(o.Editable.DEFAULTS,{colors:["#61BD6D","#1ABC9C","#54ACD2","#2C82C9","#9365B8","#475577","#CCCCCC","#41A85F","#00A885","#3D8EB9","#2969B0","#553982","#28324E","#000000","#F7DA64","#FBA026","#EB6B56","#E25041","#A38F84","#EFEFEF","#FFFFFF","#FAC51C","#F37934","#D14841","#B8312F","#7C706B","#D1D5D8","REMOVE"],colorsStep:7,colorGroups:[{text:"Text",cmd:"foreColor"},{text:"Background",cmd:"backColor"}],defaultColorGroup:"foreColor"}),o.Editable.prototype.refreshColors=function(){var o=this.getSelectionElement();this.$editor.find(".fr-color-picker button.fr-color-bttn").removeClass("active"),this.refreshColor(o,"background-color","backColor"),this.refreshColor(o,"color","foreColor")},o.Editable.prototype.refreshColor=function(t,r,e){for(;o(t).get(0)!=this.$element.get(0);){if("transparent"!==o(t).css(r)&&"rgba(0, 0, 0, 0)"!==o(t).css(r)){this.$editor.find('.fr-color-picker button.fr-color-bttn[data-param="'+e+'"][data-val="'+o.Editable.RGBToHex(o(t).css(r))+'"]').addClass("active");break}t=o(t).parent()}},o.Editable.commands=o.extend(o.Editable.commands,{color:{icon:"fa fa-tint",title:"Color",refreshOnShow:o.Editable.prototype.refreshColors,callback:function(o,t,r){this[r].apply(this,[t])},callbackWithoutSelection:function(t,r,e){"backColor"===e&&(e="background-color"),"foreColor"===e&&(e="color"),this._startInFontExec(e,t,r),"#123456"===r&&""===this.text()&&(this.cleanify(!0,!1),this.$element.find("span").each(function(t,r){var e=o(r),s=e.css("background-color");("#123456"===s||"#123456"===o.Editable.RGBToHex(s))&&e.css("background-color",""),s=e.css("color"),("#123456"===s||"#123456"===o.Editable.RGBToHex(s))&&e.css("color","")}))},undo:!0}}),o.Editable.prototype.command_dispatcher=o.extend(o.Editable.prototype.command_dispatcher,{color:function(o){var t=this.buildDropdownColor(o),r=this.buildDropdownButton(o,t,"fr-color-picker");return r}}),o.Editable.prototype.buildColorList=function(o,t){for(var r=this.options.defaultColorGroup==o?"block":"none",e='<div class="fr-color-set fr-'+o+'" style="display: '+r+'">',s=0;s<t.length;s++){var a=t[s];e+="REMOVE"!==a?'<button type="button" class="fr-color-bttn" data-val="'+a+'" data-cmd="color" data-param="'+o+'" style="background: '+a+';">&nbsp;</button>':'<button type="button" class="fr-color-bttn" data-val="#123456" data-cmd="color" data-param="'+o+'" style="background: #FFF;"><i class="fa fa-eraser"></i></button>',s%this.options.colorsStep==this.options.colorsStep-1&&s>0&&(e+="<hr/>",s!=this.options.colorsStep-1&&s!=2*this.options.colorsStep-1||!this.options.colorsTopChoices||(e+='<div class="separator"></div>'))}return e+="</div>"},o.Editable.prototype.buildDropdownColor=function(){for(var t="",r='<div class="fr-dropdown-menu">',e=0;e<this.options.colorGroups.length;e++)r+=this.buildColorList(this.options.colorGroups[e].cmd,this.options.colorGroups[e].colors||this.options.colors);for(r+="<p>",e=0;e<this.options.colorGroups.length;e++)t=this.options.defaultColorGroup==this.options.colorGroups[e].cmd?"active":"",r+='<span class="fr-choose-color '+t+'" data-text="true" data-param="'+this.options.colorGroups[e].cmd+'" style="width: '+100/this.options.colorGroups.length+'%;">'+this.options.colorGroups[e].text+"</span>";r+="</p></div>",this.$bttn_wrapper.on(this.mousedown,".fr-choose-color",function(o){return o.preventDefault(),o.stopPropagation(),"mousedown"===o.type&&1!==o.which?!0:void 0});var s=this;return this.$bttn_wrapper.on(this.mouseup,".fr-choose-color",function(t){if(t.preventDefault(),t.stopPropagation(),"mouseup"===t.type&&1!==t.which)return!0;var r=o(this);r.siblings().removeClass("active"),r.addClass("active"),r.parents(".fr-dropdown-menu").find("button").attr("data-param",r.attr("data-param")),r.parents(".fr-dropdown-menu").find(".fr-color-set").hide(),r.parents(".fr-dropdown-menu").find(".fr-color-set.fr-"+r.attr("data-param")).show(),s.refreshColors()}),r},o.Editable.prototype.backColor=function(t){this.inlineStyle("background-color","backColor",t),this.saveSelectionByMarkers(),this.$element.find("span").each(function(t,r){var e=o(r),s=e.css("background-color");("#123456"===s||"#123456"===o.Editable.RGBToHex(s))&&(e.css("background-color",""),e.find("span").each(function(t,r){var e=o(r);e.css("background-color",""),""!==e.attr("style")||e.hasClass("f-marker")||e.replaceWith(e.contents())})),""!==e.attr("style")||e.hasClass("f-marker")||e.replaceWith(e.contents())}),this.restoreSelectionByMarkers(),this.cleanify();var r=this.$editor.find('button.fr-color-bttn[data-cmd="backColor"][data-val="'+t+'"]');r.addClass("active"),r.siblings().removeClass("active")},o.Editable.prototype.foreColor=function(t){this.inlineStyle("color","foreColor",t),this.saveSelectionByMarkers(),this.$element.find("span").each(function(t,r){var e=o(r),s=e.css("color");("#123456"===s||"#123456"===o.Editable.RGBToHex(s))&&(e.css("color",""),e.find("span").each(function(t,r){var e=o(r);e.css("color",""),""!==e.attr("style")||e.hasClass("f-marker")||e.replaceWith(e.contents())})),""!==e.attr("style")||e.hasClass("f-marker")||e.replaceWith(e.contents())}),this.restoreSelectionByMarkers(),this.cleanify();var r=this.$editor.find('button.fr-color-bttn[data-cmd="foreColor"][data-val="'+t+'"]');r.addClass("active"),r.siblings().removeClass("active")}}(jQuery);
!function(e){e.Editable.DEFAULTS=e.extend(e.Editable.DEFAULTS,{entities:"&quot;&apos;&iexcl;&cent;&pound;&curren;&yen;&brvbar;&sect;&uml;&copy;&ordf;&laquo;&not;&shy;&reg;&macr;&deg;&plusmn;&sup2;&sup3;&acute;&micro;&para;&middot;&cedil;&sup1;&ordm;&raquo;&frac14;&frac12;&frac34;&iquest;&Agrave;&Aacute;&Acirc;&Atilde;&Auml;&Aring;&AElig;&Ccedil;&Egrave;&Eacute;&Ecirc;&Euml;&Igrave;&Iacute;&Icirc;&Iuml;&ETH;&Ntilde;&Ograve;&Oacute;&Ocirc;&Otilde;&Ouml;&times;&Oslash;&Ugrave;&Uacute;&Ucirc;&Uuml;&Yacute;&THORN;&szlig;&agrave;&aacute;&acirc;&atilde;&auml;&aring;&aelig;&ccedil;&egrave;&eacute;&ecirc;&euml;&igrave;&iacute;&icirc;&iuml;&eth;&ntilde;&ograve;&oacute;&ocirc;&otilde;&ouml;&divide;&oslash;&ugrave;&uacute;&ucirc;&uuml;&yacute;&thorn;&yuml;&OElig;&oelig;&Scaron;&scaron;&Yuml;&fnof;&circ;&tilde;&Alpha;&Beta;&Gamma;&Delta;&Epsilon;&Zeta;&Eta;&Theta;&Iota;&Kappa;&Lambda;&Mu;&Nu;&Xi;&Omicron;&Pi;&Rho;&Sigma;&Tau;&Upsilon;&Phi;&Chi;&Psi;&Omega;&alpha;&beta;&gamma;&delta;&epsilon;&zeta;&eta;&theta;&iota;&kappa;&lambda;&mu;&nu;&xi;&omicron;&pi;&rho;&sigmaf;&sigma;&tau;&upsilon;&phi;&chi;&psi;&omega;&thetasym;&upsih;&piv;&ensp;&emsp;&thinsp;&zwnj;&zwj;&lrm;&rlm;&ndash;&mdash;&lsquo;&rsquo;&sbquo;&ldquo;&rdquo;&bdquo;&dagger;&Dagger;&bull;&hellip;&permil;&prime;&Prime;&lsaquo;&rsaquo;&oline;&frasl;&euro;&image;&weierp;&real;&trade;&alefsym;&larr;&uarr;&rarr;&darr;&harr;&crarr;&lArr;&uArr;&rArr;&dArr;&hArr;&forall;&part;&exist;&empty;&nabla;&isin;&notin;&ni;&prod;&sum;&minus;&lowast;&radic;&prop;&infin;&ang;&and;&or;&cap;&cup;&int;&there4;&sim;&cong;&asymp;&ne;&equiv;&le;&ge;&sub;&sup;&nsub;&sube;&supe;&oplus;&otimes;&perp;&sdot;&lceil;&rceil;&lfloor;&rfloor;&lang;&rang;&loz;&spades;&clubs;&hearts;&diams;"}),e.Editable.prototype.encodeEntities=function(e,a,r){var t="";for(i=0;i<r.length;i++)if(chr=r.charAt(i),"<"==chr){var l=r.indexOf(">",i+1);if(-1!==l){var s=r.substring(i,l+1);t+=s,i=l}}else t+=a.entities_map[chr]?a.entities_map[chr]:chr;return t},e.Editable.prototype.initEntities=function(){var i=e("<div>").html(this.options.entities).text(),a=this.options.entities.split(";");this.entities_reg_exp=new RegExp(i,"g"),this.entities_map={};for(var r=0;r<i.length;r++){var t=i.charAt(r);this.entities_map[t]=a[r]+";"}this.$original_element.on("editable.getHTML",this.encodeEntities)},e.Editable.initializers.push(e.Editable.prototype.initEntities)}(jQuery);
!function(i){i.Editable.commands=i.extend(i.Editable.commands,{uploadFile:{title:"Upload File",icon:"fa fa-paperclip",callback:function(){this.insertFile()},undo:!1}}),i.Editable.DEFAULTS=i.extend(i.Editable.DEFAULTS,{allowedFileTypes:["*"],fileDeleteUrl:null,fileDeleteParams:{},fileUploadParams:{},fileUploadURL:"http://i.froala.com/upload",fileUploadParam:"file",maxFileSize:10485760,useFileName:!0}),i.Editable.prototype.showFileWrapper=function(){this.$file_wrapper&&this.$file_wrapper.show()},i.Editable.prototype.hideFileWrapper=function(){this.$file_wrapper&&(this.$file_wrapper.hide(),this.$file_wrapper.find("input").blur())},i.Editable.prototype.showFileUpload=function(){this.hidePopups(),this.showFileWrapper()},i.Editable.prototype.insertFile=function(){this.closeImageMode(),this.imageMode=!1,this.showFileUpload(),this.saveSelectionByMarkers(),this.options.inlineMode||this.positionPopup("uploadFile")},i.Editable.prototype.fileUploadHTML=function(){var e='<div class="froala-popup froala-file-popup" style="display: none;"><h4><span data-text="true">Upload file</span><i title="Cancel" class="fa fa-times" id="f-file-close-'+this._id+'"></i></h4>';return e+='<div id="f-file-list-'+this._id+'">',e+='<div class="f-popup-line drop-upload">',e+='<div class="f-upload" id="f-file-upload-div-'+this._id+'"><strong data-text="true">Drop File</strong><br>(<span data-text="true">or click</span>)<form target="file-frame-'+this._id+'" enctype="multipart/form-data" encoding="multipart/form-data" action="'+this.options.fileUploadURL+'" method="post" id="f-file-form-'+this._id+'"><input id="f-file-upload-'+this._id+'" type="file" name="'+this.options.fileUploadParam+'" accept="/*"></form></div>',this.browser.msie&&i.Editable.getIEversion()<=9&&(e+='<iframe id="file-frame-'+this._id+'" name="file-frame-'+this._id+'" src="javascript:false;" style="width:0; height:0; border:0px solid #FFF; position: fixed; z-index: -1;" data-loaded="true"></iframe>'),e+="</div>",e+="</div>",e+='<p class="f-progress" id="f-file-progress-'+this._id+'"><span></span></p>',e+="</div>"},i.Editable.prototype.buildFileDrag=function(){var e=this;e.$file_wrapper.on("dragover","#f-file-upload-div-"+this._id,function(){return i(this).addClass("f-hover"),!1}),e.$file_wrapper.on("dragend","#f-file-upload-div-"+this._id,function(){return i(this).removeClass("f-hover"),!1}),e.$file_wrapper.on("drop","#f-file-upload-div-"+this._id,function(t){t.preventDefault(),t.stopPropagation(),i(this).removeClass("f-hover"),e.uploadFile(t.originalEvent.dataTransfer.files)}),e.$element.on("drop",function(t){var o=t.originalEvent.dataTransfer.files;if(0===i(".froala-element img.fr-image-move").length&&t.originalEvent.dataTransfer&&o&&o.length){if(e.isDisabled)return!1;e.options.allowedImageTypes.indexOf(o[0].type.replace(/image\//g,""))<0&&(e.closeImageMode(),e.hide(),e.imageMode=!1,e.initialized||(e.$element.unbind("mousedown.element"),e.lateInit()),e.insertMarkersAtPoint(t.originalEvent),e.showByCoordinates(t.originalEvent.pageX,t.originalEvent.pageY),e.uploadFile(o),t.preventDefault(),t.stopPropagation())}})},i.Editable.prototype.buildFileUpload=function(){this.$file_wrapper=i(this.fileUploadHTML()),this.$popup_editor.append(this.$file_wrapper),this.buildFileDrag();var e=this;if(this.$file_wrapper.on("mouseup touchend",i.proxy(function(i){this.isResizing()||i.stopPropagation()},this)),this.addListener("hidePopups",i.proxy(function(){this.hideFileWrapper()},this)),this.$file_progress_bar=this.$file_wrapper.find("p#f-file-progress-"+this._id),this.browser.msie&&i.Editable.getIEversion()<=9){var t=this.$file_wrapper.find("iframe").get(0);t.attachEvent?t.attachEvent("onload",function(){e.iFrameLoad()}):t.onload=function(){e.iFrameLoad()}}this.$file_wrapper.on("change",'input[type="file"]',function(){if(void 0!==this.files)e.uploadFile(this.files);else{var t=i(this).parents("form");t.find('input[type="hidden"]').remove();var o;for(o in e.options.fileUploadParams)t.prepend('<input type="hidden" name="'+o+'" value="'+e.options.fileUploadParams[o]+'" />');e.$file_wrapper.find("#f-file-list-"+e._id).hide(),e.$file_progress_bar.show(),e.$file_progress_bar.find("span").css("width","100%").text("Please wait!"),e.showFileUpload(),t.submit()}i(this).val("")}),this.$file_wrapper.on(this.mouseup,"#f-file-close-"+this._id,i.proxy(function(i){i.stopPropagation(),i.preventDefault(),this.$bttn_wrapper.show(),this.hideFileWrapper(),this.restoreSelection(),this.focus(),this.hide()},this)),this.$file_wrapper.on("click",function(i){i.stopPropagation()}),this.$file_wrapper.on("click","*",function(i){i.stopPropagation()})},i.Editable.initializers.push(i.Editable.prototype.buildFileUpload),i.Editable.prototype.uploadFile=function(e){if(!this.triggerEvent("beforeFileUpload",[e],!1))return!1;if(void 0!==e&&e.length>0){var t;if(this.drag_support.formdata&&(t=this.drag_support.formdata?new FormData:null),t){var o;for(o in this.options.fileUploadParams)t.append(o,this.options.fileUploadParams[o]);if(t.append(this.options.fileUploadParam,e[0]),e[0].size>this.options.maxFileSize)return this.throwFileError(5),!1;if(this.options.allowedFileTypes.indexOf(e[0].type)<0&&this.options.allowedFileTypes.indexOf("*")<0)return this.throwFileError(6),!1}if(t){var r;if(this.options.crossDomain)r=this.createCORSRequest("POST",this.options.fileUploadURL);else{r=new XMLHttpRequest,r.open("POST",this.options.fileUploadURL);for(var s in this.options.headers)r.setRequestHeader(s,this.options.headers[s])}var a=e[0].name;r.onload=i.proxy(function(){this.$file_progress_bar.find("span").css("width","100%").text("Please wait!");try{r.status>=200&&r.status<300?this.parseFileResponse(r.responseText,a):this.throwFileError(3)}catch(i){this.throwFileError(4)}},this),r.onerror=i.proxy(function(){this.throwFileError(3)},this),r.upload.onprogress=i.proxy(function(i){if(i.lengthComputable){var e=i.loaded/i.total*100|0;this.$file_progress_bar.find("span").css("width",e+"%")}},this),r.send(t),this.$file_wrapper.find("#f-file-list-"+this._id).hide(),this.$file_progress_bar.show(),this.showFileUpload()}}},i.Editable.prototype.throwFileError=function(i){var e="Unknown file upload error.";1==i?e="Bad link.":2==i?e="No link in upload response.":3==i?e="Error during file upload.":4==i?e="Parsing response failed.":5==i?e="File too large.":6==i?e="Invalid file type.":7==i&&(e="File can be uploaded only to same domain in IE 8 and IE 9."),this.triggerEvent("fileError",[{code:i,message:e}],!1),this.hideFileLoader()},i.Editable.prototype.hideFileLoader=function(){this.$file_progress_bar.hide(),this.$file_progress_bar.find("span").css("width","0%").text(""),this.$file_wrapper.find("#f-file-list-"+this._id).show()},i.Editable.prototype.throwFileErrorWithMessage=function(i){this.triggerEvent("fileError",[{message:i,code:0}],!1),this.hideFileLoader()},i.Editable.prototype.parseFileResponse=function(e,t){try{if(!this.triggerEvent("afterFileUpload",[e],!1))return!1;var o=i.parseJSON(e);o.link?this.writeFile(o.link,t,e):o.error?this.throwFileErrorWithMessage(o.error):this.throwFileError(2)}catch(r){this.throwFileError(4)}},i.Editable.prototype.writeFile=function(i,e,t){this.restoreSelectionByMarkers(),this.focus(),this.options.useFileName||""===this.text()||(e=this.text()),this.insertHTML('<a class="fr-file" href="'+this.sanitizeURL(i)+'">'+e+"</a>"),this.hide(),this.hideFileLoader(),this.focus(),this.triggerEvent("fileUploaded",[e,i,t])}}(jQuery);
!function(t){t.Editable.DEFAULTS=t.extend(t.Editable.DEFAULTS,{fontList:{"Arial,Helvetica":"Arial, Helvetica","Courier,Courier New":"Courier, Courier New",Georgia:"Georgia","Times New Roman,Times":"Times New Roman,Times","Trebuchet MS":"Trebuchet MS","Verdana, Geneva":"Verdana,Geneva"}}),t.Editable.prototype.refreshFontFamily=function(){var e=t(this.getSelectionElement());this.$editor.find('.fr-dropdown > button[data-name="fontFamily"] + ul li').removeClass("active"),this.$editor.find('.fr-dropdown > button[data-name="fontFamily"] + ul li[data-val="'+e.css("font-family").replace(/"/gi,'\\"')+'"]').addClass("active")},t.Editable.commands=t.extend(t.Editable.commands,{fontFamily:{title:"Font Family",icon:"fa fa-font",refreshOnShow:t.Editable.prototype.refreshFontFamily,callback:function(t,e){this.inlineStyle("font-family",t,e)},undo:!0,callbackWithoutSelection:function(t,e){this._startInFontExec("font-family",t,e)}}}),t.Editable.prototype.command_dispatcher=t.extend(t.Editable.prototype.command_dispatcher,{fontFamily:function(t){var e=this.buildDropdownFontFamily(),i=this.buildDropdownButton(t,e,"fr-family");return i}}),t.Editable.prototype.buildDropdownFontFamily=function(){var t='<ul class="fr-dropdown-menu">';for(var e in this.options.fontList){var i=this.options.fontList[e],a='<li data-cmd="fontFamily" data-val="'+e+'">';a+='<a href="#" data-text="true" title="'+i+'" style="font-family: '+e+';">'+i+"</a></li>",t+=a}return t+="</ul>"}}(jQuery);
!function(t){t.Editable.prototype.refreshFontSize=function(){var e=t(this.getSelectionElement()),n=parseInt(e.css("font-size").replace(/px/g,""),10)||16;this.$editor.find('.fr-dropdown > button[data-name="fontSize"] + ul li').removeClass("active"),this.$editor.find('.fr-dropdown > button[data-name="fontSize"] + ul li[data-val="'+n+'px"]').addClass("active")},t.Editable.commands=t.extend(t.Editable.commands,{fontSize:{title:"Font Size",icon:"fa fa-text-height",refreshOnShow:t.Editable.prototype.refreshFontSize,seed:[{min:11,max:52}],undo:!0,callback:function(t,e){this.inlineStyle("font-size",t,e)},callbackWithoutSelection:function(t,e){this._startInFontExec("font-size",t,e)}}}),t.Editable.prototype.command_dispatcher=t.extend(t.Editable.prototype.command_dispatcher,{fontSize:function(t){var e=this.buildDropdownFontsize(t),n=this.buildDropdownButton(t,e);return n}}),t.Editable.prototype.buildDropdownFontsize=function(t){for(var e='<ul class="fr-dropdown-menu f-font-sizes">',n=0;n<t.seed.length;n++)for(var o=t.seed[n],i=o.min;i<=o.max;i++)e+='<li data-cmd="'+t.cmd+'" data-val="'+i+'px"><a href="#"><span>'+i+"px</span></a></li>";return e+="</ul>"}}(jQuery);
!function(e){e.Editable.prototype.refreshFullscreen=function(){this.$box.hasClass("fr-fullscreen")?this.$editor.find('[data-cmd="fullscreen"]').addClass("active"):this.$editor.find('[data-cmd="fullscreen"]').removeClass("active")},e.Editable.commands=e.extend(e.Editable.commands,{fullscreen:{icon:"fa fa-expand",title:"Fullscreen",callback:function(){if(this.$box.toggleClass("fr-fullscreen"),e("body").toggleClass("fr-fullscreen"),this.$editor.find('[data-cmd="fullscreen"] i').toggleClass("fa-expand fa-compress"),this.refreshFullscreen(),this.$box.hasClass("fr-fullscreen"))this.$fullscreen_marker=e("<div>"),this.$box.after(this.$fullscreen_marker),this.$box.appendTo("body"),this.computeElementHeight();else{this.$wrapper.css("height",""),this.$element.css("minHeight",""),this.setDimensions(),this.options.scrollableContainer=this.oldScrollableContainer;var t=this.$document.find(this.options.scrollableContainer);t.append(this.$popup_editor),this.$fullscreen_marker.replaceWith(this.$box)}},refresh:e.Editable.prototype.refreshFullscreen}}),e.Editable.prototype.computeElementHeight=function(){var e=this.$window.height()-this.$editor.outerHeight()-parseFloat(this.$wrapper.css("padding-top"),10)-parseFloat(this.$wrapper.css("padding-bottom"),10)-parseFloat((this.$wrapper||this.$element).css("border-top-width"),10)-parseFloat((this.$wrapper||this.$element).css("border-bottom-width"),10)+2;this.$wrapper.css("height",e),this.$element.css("minHeight",e-parseInt(this.$element.css("padding-top"),10)-parseInt(this.$element.css("padding-bottom"),10)),this.$element.css("maxHeight",""),this.$wrapper.css("maxHeight",""),this.oldScrollableContainer=this.options.scrollableContainer,this.options.scrollableContainer=this.$wrapper,this.$wrapper.append(this.$popup_editor)},e.Editable.prototype.initFullscreen=function(){this.$window.on("resize",e.proxy(function(){this.$box.hasClass("fr-fullscreen")&&this.computeElementHeight()},this))},e.Editable.initializers.push(e.Editable.prototype.initFullscreen)}(jQuery);
!function(t){t.Editable.prototype.refreshInlineStyles=function(){var e=this.getSelectionElements()[0],i=e.tagName.toLowerCase();this.$bttn_wrapper.find(".fr-block-style").empty();var n=this.options.blockStyles[i];if(void 0===n&&(n=this.options.defaultBlockStyle),void 0!==n){this.$bttn_wrapper.find('.fr-dropdown > button[data-name="blockStyle"].fr-trigger').removeAttr("disabled");for(var l in n){var a=n[l],r="";t(e).hasClass(l)&&(r=' class="active"'),this.$bttn_wrapper.find(".fr-block-style").append(t("<li"+r+">").append(t('<a href="#" data-text="true">').text(a).addClass(l)).attr("data-cmd","blockStyle").attr("data-val",l))}}},t.Editable.commands=t.extend(t.Editable.commands,{inlineStyle:{title:"Inline Style",icon:"fa fa-paint-brush",refreshOnShow:t.Editable.prototype.refreshInlineStyles,callback:function(t,e){this.applyInlineStyles(e)},callbackWithoutSelection:function(t,e){this.applyInlineStyles(e)}}}),t.Editable.DEFAULTS=t.extend(t.Editable.DEFAULTS,{inlineStyles:{"Big Red":"font-size: 20px; color: red;","Small Blue":"font-size: 14px; color: blue;"}}),t.Editable.prototype.command_dispatcher=t.extend(t.Editable.prototype.command_dispatcher,{inlineStyle:function(t){var e=this.buildDropdownInlineStyle(),i=this.buildDropdownButton(t,e);return i}}),t.Editable.prototype.buildDropdownInlineStyle=function(){var t='<ul class="fr-dropdown-menu fr-inline-style">';for(var e in this.options.inlineStyles)t+='<li data-cmd="inlineStyle" data-val="'+e+'"><a href="#" style="'+this.options.inlineStyles[e]+'">'+e+"</a></li>";return t+="</ul>"},t.Editable.prototype.applyInlineStyles=function(e){this.insertHTML(""!==this.text()?this.start_marker+'<span data-fr-verified="true" style="'+this.options.inlineStyles[e]+'">'+this.text()+"</span>"+this.end_marker:'<span data-fr-verified="true" style="'+this.options.inlineStyles[e]+'">'+this.markers_html+t.Editable.INVISIBLE_SPACE+"</span>"),this.restoreSelectionByMarkers(),this.triggerEvent("inlineStyle")},t.Editable.prototype.startInInlineStyles=function(t){for(var e in this.options.inlineStyles[t])this._startInFontExec(e.replace(/([A-Z])/g,"-$1").toLowerCase(),null,this.options.inlineStyles[t][e]);this.triggerEvent("inlineStyle")}}(jQuery);
!function(e){e.Editable.commands=e.extend(e.Editable.commands,{insertOrderedList:{title:"Numbered List",icon:"fa fa-list-ol",refresh:function(){},callback:function(e){this.formatList(e)},undo:!0},insertUnorderedList:{title:"Bulleted List",icon:"fa fa-list-ul",refresh:function(){},callback:function(e){this.formatList(e)},undo:!0}}),e.Editable.prototype.refreshLists=function(){var t=e(this.getSelectionElement()),i=this.parents(t,"ul, ol");if(i.length>0){var n="insertUnorderedList";"OL"==i[0].tagName&&(n="insertOrderedList"),this.$editor.find('button[data-cmd="'+n+'"]').addClass("active")}},e.Editable.prototype.processBackspace=function(t){var i=t.prev();if(i.length){for(this.removeMarkers(),("UL"==i.get(0).tagName||"OL"==i.get(0).tagName)&&(i=i.find("li:last"));i.find("> ul, > ol").length;)i=i.find("> ul li:last, > ol li:last");var n=i.find("> p, > h1, > h3, > h4, > h5, > h6, > div, > pre, > blockquote");if(0===i.text().length&&0===i.find("img, table, input, iframe, video").length)i.remove();else{if(this.emptyElement(i.get(0))||(this.keep_enter=!0,t.find("> p, > h1, > h3, > h4, > h5, > h6, > div, > pre, > blockquote").each(function(t,i){e(i).replaceWith(e(i).html())}),this.keep_enter=!1),n.length)if(e(n[n.length-1]).append(this.markers_html),0===t.find("ul, ol").length)e(n[n.length-1]).append(t.html());else{for(var r=!1,s=t.contents(),a=0;a<s.length;a++){var l=s[a];["OL","UL"].indexOf(s[a].tagName)>=0&&(r=!0),r?e(n[n.length-1]).after(l):e(n[n.length-1]).append(l)}this.$element.find("breakli").remove();var h=n[n.length-1].nextSibling;h&&"BR"==h.tagName&&e(h).remove()}else this.emptyElement(i.get(0))?(this.$element.find("breakli").replaceWith(this.markers_html),i.html(t.html())):(i.append(this.markers_html),i.append(t.html()));t.remove(),this.cleanupLists(),this.restoreSelectionByMarkers()}this.$element.find("breakli").remove()}else this.$element.find("breakli").remove(),this.parents(t,"ul").length?this.formatList("insertUnorderedList",!1):this.formatList("insertOrderedList",!1);this.sync()},e.Editable.prototype.liBackspace=function(){if(""!==this.text())return!0;var t,i=this.getSelectionElement(),n=this.parents(e(i),"table, li");if(n.length>0&&"TABLE"===n[0].tagName)return!0;if(t="LI"==i.tagName?e(i):this.parents(e(i),"li:first"),this.removeMarkers(),this.emptyElement(t.get(0))?(t.prepend("<breakli></breakli>"),1==t.find("br").length&&t.find("br").remove()):this.insertHTML("<breakli></breakli>"),t.find("breakli").prev().length&&"TABLE"===t.find("breakli").prev().get(0).tagName&&t.find("breakli").next().length&&"BR"===t.find("breakli").next().get(0).tagName)return this.setSelection(t.find("breakli").prev().find("td:first").get(0)),t.find("breakli").next().remove(),this.$element.find("breakli").remove(),!1;for(var r,s=t.html(),a=[],l=0;l<s.length;l++){if(chr=s.charAt(l),"<"!=chr)return this.$element.find("breakli").remove(),!0;var h=s.indexOf(">",l+1);if(-1!==h){r=s.substring(l,h+1);var o=this.tagName(r);if(l=h,"breakli"==o){if(!this.isClosingTag(r)&&!this.isClosingTag(a[a.length-1]))return this.processBackspace(t),!1}else a.push(r)}}return this.$element.find("breakli").remove(),!0},e.Editable.prototype.textLiEnter=function(t){this.removeMarkers(),this.insertSimpleHTML("<breakli></breakli>",!1);var i,n,r=t.html(),s=[],a={},l=[],h=0,o=t.prop("attributes"),p="";for(n=0;n<o.length;n++)p+=" "+o[n].name+'="'+o[n].value+'"';var d=!1;for(n=0;n<r.length;n++)if(chr=r.charAt(n),"<"==chr){var f=r.indexOf(">",n+1);if(-1!==f){i=r.substring(n,f+1);var g=this.tagName(i);if(n=f,"breakli"==g){if(!this.isClosingTag(i)){for(var m=s.length-1;m>=0;m--){var c=this.tagName(s[m]);l.push("</"+c+">")}l.push("</li>"),l.push("<li"+p+">");for(var u=0;u<s.length;u++)l.push(s[u]);l.push('<span class="f-marker" data-type="false" data-collapsed="true" data-id="0" data-fr-verified="true"></span><span class="f-marker" data-type="true" data-collapsed="true" data-id="0" data-fr-verified="true"></span>'),d=!1}}else if(l.push(i),d=!1,!this.isSelfClosingTag(i))if(this.isClosingTag(i)){var v=a[g].pop();s.splice(v,1)}else s.push(i),void 0===a[g]&&(a[g]=[]),a[g].push(s.length-1)}}else h++,32!=chr.charCodeAt(0)||d?(l.push(chr),d=!0):l.push("&nbsp;");var b=e(t.parents("ul, ol")[0]);t.replaceWith("<li"+p+">"+l.join("")+"</li>"),b.find("p:empty + table").prev().remove(),b.find("p + table").each(function(t,i){var n=e(i);n.prev().append(n.clone()),n.remove()}),b.find("table + p").each(function(t,i){var n=e(i);n.append(n.prev().clone()),n.prev().remove()}),this.keep_enter=!0,b.find(this.valid_nodes.join(",")).each(e.proxy(function(t,i){""===e(i).text().trim()&&0===e(i).find(this.valid_nodes.join(",")).length&&e(i).prepend(e.Editable.INVISIBLE_SPACE)},this)),this.keep_enter=!1},e.Editable.prototype.liEnter=function(){var t,i=this.getSelectionElement(),n=this.parents(e(i),"table, li");if(n.length>0&&"TABLE"==n[0].tagName)return!0;if(t="LI"==i.tagName?e(i):this.parents(e(i),"li:first"),this.getSelectionTextInfo(t.get(0)).atStart&&""===this.text())t.before("<li>"+e.Editable.INVISIBLE_SPACE+"</li>");else{if(0===this.trim(t.text()).length&&0===t.find("img, table, iframe, input, object").length)return this.outdent(!1),!1;this.textLiEnter(t),this.$element.find("breakli").remove(),this.restoreSelectionByMarkers()}return this.sync(),!1},e.Editable.prototype.listTab=function(){var t=e(this.getSelectionElement());return this.parents(t,"ul, ol").length>0&&0===this.parents(t,"table").length?(this.indent(),!1):void 0},e.Editable.prototype.listShiftTab=function(){var t=e(this.getSelectionElement());return this.parents(t,"ul, ol").length>0&&0===this.parents(t,"table").length?(this.outdent(),!1):void 0},e.Editable.prototype.indentList=function(e,t){return"LI"===e.get(0).tagName?(t?this.outdentLi(e):this.indentLi(e),this.cleanupLists(),!1):!0},e.Editable.prototype.initList=function(){this.addListener("tab",this.listTab),this.addListener("shift+tab",this.listShiftTab),this.addListener("refresh",this.refreshLists),this.addListener("indent",this.indentList),this.isImage||this.isLink||this.options.editInPopup||this.$element.on("keydown",e.proxy(function(t){if(["TEXTAREA","INPUT"].indexOf(t.target.tagName)<0&&!this.isHTML){var i=t.which,n=this.getSelectionElement();if("LI"==n.tagName||this.parents(e(n),"li").length>0){if(13==i&&!t.shiftKey&&this.options.multiLine)return this.liEnter();if(8==i)return this.liBackspace()}}},this))},e.Editable.initializers.push(e.Editable.prototype.initList),e.Editable.prototype.formatList=function(t,i){if(this.browser.msie&&e.Editable.getIEversion()<9)return document.execCommand(t,!1,!1),!1;void 0===i&&(i=!0);var n,r,s=!1,a=!0,l=!1,h=this.getSelectionElements(),o=this.parents(e(h[0]),"ul, ol");if(o.length&&("UL"===o[0].tagName?"insertUnorderedList"!=t&&(s=!0):"insertOrderedList"!=t&&(s=!0)),this.saveSelectionByMarkers(),s){n="ol","insertUnorderedList"===t&&(n="ul");var p=e(o[0]);p.replaceWith("<"+n+">"+p.html()+"</"+n+">")}else{for(var d=0;d<h.length;d++)if(r=e(h[d]),("TD"==r.get(0).tagName||"TH"==r.get(0).tagName)&&this.wrapTextInElement(r),this.parents(r,"li").length>0||"LI"==r.get(0).tagName){var f;f="LI"==r.get(0).tagName?r:e(r.parents("li")[0]);var g=this.parents(r,"ul, ol");if(g.length>0&&(n=g[0].tagName.toLowerCase(),f.before('<span class="close-'+n+'" data-fr-verified="true"></span>'),f.after('<span class="open-'+n+'" data-fr-verified="true"></span>')),0===this.parents(e(g[0]),"ol, ul").length||s)if(0===f.find(this.valid_nodes.join(",")).length){var m=f.html().replace(/\u200B/gi,"");this.options.paragraphy?(0===f.text().replace(/\u200B/gi,"").length&&(m+=f.find("br").length>0?"":this.br),m="<"+this.options.defaultTag+this.attrs(f.get(0))+">"+m,m=m+"</"+this.options.defaultTag+">"):m+=f.find("br").length>0?"":this.br,f.replaceWith(m)}else f.replaceWith(f.html().replace(/\u200B/gi,""));l=!0}else a=!1;l&&this.cleanupLists(),(a===!1||s===!0)&&(this.wrapText(),this.restoreSelectionByMarkers(),h=this.getSelectionElements(),this.saveSelectionByMarkers(),this.elementsToList(h,t),this.unwrapText(),this.cleanupLists())}this.options.paragraphy&&!s&&this.wrapText(!0),this.restoreSelectionByMarkers(),i&&this.repositionEditor(),t="insertUnorderedList"==t?"unorderedListInserted":"orderedListInserted",this.triggerEvent(t)},e.Editable.prototype.elementsToList=function(t,i){var n="<ol>";"insertUnorderedList"==i&&(n="<ul>"),t[0]==this.$element.get(0)&&(t=this.$element.find("> "+this.valid_nodes.join(", >")));for(var r=0;r<t.length;r++){var s=e(n);$element=e(t[r]),$element.get(0)!=this.$element.get(0)&&("TD"===$element.get(0).tagName||"TH"===$element.get(0).tagName?(this.wrapTextInElement($element,!0),this.elementsToList($element.find("> "+this.valid_nodes.join(", >")),i)):(""===$element.attr("class")&&$element.removeAttr("class"),s.append($element.get(0).tagName==this.options.defaultTag&&0===$element.get(0).attributes.length?e("<li>").html($element.clone().html()):e("<li>").html($element.clone())),$element.replaceWith(s)))}},e.Editable.prototype.indentLi=function(t){var i=t.parents("ul, ol"),n=i.get(0).tagName.toLowerCase();t.find("> ul, > ol").length>0&&t.prev("li").length>0?(this.wrapTextInElement(t),t.find("> "+this.valid_nodes.join(" , > ")).each(function(t,i){e(i).wrap("<"+n+"></"+n+">").wrap("<li></li>")}),t.prev("li").append(t.find("> ul, > ol")),t.remove()):0===t.find("> ul, > ol").length&&t.prev("li").length>0&&(t.prev().append(e("<"+n+">").append(t.clone())),t.remove(),e(i.find("li").get().reverse()).each(function(t,i){var n=e(i);n.find(" > ul, > ol").length>0&&n.prev()&&n.prev().find(" > ul, > ol").length>0&&1===n.contents().length&&(n.prev().append(n.html()),n.remove())}))},e.Editable.prototype.outdentLi=function(t){var i=e(t.parents("ul, ol")[0]),n=this.parents(i,"ul, ol"),r=i.get(0).tagName.toLowerCase();0===t.prev("li").length&&this.parents(t,"li").length>0?(t.before('<span class="close-'+r+'" data-fr-verified="true"></span>'),t.before('<span class="close-li" data-fr-verified="true"></span>'),t.before('<span class="open-li" data-fr-verified="true"></span>'),t.after('<span class="open-'+r+'" data-fr-verified="true"></span>'),t.replaceWith(t.html())):(t.before('<span class="close-'+r+'" data-fr-verified="true"></span>'),t.after('<span class="open-'+r+'" data-fr-verified="true"></span>'),this.parents(t,"li").length>0&&(t.before('<span class="close-li" data-fr-verified="true"></span>'),t.after('<span class="open-li" data-fr-verified="true"></span>'))),n.length||(0===t.find(this.valid_nodes.join(",")).length?t.replaceWith(t.html().replace(/\u200b/gi,"")+this.br):(t.find(this.valid_nodes.join(", ")).each(e.proxy(function(t,i){this.emptyElement(i)&&e(i).append(this.br)},this)),t.replaceWith(t.html().replace(/\u200b/gi,""))))},e.Editable.prototype.listTextEmpty=function(t){var i=e(t).text().replace(/(\r\n|\n|\r|\t|\u200B)/gm,"");return(""===i||t===this.$element.get(0))&&1===e(t).find("br").length}}(jQuery);
!function(e){e.Editable.DEFAULTS=e.extend(e.Editable.DEFAULTS,{allowedImageTypes:["jpeg","jpg","png","gif"],customImageButtons:{},defaultImageTitle:"Image title",defaultImageWidth:300,defaultImageDisplay:"block",defaultImageAlignment:"center",imageDeleteConfirmation:!0,imageDeleteURL:null,imageDeleteParams:{},imageMove:!0,imageResize:!0,imageLink:!0,imageTitle:!0,imageUpload:!0,imageUploadParams:{},imageUploadParam:"file",imageUploadURL:"http://i.froala.com/upload",maxImageSize:5242880,pasteImage:!0,textNearImage:!0,assetType:2,assetDomain:"asset",parent_id:0,fetchUploadURL:""}),e.Editable.commands=e.extend(e.Editable.commands,{multiUpload:{title:"Multi Upload",icon:"fa fa-picture-o",callback:function(){this.insertAsset()},undo:!1}}),e.Editable.prototype.showAssetWrapper=function(){this.$asset_wrapper&&this.$asset_wrapper.show()},e.Editable.prototype.hideAssetWrapper=function(){this.$asset_wrapper&&this.$asset_wrapper.hide()},e.Editable.prototype.showAssetUpload=function(){this.hidePopups(),this.showAssetWrapper()},e.Editable.prototype.insertAsset=function(){this.closeImageMode(),this.imageMode=!1,this.showAssetUpload(),this.saveSelectionByMarkers(),this.options.inlineMode||this.positionPopup("multiUpload")},e.Editable.prototype.assetUploadHTML=function(){var e='<div class="froala-popup froala-asset-popup" style="display: none;"><h4><span data-text="true">Multi Upload</span><small> (小于5M,jpg、jpeg的格式）</small><i title="Cancel" class="fa fa-times" id="f-asset-close-'+this._id+'"></i></h4>';return e+='<div id="f-asset-list-'+this._id+'" class="editor-assets">',e+='<div id="multi-upload-'+this._id+'"></div>',e+='<div id="multi-list-'+this._id+'" class="ui three blocks"></div>',e+="</div>",e+='<div class="select-result"><div class="ui ok active inverted magenta button">确定插入</div><div class="ui notok inverted grey button">取消</div><div class="ui remove inverted red button">删除所选</div></div>',e+="</div>"},e.Editable.prototype.multiUploadAsset=function(){this.$asset_wrapper=e(this.assetUploadHTML()),this.$popup_editor.append(this.$asset_wrapper),this.$select_assets=new Array,this.$select_ids=new Array;var t=this;this.addListener("hidePopups",e.proxy(function(){this.hideAssetWrapper()},this)),this.loadAssets();var s=new qq.FineUploader({element:e("#multi-upload-"+t._id)[0],request:{inputName:t.options.imageUploadParam,params:t.options.imageUploadParams,endpoint:t.options.imageUploadURL},text:{uploadButton:'<a class="ui active grey labeled icon button" href="javascript:void(0);"><i class="cloud upload icon"></i>选择图片</a>'},validation:{allowedExtensions:["jpeg","jpg","png","gif"],sizeLimit:5245728},callbacks:{onUpload:function(e,i){t.options.imageUploadParams["x:ord"]+=e,s.setParams(t.options.imageUploadParams)},onComplete:function(s,i,a,o){console.log("id: "+s+" name: "+i+"result: "+a),a.is_error?phenix.show_error_message(a.message):(e(".qq-upload-list").children().eq(s).fadeOut(),e.getJSON(t.options.fetchUploadURL,{assets:a.data.ids,asset_type:t.options.assetType,asset_domain:t.options.assetDomain},function(e){return e.is_error?void phenix.show_error_message(e.message):(t.renderAssets(e),void t.buildAssetIds(e))}))}}});e("#multi-list-"+this._id).find("img").livequery(function(s){e(this).bind("click",function(){var s=e(this).parent(".image").data("src"),i=e(this).parent(".image").data("id");s&&(t.$select_assets.push(s),t.$select_ids.push(i),e(this).after('<div class="cover"><i class="check circle icon"></i></div>'))})}).end().find(".cover").livequery(function(s){e(this).bind("click",function(){console.log("click cover");var s=e(this).parent(".image").data("src"),i=-1;e(this).remove();for(var a=0,o=t.$select_assets.length;o>a;a++)t.$select_assets[a]==s&&(i=a);-1!=i&&(t.$select_assets.splice(i,1),t.$select_ids.splice(i,1))})}),this.$asset_wrapper.on("click","div.ui.ok.button",e.proxy(function(){if(this.$select_assets.length){for(var e="",s=0,i=t.$select_assets.length;i>s;s++)e+='<p><img class="fr-fin fr-dib" src="'+t.$select_assets[s]+'" alt="'+t.options.defaultImageTitle+'"></p>';this.insertHTML(e),this.cancelSelected(),this.$bttn_wrapper.show(),this.hideAssetWrapper(),this.options.inlineMode&&!this.imageMode&&0===this.options.buttons.length&&this.hide(),this.restoreSelection(),this.focus(),this.options.inlineMode||this.hide()}else phenix.show_error_note("请至少选择一个要插入的图片！")},this)),this.$asset_wrapper.on("click","div.ui.remove.button",e.proxy(function(){if(t.$select_assets.length)for(var s=0,i=t.$select_assets.length;i>s;s++){var a=t.$select_ids[s];e("#asset-"+a).remove(),e.getJSON(this.options.imageDeleteURL,{asset_id:a},function(e){return e.is_error?void phenix.show_error_note(e.message):void 0})}else phenix.show_error_note("请至少选择一个要删除的图片！")},this)),this.$asset_wrapper.on("click","div.ui.notok.button",e.proxy(function(){this.cancelSelected(),this.$bttn_wrapper.show(),this.hideAssetWrapper(),this.options.inlineMode&&!this.imageMode&&0===this.options.buttons.length&&this.hide(),this.restoreSelection(),this.focus(),this.options.inlineMode||this.hide()},this)),this.$asset_wrapper.on(this.mouseup,"i#f-asset-close-"+this._id,e.proxy(function(){this.$bttn_wrapper.show(),this.hideAssetWrapper(),this.options.inlineMode&&!this.imageMode&&0===this.options.buttons.length&&this.hide(),this.restoreSelection(),this.focus(),this.options.inlineMode||this.hide()},this))},e.Editable.prototype.cancelSelected=function(){this.$select_assets=[],e("#multi-list-"+this._id).find(".cover").remove()},e.Editable.prototype.loadAssets=function(){var t=this;this.options.parent_id&&e.getJSON(this.options.fetchUploadURL,{parent_id:this.options.parent_id,asset_type:this.options.assetType,asset_domain:this.options.assetDomain},function(e){return e.is_error?void phenix.show_error_message(e.message):void t.renderAssets(e)})},e.Editable.prototype.renderAssets=function(t){var s='{{#data}}<div class="block" id="asset-{{ id }}"><div class="image" data-id="{{ id }}" data-src="{{ thumbnails.hd.view_url }}"><img src="{{ thumbnails.mini.view_url }}" /><p>{{ filename }}</p></div></div>{{/data}}',i=Mustache.render(s,t);e("#multi-list-"+this._id).prepend(i)},e.Editable.prototype.buildAssetIds=function(t){var s="{{#data}}{{ id }},{{/data}}",i=Mustache.render(s,t);console.log("value: "+i);var a=e("#newadd_asset_ids").val();a+=i,e("#newadd_asset_ids").val(a)},e.Editable.initializers.push(e.Editable.prototype.multiUploadAsset)}(jQuery);
!function(t){t.Editable.commands=t.extend(t.Editable.commands,{table:{title:"Table",icon:"fa fa-table",callback:function(t,e,a){this.table_commands[e]?this.table_commands[e].apply(this,[e,a]):this.table_commands.insertTable.apply(this,[e,a]),this.cleanupTables()}}}),t.Editable.DEFAULTS.buttons[t.Editable.DEFAULTS.buttons.indexOf("insertHorizontalRule")]="table",t.Editable.prototype.table_commands={insertTable:function(t,e){this.insertTable(t,e)},insertRowAbove:function(){this.insertRow("above")},insertRowBelow:function(){this.insertRow("below")},insertColumnBefore:function(){this.insertColumn("before")},insertColumnAfter:function(){this.insertColumn("after")},deleteColumn:function(){this.deleteColumn()},deleteRow:function(){this.deleteRow()},insertCellBefore:function(){this.insertCell("before")},insertCellAfter:function(){this.insertCell("after")},mergeCells:function(){this.mergeCells()},deleteCell:function(){this.deleteCell()},splitVertical:function(){this.splitVertical()},splitHorizontal:function(){this.splitHorizontal()},insertHeader:function(){this.insertHeader()},deleteHeader:function(){this.deleteHeader()},deleteTable:function(){this.deleteTable()}},t.Editable.prototype.command_dispatcher=t.extend(t.Editable.prototype.command_dispatcher,{table:function(t){var e=this.buildDropdownTable(),a=this.buildDropdownButton(t,e,"fr-table");return this.bindTableDropdownEvents(),a}}),t.Editable.prototype.tableTab=function(){var e;this.currentCell&&(e=this.currentCell());var a=t(this.getSelectionElement());return a.parents("ul, ol").length>0?!0:e&&this.nextCell()?(this.setSelection(this.nextCell()),!1):void 0},t.Editable.prototype.tableShiftTab=function(){var e;this.currentCell&&(e=this.currentCell());var a=t(this.getSelectionElement());return a.parents("ul, ol").length>0?!0:e&&this.prevCell()?(this.setSelection(this.prevCell()),!1):void 0},t.Editable.prototype.initTable=function(){var e=this;this.$editor.on("click mouseup touch touchend",".fr-table a",function(a){a.preventDefault(),a.stopPropagation(),e.android()&&(t(this).parent().siblings().removeClass("hover"),t(this).parent().addClass("hover"))}),this.addListener("tab",this.tableTab),this.addListener("shift+tab",this.tableShiftTab)},t.Editable.initializers.push(t.Editable.prototype.initTable),t.Editable.prototype.buildDropdownTable=function(){var t='<ul class="fr-dropdown-menu fr-table">';t+='<li> <a href="#"><span data-text="true">Insert table</span> <i class="fa fa-chevron-right"></i></a><div class="select-table"> ',t+='<div class="fr-t-info">1 x 1</div>';for(var e=1;10>=e;e++){for(var a=1;10>=a;a++){var r="inline-block";(e>5||a>5)&&(r="none");var l="fr-bttn ";1==e&&1==a&&(l+=" hover"),t+='<span class="'+l+'" data-cmd="table" data-val="'+e+'" data-param="'+a+'" style="display: '+r+';"><span></span></span>'}t+='<div class="new-line"></div>'}return t+="</div> </li>",t+='<li><a href="#"><span data-text="true">Cell</span> <i class="fa fa-chevron-right"></i></a> <ul> <li data-cmd="table" data-val="insertCellBefore"><a href="#" data-text="true">Insert cell before</a></li><li data-cmd="table" data-val="insertCellAfter"><a href="#" data-text="true">Insert cell after</a></li><li data-cmd="table" data-val="deleteCell"><a href="#" data-text="true">Delete cell</a></li><li data-cmd="table" data-val="mergeCells"><a href="#" data-text="true">Merge cells</a></li><li data-cmd="table" data-val="splitHorizontal"><a href="#" data-text="true">Horizontal split</a></li><li data-cmd="table" data-val="splitVertical"><a href="#" data-text="true">Vertical split</a></li></ul></li>',t+='<li><a href="#"><span data-text="true">Row</span> <i class="fa fa-chevron-right"></i></a> <ul><li data-cmd="table" data-val="insertRowAbove"><a href="#" data-text="true">Insert row above</a></li><li data-cmd="table" data-val="insertRowBelow"><a href="#" data-text="true">Insert row below</a></li><li data-cmd="table" data-val="deleteRow"><a href="#" data-text="true">Delete row</a></li></ul></li>',t+='<li><a href="#"><span data-text="true">Column</span> <i class="fa fa-chevron-right"></i></a> <ul> <li data-cmd="table" data-val="insertColumnBefore"><a href="#" data-text="true">Insert column before</a></li> <li data-cmd="table" data-val="insertColumnAfter"><a href="#" data-text="true">Insert column after</a></li> <li data-cmd="table" data-val="deleteColumn"><a href="#" data-text="true">Delete column</a></li> </ul></li>',t+='<li data-cmd="table" data-val="deleteTable"><a href="#" data-text="true">Delete table</a></li>',t+="</ul>"},t.Editable.prototype.bindTableDropdownEvents=function(){var e=this;this.$bttn_wrapper.on("mouseenter",".fr-table .select-table > span",function(){var a=t(this).data("val"),r=t(this).data("param");e.$bttn_wrapper.find(".fr-table .select-table .fr-t-info").text(a+" x "+r),e.$bttn_wrapper.find(".fr-table .select-table > span").removeClass("hover");for(var l=1;10>=l;l++)for(var i=0;10>=i;i++){var n=e.$bttn_wrapper.find('.fr-table .select-table > span[data-val="'+l+'"][data-param="'+i+'"]');a>=l&&r>=i?n.addClass("hover"):(a+1>=l||5>=l)&&(r+1>=i||5>=i)?n.css("display","inline-block"):(l>5||i>5)&&n.css("display","none")}}),this.$bttn_wrapper.on("mouseleave",".fr-table .select-table",function(){e.$bttn_wrapper.find('.fr-table .select-table > span[data-val="1"][data-param="1"]').trigger("mouseenter")}),this.android()&&this.$bttn_wrapper.on("touchend",".fr-table .fr-trigger",function(){t(this).parents(".fr-table").find(".hover").removeClass("hover")})},t.Editable.prototype.tableMap=function(){var e=this.currentTable(),a=[];return e&&e.find("tr:not(:empty)").each(function(e,r){var l=t(r),i=0;l.find("th, td").each(function(r,l){for(var n=t(l),o=parseInt(n.attr("colspan"),10)||1,s=parseInt(n.attr("rowspan"),10)||1,d=e;e+s>d;d++)for(var h=i;i+o>h;h++)a[d]||(a[d]=[]),a[d][h]?i++:a[d][h]=l;i+=o})}),a},t.Editable.prototype.cellOrigin=function(t,e){for(var a=0;a<e.length;a++)for(var r=0;r<e[a].length;r++)if(e[a][r]==t)return{row:a,col:r}},t.Editable.prototype.canMergeCells=function(){var e=this.getSelectionCells();if(e.length<2)return!1;for(var a=this.tableMap(),r=0,l=32e3,i=0,n=32e3,o=0,s=0;s<e.length;s++){var d=t(e[s]),h=parseInt(d.attr("colspan"),10)||1,f=parseInt(d.attr("rowspan"),10)||1,c=this.cellOrigin(e[s],a);r+=h*f,l=Math.min(l,c.col),i=Math.max(i,c.col+h),n=Math.min(n,c.row),o=Math.max(o,c.row+f)}return r==(i-l)*(o-n)?{row:n,col:l,colspan:i-l,rowspan:o-n,map:a,cells:e}:null},t.Editable.prototype.getSelectionCells=function(){var e,a=[];if(this.browser.webkit||this.browser.msie){var r=this.getSelectionElements();for(e=0;e<r.length;e++)("TD"==r[e].tagName||"TH"==r[e].tagName)&&a.push(r[e])}else{var l=this.getRanges();for(e=0;e<l.length;e++){var i=l[e],n=!1;if("TD"==i.startContainer.tagName||"TH"==i.startContainer.tagName)a.push(i.startContainer),n=!0;else{var o=i.startContainer.childNodes,s=i.startOffset;if(o.length>s&&s>=0){var d=o[s];("TD"==d.tagName||"TH"==d.tagName)&&(a.push(d),n=!0)}}if(n===!1){var h=t(i.startContainer).parents("td:first, th:first");h.length>0&&a.push(h.get(0))}}}return a},t.Editable.prototype.currentCell=function(){var t=this.getSelectionCells();return t.length>0?t[0]:null},t.Editable.prototype.prevCell=function(){var e=this.currentCell();if(e){if(t(e).prev("td").length)return t(e).prev("td").get(0);if(t(e).parent().prev("tr").find("td").length)return t(e).parent().prev("tr").find("td:last").get(0)}return null},t.Editable.prototype.nextCell=function(){var e=this.currentCell();if(e){if(t(e).next("td").length)return t(e).next("td").get(0);if(t(e).parent().next("tr").find("td").length)return t(e).parent().next("tr").find("td").get(0)}return null},t.Editable.prototype.currentTable=function(){for(var e=t(this.getSelectionElement());e.get(0)!=this.$element.get(0)&&e.get(0)!=this.$document.find("body").get(0)&&"TABLE"!=e.get(0).tagName;)e=e.parent();return e.get(0)!=this.$element.get(0)?e:null},t.Editable.prototype.focusOnTable=function(){var t=this.currentTable();if(t){var e=t.find("td:first");this.setSelection(e.get(0))}},t.Editable.prototype.insertCell=function(e){for(var a=this.getSelectionCells(),r=0;r<a.length;r++){var l=t(a[r]);"before"==e?l.before(l.clone().removeAttr("colspan").removeAttr("rowspan").html(t.Editable.INVISIBLE_SPACE)):"after"==e&&l.after(l.clone().removeAttr("colspan").removeAttr("rowspan").html(t.Editable.INVISIBLE_SPACE))}"before"==e?this.triggerEvent("cellInsertedBefore"):"after"==e&&this.triggerEvent("cellInsertedAfter")},t.Editable.prototype.mergeCells=function(){var e=this.canMergeCells();if(e){var a=t(e.map[e.row][e.col]);a.attr("colspan",e.colspan),a.attr("rowspan",e.rowspan);for(var r=0;r<e.cells.length;r++){var l=e.cells[r];if(a.get(0)!=l){var i=t(l);a.append(i.html()),i.remove()}}this.setSelection(a.get(0))}this.hide(),this.triggerEvent("cellsMerged")},t.Editable.prototype.deleteCell=function(){for(var e=this.getSelectionCells(),a=0;a<e.length;a++){var r=t(e[a]);r.remove()}this.focusOnTable(),this.hide(),this.triggerEvent("cellDeleted")},t.Editable.prototype.insertHeader=function(){var t=this.currentTable();t&&t.find(" > thead").length>0&&this.triggerEvent("headerInserted")},t.Editable.prototype.deleteHeader=function(){},t.Editable.prototype.insertColumn=function(e){var a=this.currentCell();if(a)for(var r=t(a),l=this.tableMap(),i=this.cellOrigin(r.get(0),l),n=0;n<l.length;n++){var o=l[n][i.col],s=parseInt(t(o).attr("colspan"),10)||1,d=parseInt(t(o).attr("rowspan"),10)||1;if("before"==e){var h=l[n][i.col-1];h?h==o?t(h).attr("colspan",s+1):d>1?t(h).after("<"+h.tagName+">"+t.Editable.INVISIBLE_SPACE+"</"+h.tagName+">"):t(o).before("<"+o.tagName+">"+t.Editable.INVISIBLE_SPACE+"</"+o.tagName+">"):t(o).before("<"+o.tagName+">"+t.Editable.INVISIBLE_SPACE+"</"+o.tagName+">")}else if("after"==e){var f=l[n][i.col+1];f?f==o?t(f).attr("colspan",s+1):d>1?t(f).before("<"+f.tagName+">"+t.Editable.INVISIBLE_SPACE+"</"+f.tagName+">"):t(o).after("<"+o.tagName+">"+t.Editable.INVISIBLE_SPACE+"</"+o.tagName+">"):t(o).after("<"+o.tagName+">"+t.Editable.INVISIBLE_SPACE+"</"+o.tagName+">")}}this.hide(),"before"==e?this.triggerEvent("columnInsertedBefore"):"after"==e&&this.triggerEvent("columnInsertedAfter")},t.Editable.prototype.deleteColumn=function(){for(var e=this.getSelectionCells(),a=0;a<e.length;a++)for(var r=t(e[a]),l=this.tableMap(),i=this.cellOrigin(r.get(0),l),n=0;n<l.length;n++){var o=l[n][i.col],s=parseInt(t(o).attr("colspan"),10)||1;1==s?t(o).remove():t(o).attr("colspan",s-1)}this.focusOnTable(),this.hide(),this.triggerEvent("columnDeleted")},t.Editable.prototype.insertRow=function(e){var a,r=this.currentCell();if(r){var l=t(r),i=this.tableMap(),n=this.cellOrigin(l.get(0),i),o=0,s=null;for(a=0;a<i[n.row].length;a++){var d=i[n.row][a],h=parseInt(t(d).attr("rowspan"),10)||1;if("above"==e)if(0===n.row)o++;else{var f=i[n.row-1][a];f==d&&s!=d?t(d).attr("rowspan",h+1):o++}else if("below"==e)if(n.row==i.length-1)o++;else{var c=i[n.row+1][a];c==d&&s!=d?t(d).attr("rowspan",h+1):o++}s=i[n.row][a]}var p="<tr>";for(a=0;o>a;a++)p+="<td>"+t.Editable.INVISIBLE_SPACE+"</td>";p+="</tr>","below"==e?l.closest("tr").after(p):"above"==e&&l.closest("tr").before(p)}this.hide(),"below"==e?this.triggerEvent("rowInsertedBelow"):"above"==e&&this.triggerEvent("rowInsertedAbove")},t.Editable.prototype.deleteRow=function(){for(var e=this.getSelectionCells(),a=0;a<e.length;a++){var r=t(e[a]),l=this.tableMap(),i=this.cellOrigin(r.get(0),l),n=r.parents("tr:first");if(i)for(var o=0;o<l[i.row].length;o++){var s=l[i.row][o],d=parseInt(t(s).attr("rowspan"),10)||1;if(1==d)t(s).remove();else{var h=this.cellOrigin(s,l);if(t(s).attr("rowspan",d-1),h.row==i.row){var f=l[i.row+1];f&&f[o-1]&&(t(f[o-1]).after(t(s).clone()),t(s).remove())}}}n.remove()}this.focusOnTable(),this.hide(),this.triggerEvent("rowDeleted")},t.Editable.prototype.splitVertical=function(){for(var e=this.getSelectionCells(),a=0;a<e.length;a++){var r=t(e[a]),l=this.tableMap(),i=this.cellOrigin(r.get(0),l),n=parseInt(r.attr("colspan"),10)||1,o=parseInt(r.attr("rowspan"),10)||1;if(o>1){var s=Math.floor(o/2),d=i.row+(o-s),h=l[d][i.col-1];h||(h=l[d][i.col+n]),h?t(h).before(r.clone().attr("rowspan",s).html(t.Editable.INVISIBLE_SPACE)):r.parents("tr:first").after(t("<tr>").append(r.clone().attr("rowspan",s).html(t.Editable.INVISIBLE_SPACE))),r.attr("rowspan",o-s)}else{for(var f=t("<tr>").append(r.clone().html(t.Editable.INVISIBLE_SPACE)),c=null,p=0;p<l[i.row].length;p++){var b=l[i.row][p],u=parseInt(t(b).attr("rowspan"),10)||1;c!=b&&b!=r.get(0)&&t(b).attr("rowspan",u+1),c=b}r.parents("tr:first").after(f)}}this.hide(),this.triggerEvent("cellVerticalSplit")},t.Editable.prototype.splitHorizontal=function(){for(var e=this.getSelectionCells(),a=0;a<e.length;a++){var r=t(e[a]),l=this.tableMap(),i=this.cellOrigin(r.get(0),l),n=parseInt(r.attr("colspan"),10)||1;if(n>1){var o=Math.floor(n/2);r.after(r.clone().attr("colspan",o).html(t.Editable.INVISIBLE_SPACE)),r.attr("colspan",n-o)}else{for(var s=null,d=0;d<l.length;d++){var h=l[d][i.col],f=parseInt(t(h).attr("colspan"),10)||1;s!=h&&h!=r.get(0)&&t(h).attr("colspan",f+1),s=h}r.after(r.clone().html(t.Editable.INVISIBLE_SPACE))}}this.hide(),this.triggerEvent("cellHorizontalSplit")},t.Editable.prototype.insertTable=function(e,a){for(var r='<table data-last-table="true" width="100%">',l=0;e>l;l++){r+="<tr>";for(var i=0;a>i;i++)r+="<td>"+t.Editable.INVISIBLE_SPACE+"</td>";r+="</tr>"}r+="</table>",this.focus();var n=this.getSelectionElement();this.breakHTML(r,this.parents(t(n),"li").length<0);var o=this.$element.find('table[data-last-table="true"]');o.removeAttr("data-last-table"),this.setSelection(o.find("td:first").get(0)),this.hide(),this.triggerEvent("tableInserted")},t.Editable.prototype.deleteTable=function(){var t=this.currentTable();t&&(t.remove(),this.focus(),this.hide(),this.triggerEvent("tableDeleted"))},t.Editable.prototype.cleanupTables=function(){this.$element.find('td[colspan="1"], th[colspan="1"]').each(function(){t(this).removeAttr("colspan")}),this.$element.find('td[rowspan="1"], th[rowspan="1"]').each(function(){t(this).removeAttr("rowspan")})}}(jQuery);
!function(e){e.Editable.URLRegEx=/(\s|^|>)((http|https|ftp|ftps)\:\/\/[a-zA-Z0-9\-\.]+(\.[a-zA-Z]{2,3})?(:\d*)?(\/\S*)?)(\s|$|<)/gi,e.Editable.prototype.convertURLs=function(t){var a=this;t.each(function(){if(3==this.nodeType){var t=this.textContent.replace(/&nbsp;/gi,"");e.Editable.URLRegEx.test(t)&&(e(this).before(t.replace(e.Editable.URLRegEx,'$1<a href="$2">$2</a>$7')),e(this).remove())}else 1==this.nodeType&&["A","BUTTON","TEXTAREA"].indexOf(this.tagName)<0&&a.convertURLs(e(this).contents())})},e.Editable.prototype.processURLs=function(){this.$original_element.on("editable.afterPaste",function(e,t){t.convertURLs(t.$element.contents())}),this.$original_element.on("editable.keyup",function(e,t,a){var n=a.which;(32==n||13==n)&&t.convertURLs(t.$element.contents())}),this.$original_element.on("editable.keydown",function(t,a,n){var i=n.which;if(32==i){var s=a.getSelectionElement();if(("A"==s.tagName||e(s).parents("a").length)&&a.getSelectionTextInfo(s).atEnd)return t.stopImmediatePropagation(),"A"!==s.tagName&&(s=e(s).parents("a")[0]),e(s).after('&nbsp;<span class="f-marker" data-type="false" data-id="0" data-fr-verified="true"></span><span class="f-marker" data-type="true" data-id="0" data-fr-verified="true"></span>'),a.restoreSelectionByMarkers(),!1}})},e.Editable.initializers.push(e.Editable.prototype.processURLs)}(jQuery);
!function(e){e.Editable.DEFAULTS=e.extend(e.Editable.DEFAULTS,{videoAllowedAttrs:["src","width","height","frameborder","allowfullscreen","webkitallowfullscreen","mozallowfullscreen","href","target","id","controls","value","name"],videoAllowedTags:["iframe","object","param","video","source","embed"],defaultVideoAlignment:"center",textNearVideo:!0}),e.Editable.VIDEO_PROVIDERS=[{test_regex:/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:m\.)?(?:youtube\.com|youtu\.be)\/(?:watch\?v=|embed\/)?(.+)/g,url_text:"//www.youtube.com/embed/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen></iframe>'},{test_regex:/^.*(vimeo\.com\/)((channels\/[A-z]+\/)|(groups\/[A-z]+\/videos\/))?([0-9]+)/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:vimeo\.com)\/(?:channels\/[A-z]+\/|groups\/[A-z]+\/videos\/)?(.+)/g,url_text:"//player.vimeo.com/video/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen></iframe>'},{test_regex:/^.+(dailymotion.com|dai.ly)\/(video|hub)?\/?([^_]+)[^#]*(#video=([^_&]+))?/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:dailymotion\.com|dai\.ly)\/(?:video|hub)?\/?(.+)/g,url_text:"//www.dailymotion.com/embed/video/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen></iframe>'},{test_regex:/^.+(screen.yahoo.com)\/(videos-for-you|popular)?\/[^_&]+/,url_regex:"",url_text:"",html:'<iframe width="640" height="360" src="{url}?format=embed" frameborder="0" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" allowtransparency="true"></iframe>'}],e.Editable.video_commands={floatVideoLeft:{title:"Float Left",icon:{type:"font",value:"fa fa-align-left"}},floatVideoNone:{title:"Float None",icon:{type:"font",value:"fa fa-align-justify"}},floatVideoRight:{title:"Float Right",icon:{type:"font",value:"fa fa-align-right"}},removeVideo:{title:"Remove Video",icon:{type:"font",value:"fa fa-trash-o"}}},e.Editable.DEFAULTS=e.extend(e.Editable.DEFAULTS,{videoButtons:["floatVideoLeft","floatVideoNone","floatVideoRight","removeVideo"]}),e.Editable.commands=e.extend(e.Editable.commands,{insertVideo:{title:"Insert Video",icon:"fa fa-video-camera",callback:function(){this.insertVideo()},undo:!1}}),e.Editable.prototype.insertVideo=function(){this.options.inlineMode||(this.closeImageMode(),this.imageMode=!1,this.positionPopup("insertVideo")),this.selectionInEditor()&&this.saveSelection(),this.showInsertVideo(),this.$video_wrapper.find("textarea").val("")},e.Editable.prototype.insertVideoHTML=function(){var e='<div class="froala-popup froala-video-popup" style="display: none;"><h4><span data-text="true">Insert Video</span><i title="Cancel" class="fa fa-times" id="f-video-close-'+this._id+'"></i></h4><div class="f-popup-line"><textarea placeholder="Embedded code" id="f-video-textarea-'+this._id+'"></textarea></div><p class="or"><span data-text="true">or</span></p><div class="f-popup-line"><input type="text" placeholder="http://youku.com/" id="f-video-input-'+this._id+'"/><button data-text="true" class="f-ok f-submit fr-p-bttn" id="f-video-ok-'+this._id+'">OK</button></div></div>';return e},e.Editable.prototype.buildInsertVideo=function(){this.$video_wrapper=e(this.insertVideoHTML()),this.$popup_editor.append(this.$video_wrapper),this.addListener("hidePopups",this.hideVideoWrapper),this.$video_wrapper.on("mouseup touchend",e.proxy(function(e){this.isResizing()||e.stopPropagation()},this)),this.$video_wrapper.on("mouseup keydown","input#f-video-input-"+this._id+", textarea#f-video-textarea-"+this._id,e.proxy(function(e){e.stopPropagation()},this));var t=this;this.$video_wrapper.on("change","input#f-video-input-"+this._id+", textarea#f-video-textarea-"+this._id,function(){"INPUT"==this.tagName?t.$video_wrapper.find("textarea#f-video-textarea-"+t._id).val(""):"TEXTAREA"==this.tagName&&t.$video_wrapper.find("input#f-video-input-"+t._id).val("")}),this.$video_wrapper.on("click","button#f-video-ok-"+this._id,e.proxy(function(){var e=this.$video_wrapper.find("input#f-video-input-"+this._id),t=this.$video_wrapper.find("textarea#f-video-textarea-"+this._id);""!==e.val()?this.writeVideo(e.val(),!1):""!==t.val()&&this.writeVideo(t.val(),!0)},this)),this.$video_wrapper.on(this.mouseup,"i#f-video-close-"+this._id,e.proxy(function(){this.$bttn_wrapper.show(),this.hideVideoWrapper(),this.options.inlineMode&&!this.imageMode&&0===this.options.buttons.length&&this.hide(),this.restoreSelection(),this.focus(),this.options.inlineMode||this.hide()},this)),this.$video_wrapper.on("click",function(e){e.stopPropagation()}),this.$video_wrapper.on("click","*",function(e){e.stopPropagation()}),this.$window.on("keydown."+this._id,e.proxy(function(t){if(this.$element.find(".f-video-editor.active").length>0){var i=t.which;if(46==i||8==i)return t.stopPropagation(),t.preventDefault(),setTimeout(e.proxy(function(){this.removeVideo()},this),0),!1}},this))},e.Editable.prototype.destroyVideo=function(){this.$video_wrapper.html("").removeData().remove()},e.Editable.prototype.initVideo=function(){this.buildInsertVideo(),this.addVideoControls(),this.addListener("destroy",this.destroyVideo)},e.Editable.initializers.push(e.Editable.prototype.initVideo),e.Editable.prototype.hideVideoEditorPopup=function(){this.$video_editor&&(this.$video_editor.hide(),e("span.f-video-editor").removeClass("active"),this.$element.removeClass("f-non-selectable"),this.editableDisabled||this.isHTML||this.$element.attr("contenteditable",!0))},e.Editable.prototype.showVideoEditorPopup=function(){this.hidePopups(),this.$video_editor&&this.$video_editor.show(),this.$element.removeAttr("contenteditable")},e.Editable.prototype.addVideoControlsHTML=function(){this.$video_editor=e('<div class="froala-popup froala-video-editor-popup" style="display: none">');for(var t=e('<div class="f-popup-line">').appendTo(this.$video_editor),i=0;i<this.options.videoButtons.length;i++){var o=this.options.videoButtons[i];if(void 0!==e.Editable.video_commands[o]){var d=e.Editable.video_commands[o],r='<button class="fr-bttn" data-callback="'+o+'" data-cmd="'+o+'" title="'+d.title+'">';r+=void 0!==this.options.icons[o]?this.prepareIcon(this.options.icons[o],d.title):this.prepareIcon(d.icon,d.title),r+="</button>",t.append(r)}}this.addListener("hidePopups",this.hideVideoEditorPopup),this.$popup_editor.append(this.$video_editor),this.bindCommandEvents(this.$video_editor)},e.Editable.prototype.floatVideoLeft=function(){e("span.f-video-editor.active").attr("class","f-video-editor active fr-fvl"),this.triggerEvent("videoFloatedLeft"),e("span.f-video-editor.active").click()},e.Editable.prototype.floatVideoRight=function(){e("span.f-video-editor.active").attr("class","f-video-editor active fr-fvr"),this.triggerEvent("videoFloatedRight"),e("span.f-video-editor.active").click()},e.Editable.prototype.floatVideoNone=function(){e("span.f-video-editor.active").attr("class","f-video-editor active fr-fvn"),this.triggerEvent("videoFloatedNone"),e("span.f-video-editor.active").click()},e.Editable.prototype.removeVideo=function(){e("span.f-video-editor.active").remove(),this.hide(),this.triggerEvent("videoRemoved"),this.focus()},e.Editable.prototype.refreshVideo=function(){this.$element.find("iframe, object").each(function(t,i){for(var o=e(i),d=0;d<e.Editable.VIDEO_PROVIDERS.length;d++){var r=e.Editable.VIDEO_PROVIDERS[d];if(r.test_regex.test(o.attr("src"))){0===o.parents(".f-video-editor").length&&o.wrap('<span class="f-video-editor fr-fvn" data-fr-verified="true" contenteditable="false">');break}}}),this.browser.msie&&this.$element.find(".f-video-editor").each(function(){this.oncontrolselect=function(){return!1}}),this.options.textNearVideo||this.$element.find(".f-video-editor").attr("contenteditable",!1).addClass("fr-tnv")},e.Editable.prototype.addVideoControls=function(){this.addVideoControlsHTML(),this.addListener("sync",this.refreshVideo),this.$element.on("mousedown","span.f-video-editor",e.proxy(function(e){e.stopPropagation()},this)),this.$element.on("click touchend","span.f-video-editor",e.proxy(function(t){if(this.isDisabled)return!1;t.preventDefault(),t.stopPropagation();var i=t.currentTarget;this.clearSelection(),this.showVideoEditorPopup(),this.showByCoordinates(e(i).offset().left+e(i).width()/2,e(i).offset().top+e(i).height()+3),e(i).addClass("active"),this.refreshVideoButtons(i)},this))},e.Editable.prototype.refreshVideoButtons=function(t){var i=e(t).attr("class");this.$video_editor.find("[data-cmd]").removeClass("active"),i.indexOf("fr-fvl")>=0?this.$video_editor.find('[data-cmd="floatVideoLeft"]').addClass("active"):i.indexOf("fr-fvr")>=0?this.$video_editor.find('[data-cmd="floatVideoRight"]').addClass("active"):this.$video_editor.find('[data-cmd="floatVideoNone"]').addClass("active")},e.Editable.prototype.writeVideo=function(t,i){var o=null;if(i)o=this.clean(t,!0,!1,this.options.videoAllowedTags,this.options.videoAllowedAttrs);else for(var d=0;d<e.Editable.VIDEO_PROVIDERS.length;d++){var r=e.Editable.VIDEO_PROVIDERS[d];if(r.test_regex.test(t)){t=t.replace(r.url_regex,r.url_text),o=r.html.replace(/\{url\}/,t);break}}if(o){this.restoreSelection(),this.$element.focus();var a="fr-fvn";"left"==this.options.defaultVideoAlignment&&(a="fr-fvl"),"right"==this.options.defaultVideoAlignment&&(a="fr-fvr"),this.textNearVideo||(a+=" fr-tnv");try{this.insertHTML('<span contenteditable="false" class="f-video-editor '+a+'" data-fr-verified="true">'+o+"</span>")}catch(s){}this.$bttn_wrapper.show(),this.hideVideoWrapper(),this.hide(),this.triggerEvent("videoInserted",[o])}else this.triggerEvent("videoError")},e.Editable.prototype.showVideoWrapper=function(){this.$video_wrapper&&(this.$video_wrapper.show(),this.$video_wrapper.find(".f-popup-line input").val(""))},e.Editable.prototype.hideVideoWrapper=function(){this.$video_wrapper&&(this.$video_wrapper.hide(),this.$video_wrapper.find("input").blur())},e.Editable.prototype.showInsertVideo=function(){this.hidePopups(),this.showVideoWrapper()}}(jQuery);
!function(){function t(t){return t.replace(/^\s+|\s+$/g,"")}function i(t){return t.replace(/^\s+/g,"")}function n(n,e,s,h){function r(){return this.pos=0,this.token="",this.current_mode="CONTENT",this.tags={parent:"parent1",parentcount:1,parent1:""},this.tag_type="",this.token_text=this.last_token=this.last_text=this.token_type="",this.newlines=0,this.indent_content=_,this.Utils={whitespace:"\n\r	 ".split(""),single_token:"br,input,link,meta,!doctype,basefont,base,area,hr,wbr,param,img,isindex,?xml,embed,?php,?,?=".split(","),extra_liners:"head,body,/html".split(","),in_array:function(t,i){for(var n=0;n<i.length;n++)if(t===i[n])return!0;return!1}},this.traverse_whitespace=function(){var t="";if(t=this.input.charAt(this.pos),this.Utils.in_array(t,this.Utils.whitespace)){for(this.newlines=0;this.Utils.in_array(t,this.Utils.whitespace);)g&&"\n"===t&&this.newlines<=f&&(this.newlines+=1),this.pos++,t=this.input.charAt(this.pos);return!0}return!1},this.get_content=function(){for(var t="",i=[],n=!1;"<"!==this.input.charAt(this.pos);){if(this.pos>=this.input.length)return i.length?i.join(""):["","TK_EOF"];if(this.traverse_whitespace())i.length&&(n=!0);else{if(d){var e=this.input.substr(this.pos,3);if("{{#"===e||"{{/"===e)break;if("{{"===this.input.substr(this.pos,2)&&"{{else}}"===this.get_tag(!0))break}t=this.input.charAt(this.pos),this.pos++,n&&(this.line_char_count>=this.wrap_line_length?(this.print_newline(!1,i),this.print_indentation(i)):(this.line_char_count++,i.push(" ")),n=!1),this.line_char_count++,i.push(t)}}return i.length?i.join(""):""},this.get_contents_to=function(t){if(this.pos===this.input.length)return["","TK_EOF"];var i="",n=new RegExp("</"+t+"\\s*>","igm");n.lastIndex=this.pos;var e=n.exec(this.input),s=e?e.index:this.input.length;return this.pos<s&&(i=this.input.substring(this.pos,s),this.pos=s),i},this.record_tag=function(t){this.tags[t+"count"]?(this.tags[t+"count"]++,this.tags[t+this.tags[t+"count"]]=this.indent_level):(this.tags[t+"count"]=1,this.tags[t+this.tags[t+"count"]]=this.indent_level),this.tags[t+this.tags[t+"count"]+"parent"]=this.tags.parent,this.tags.parent=t+this.tags[t+"count"]},this.retrieve_tag=function(t){if(this.tags[t+"count"]){for(var i=this.tags.parent;i&&t+this.tags[t+"count"]!==i;)i=this.tags[i+"parent"];i&&(this.indent_level=this.tags[t+this.tags[t+"count"]],this.tags.parent=this.tags[i+"parent"]),delete this.tags[t+this.tags[t+"count"]+"parent"],delete this.tags[t+this.tags[t+"count"]],1===this.tags[t+"count"]?delete this.tags[t+"count"]:this.tags[t+"count"]--}},this.indent_to_tag=function(t){if(this.tags[t+"count"]){for(var i=this.tags.parent;i&&t+this.tags[t+"count"]!==i;)i=this.tags[i+"parent"];i&&(this.indent_level=this.tags[t+this.tags[t+"count"]])}},this.get_tag=function(t){var i,n,e,s="",h=[],r="",a=!1,_=this.pos,o=this.line_char_count;t=void 0!==t?t:!1;do{if(this.pos>=this.input.length)return t&&(this.pos=_,this.line_char_count=o),h.length?h.join(""):["","TK_EOF"];if(s=this.input.charAt(this.pos),this.pos++,this.Utils.in_array(s,this.Utils.whitespace))a=!0;else{if(("'"===s||'"'===s)&&(s+=this.get_unformatted(s),a=!0),"="===s&&(a=!1),h.length&&"="!==h[h.length-1]&&">"!==s&&a&&(this.line_char_count>=this.wrap_line_length?(this.print_newline(!1,h),this.print_indentation(h)):(h.push(" "),this.line_char_count++),a=!1),d&&"<"===e&&s+this.input.charAt(this.pos)==="{{"&&(s+=this.get_unformatted("}}"),h.length&&" "!==h[h.length-1]&&"<"!==h[h.length-1]&&(s=" "+s),a=!0),"<"!==s||e||(i=this.pos-1,e="<"),d&&!e&&h.length>=2&&"{"===h[h.length-1]&&"{"==h[h.length-2]&&(i="#"===s||"/"===s?this.pos-3:this.pos-2,e="{"),this.line_char_count++,h.push(s),h[1]&&"!"===h[1]){h=[this.get_comment(i)];break}if(d&&"{"===e&&h.length>2&&"}"===h[h.length-2]&&"}"===h[h.length-1])break}}while(">"!==s);var u,p,l=h.join("");u=l.indexOf(-1!==l.indexOf(" ")?" ":"{"===l[0]?"}":">"),p="<"!==l[0]&&d?"#"===l[2]?3:2:1;var g=l.substring(p,u).toLowerCase();return"/"===l.charAt(l.length-2)||this.Utils.in_array(g,this.Utils.single_token)?t||(this.tag_type="SINGLE"):d&&"{"===l[0]&&"else"===g?t||(this.indent_to_tag("if"),this.tag_type="HANDLEBARS_ELSE",this.indent_content=!0,this.traverse_whitespace()):"script"===g?t||(this.record_tag(g),this.tag_type="SCRIPT"):"style"===g?t||(this.record_tag(g),this.tag_type="STYLE"):this.is_unformatted(g,c)?(r=this.get_unformatted("</"+g+">",l),h.push(r),i>0&&this.Utils.in_array(this.input.charAt(i-1),this.Utils.whitespace)&&h.splice(0,0,this.input.charAt(i-1)),n=this.pos-1,this.Utils.in_array(this.input.charAt(n+1),this.Utils.whitespace)&&h.push(this.input.charAt(n+1)),this.tag_type="SINGLE"):"!"===g.charAt(0)?t||(this.tag_type="SINGLE",this.traverse_whitespace()):t||("/"===g.charAt(0)?(this.retrieve_tag(g.substring(1)),this.tag_type="END",this.traverse_whitespace()):(this.record_tag(g),"html"!==g.toLowerCase()&&(this.indent_content=!0),this.tag_type="START",this.traverse_whitespace()),this.Utils.in_array(g,this.Utils.extra_liners)&&(this.print_newline(!1,this.output),this.output.length&&"\n"!==this.output[this.output.length-2]&&this.print_newline(!0,this.output))),t&&(this.pos=_,this.line_char_count=o),h.join("")},this.get_comment=function(t){var i="",n=">",e=!1;for(this.pos=t,input_char=this.input.charAt(this.pos),this.pos++;this.pos<=this.input.length&&(i+=input_char,i[i.length-1]!==n[n.length-1]||-1===i.indexOf(n));)!e&&i.length<10&&(0===i.indexOf("<![if")?(n="<![endif]>",e=!0):0===i.indexOf("<![cdata[")?(n="]]>",e=!0):0===i.indexOf("<![")?(n="]>",e=!0):0===i.indexOf("<!--")&&(n="-->",e=!0)),input_char=this.input.charAt(this.pos),this.pos++;return i},this.get_unformatted=function(t,i){if(i&&-1!==i.toLowerCase().indexOf(t))return"";var n="",e="",s=0,h=!0;do{if(this.pos>=this.input.length)return e;if(n=this.input.charAt(this.pos),this.pos++,this.Utils.in_array(n,this.Utils.whitespace)){if(!h){this.line_char_count--;continue}if("\n"===n||"\r"===n){e+="\n",this.line_char_count=0;continue}}e+=n,this.line_char_count++,h=!0,d&&"{"===n&&e.length&&"{"===e[e.length-2]&&(e+=this.get_unformatted("}}"),s=e.length)}while(-1===e.toLowerCase().indexOf(t,s));return e},this.get_token=function(){var t;if("TK_TAG_SCRIPT"===this.last_token||"TK_TAG_STYLE"===this.last_token){var i=this.last_token.substr(7);return t=this.get_contents_to(i),"string"!=typeof t?t:[t,"TK_"+i]}if("CONTENT"===this.current_mode)return t=this.get_content(),"string"!=typeof t?t:[t,"TK_CONTENT"];if("TAG"===this.current_mode){if(t=this.get_tag(),"string"!=typeof t)return t;var n="TK_TAG_"+this.tag_type;return[t,n]}},this.get_full_indent=function(t){return t=this.indent_level+t||0,1>t?"":Array(t+1).join(this.indent_string)},this.is_unformatted=function(t,i){if(!this.Utils.in_array(t,i))return!1;if("a"!==t.toLowerCase()||!this.Utils.in_array("a",i))return!0;var n=this.get_tag(!0),e=(n||"").match(/^\s*<\s*\/?([a-z]*)\s*[^>]*>\s*$/);return!e||this.Utils.in_array(e,i)?!0:!1},this.printer=function(t,n,e,s,h){this.input=t||"",this.output=[],this.indent_character=n,this.indent_string="",this.indent_size=e,this.brace_style=h,this.indent_level=0,this.wrap_line_length=s,this.line_char_count=0;for(var r=0;r<this.indent_size;r++)this.indent_string+=this.indent_character;this.print_newline=function(t,i){this.line_char_count=0,i&&i.length&&(t||"\n"!==i[i.length-1])&&i.push("\n")},this.print_indentation=function(t){for(var i=0;i<this.indent_level;i++)t.push(this.indent_string),this.line_char_count+=this.indent_string.length},this.print_token=function(t){(t||""!==t)&&this.output.length&&"\n"===this.output[this.output.length-1]&&(this.print_indentation(this.output),t=i(t)),this.print_token_raw(t)},this.print_token_raw=function(t){t&&""!==t&&(t.length>1&&"\n"===t[t.length-1]?(this.output.push(t.slice(0,-1)),this.print_newline(!1,this.output)):this.output.push(t));for(var i=0;i<this.newlines;i++)this.print_newline(i>0,this.output);this.newlines=0},this.indent=function(){this.indent_level++},this.unindent=function(){this.indent_level>0&&this.indent_level--}},this}var a,_,o,u,p,l,c,g,f,d;for(e=e||{},void 0!==e.wrap_line_length&&0!==parseInt(e.wrap_line_length,10)||void 0===e.max_char||0===parseInt(e.max_char,10)||(e.wrap_line_length=e.max_char),_=e.indent_inner_html||!0,o=parseInt(e.indent_size||1,10),u=e.indent_char||"	",l=e.brace_style||"collapse",p=0===parseInt(e.wrap_line_length,10)?32786:parseInt(e.wrap_line_length||1e5,10),c=e.unformatted||["a","span","bdo","em","strong","dfn","code","samp","kbd","var","cite","abbr","acronym","q","sub","sup","tt","i","b","big","small","u","s","strike","font","ins","del","pre","address","dt","h1","h2","h3","h4","h5","h6"],g=e.preserve_newlines||!0,f=g?parseInt(e.max_preserve_newlines||32786,10):0,d=e.indent_handlebars||!0,a=new r,a.printer(n,u,o,p,l);;){var T=a.get_token();if(a.token_text=T[0],a.token_type=T[1],"TK_EOF"===a.token_type)break;switch(a.token_type){case"TK_TAG_START":a.print_newline(!1,a.output),a.print_token(a.token_text),a.indent_content&&(a.indent(),a.indent_content=!1),a.current_mode="CONTENT";break;case"TK_TAG_STYLE":case"TK_TAG_SCRIPT":a.print_newline(!1,a.output),a.print_token(a.token_text),a.current_mode="CONTENT";break;case"TK_TAG_END":if("TK_CONTENT"===a.last_token&&""===a.last_text){var w=a.token_text.match(/\w+/)[0],y=null;a.output.length&&(y=a.output[a.output.length-1].match(/(?:<|{{#)\s*(\w+)/)),(null===y||y[1]!==w)&&a.print_newline(!1,a.output)}a.print_token(a.token_text),a.current_mode="CONTENT";break;case"TK_TAG_SINGLE":var k=a.token_text.match(/^\s*<([a-z]+)/i);k&&a.Utils.in_array(k[1],c)||a.print_newline(!1,a.output),a.print_token(a.token_text),a.current_mode="CONTENT";break;case"TK_TAG_HANDLEBARS_ELSE":a.print_token(a.token_text),a.indent_content&&(a.indent(),a.indent_content=!1),a.current_mode="CONTENT";break;case"TK_CONTENT":a.print_token(a.token_text),a.current_mode="TAG";break;case"TK_STYLE":case"TK_SCRIPT":if(""!==a.token_text){a.print_newline(!1,a.output);var v,b=a.token_text,m=1;"TK_SCRIPT"===a.token_type?v="function"==typeof s&&s:"TK_STYLE"===a.token_type&&(v="function"==typeof h&&h),"keep"===e.indent_scripts?m=0:"separate"===e.indent_scripts&&(m=-a.indent_level);var x=a.get_full_indent(m);if(v)b=v(b.replace(/^\s*/,x),e);else{var A=b.match(/^\s*/)[0],E=A.match(/[^\n\r]*$/)[0].split(a.indent_string).length-1,N=a.get_full_indent(m-E);b=b.replace(/^\s*/,x).replace(/\r\n|\r|\n/g,"\n"+N).replace(/\s+$/,"")}b&&(a.print_token_raw(x+t(b)),a.print_newline(!1,a.output))}a.current_mode="TAG"}a.last_token=a.token_type,a.last_text=a.token_text}return a.output.join("")}if("function"==typeof define&&define.amd)define(["./beautify","./beautify-css"],function(t,i){return{html_beautify:function(e,s){return n(e,s,t,i)}}});else if("undefined"!=typeof exports){var e=require("./beautify.js").js_beautify,s=require("./beautify-css.js").css_beautify;exports.html_beautify=function(t,i){return n(t,i,e,s)}}else"undefined"!=typeof window?window.html_beautify=function(t,i){return n(t,i,window.js_beautify,window.css_beautify)}:"undefined"!=typeof global&&(global.html_beautify=function(t,i){return n(t,i,global.js_beautify,global.css_beautify)})}();
$.Editable.LANGS.zh_cn={translation:{Bold:"粗体",Italic:"斜体",Underline:"下划线",Strikethrough:"删除线","Font Size":"字号",Color:"颜色",Background:"背景",Text:"文字","Format Block":"格式",Normal:"正常",Paragraph:"段落",Code:"代码",Quote:"引用","Heading 1":"标题1","Heading 2":"标题2","Heading 3":"标题3","Heading 4":"标题4","Heading 5":"标题5","Heading 6":"标题6","Block Style":"座式",Alignment:"对齐方式","Align Left":"左对齐","Align Center":"居中","Align Right":"右对齐",Justify:"两端对齐","Numbered List":"编号列表","Bulleted List":"项目符号","Indent Less":"减少缩进","Indent More":"增加缩进","Select All":"全选","Insert Link":"插入链接","Insert Image":"插入图片","Insert Video":"插入视频",Undo:"撤消",Redo:"重复","Show HTML":"显示的HTML","Float Left":"左对齐","Float None":"无","Float Right":"右对齐","Replace Image":"更换图像","Remove Image":"删除图像",Title:"标题","Drop image":"图像拖放","or click":"或点击",or:"或","Enter URL":"输入网址","Please wait!":"请稍等！","Are you sure? Image will be deleted.":"你确定吗？图像将被删除。",UNLINK:"删除链接","Open in new tab":"开启在新标签页","Type something":"输入一些内容",Cancel:"取消",OK:"确定","Manage images":"管理图像",Delete:"删除","Font Family":"字体","Insert Horizontal Line":"插入水平线",Table:"表格","Insert table":"插入表格",Cell:"单元格",Row:"行",Column:"列","Delete table":"删除表格","Insert cell before":"前插入单元格","Insert cell after":"后插入电池","Delete cell":"删除单元格","Merge cells":"合并单元格","Horizontal split":"水平分割","Vertical split":"垂直分割","Insert row above":"在上方插入","Insert row below":"在下方插入","Delete row":"删除行","Insert column before":"在左侧插入","Insert column after":"在右侧插入","Delete column":"删除列","Uploading image":"上传图像","Upload File":"上传文件","Drop File":"文件拖放","Clear formatting":"格式化删除","Multi Upload":"上传图片"},direction:"ltr"};